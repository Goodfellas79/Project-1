"use strict";define("wixCode/core/errors",[],function(){function e(e,t,n,i){var o=i?"Expecting "+i:"";this.name="ArgumentError",this.message="Illegal Argument '"+e+"' in "+t+". '"+n+"' is invalid. "+o+".",this.stack=(new Error).stack}function t(e){this.name="FileSystemError",this.message=e,this.stack=(new Error).stack}return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,{ArgumentError:e,FileSystemError:t}}),define("wixCode/core/consts",[],function(){return{FILE_STATES:{IDLE:"idle",VIRTUAL:"virtual",LOADING:"loading",SAVING:"saving",LOAD_FAILED:"loadFailed",LOAD_TAKING_LONGER_THAN_USUAL:"loadTakingLongerThanUsual"},PAGES_ROOT:"pages",JS_EXTENSION:".js",SITE_JS_PAGE_ID:"masterPage",DEAFULT_EMPTY_PAGE_CONTENT:"//For full API documentation, including code examples visit http://wix.to/94BuAAs\n\n$w.onReady(function () {\n\t//TODO: write your page related code here...\n\n});",PAGE_TABS:{PAGE:"page",SITE:"site"},DEVELOPER_MODE_FAIL_PANEL:{ERROR_CODE:"13200",HELP_LINK:"8045e8e4-6f47-4913-8d74-6239f21fffec"},ROUTER_FILE_NAME:"routers.js",DEFAULT_WEB_MODULE_CONTENT:"// Filename: ${moduleName}.jsw (web modules need to have a .jsw extension)\n\nexport function multiply(factor1, factor2) {\n    return factor1 * factor2;\n}\n\n\n\n//Use the following code in one of your site's front-end files\n//to call the multiply function from ${moduleName}.jsw.\n\n/* \nimport {multiply} from 'backend/${moduleName}';\n\n$w.onReady(function () {\n\t\n\tmultiply(4,5).then(product => {\n\t    console.log(product);\n\t      // Logs: 20\n\t})\n\t.catch(error => {\n\t\tconsole.log(error);\n\t});\n});\n*/\n",AUTHORIZATION_CONFIG_FILE_NAME:"authorization-config.json"}}),define("wixCode/code/services/codeEditorService",[],function(){function e(e){n.commandService=e.commandService,n.textSearcher=e.textSearcher}function t(){n={}}var n={};return{setEditor:e,destroyEditor:t,getServices:function(){return n}}}),define("wixCode/core/middlewares/reactBatchUpdates",["reactDOM"],function(e){return function(){return function(t){return function(n){return e.unstable_batchedUpdates(function(){return t(n)})}}}}),define("wixCode/core/store/createStore",["reduxLibs","wixCode/core/middlewares/reactBatchUpdates"],function(e,t){var n=e.redux,i=e.reduxThunk;return function(e,o,r){function s(e){return e}return n.compose(n.applyMiddleware(i.withExtraArgument(r),t),o&&window.devToolsExtension?window.devToolsExtension():s)(n.createStore)(e)}}),define("wixCode/core/store/storeManager",["wixCode/core/store/createStore"],function(e){function t(t,o,r){return i=e(t,o,r),n()}function n(){return i}var i;return{initialize:t,getStore:n}}),define("wixCode/code/reducers/codeStateReader",[],function(){function e(e,t){return e.getIn(["filesSelection",t])}function t(e,t){return e.getIn(["files",t])}function n(e){return e.getIn(["files"])}function i(e,t){return e.getIn(["fileSystemStructure",t])}function o(e,t){var n=null;return e.get("fileSystemStructure").forEach(function(e){var i=e.get("childIds");if(i&&i.has(t))return n=e,!1}),n}return{getFileSystemEntry:i,getFileSystemParentOf:o,getFile:t,getFiles:n,getFileSelection:e}}),define("wixCode/core/actions/types",[],function(){return{CHANGE_CONTENT:"wix.code.CHANGE_CONTENT",SET_SELECTION:"wix.code.SET_SELECTION",LOAD_FILE_BEGIN:"wix.code.LOAD_FILE_BEGIN",LOAD_FILE_END:"wix.code.LOAD_FILE_END",LOAD_FILE_FAILURE:"wix.code.LOAD_FILE_FAILURE",LOAD_FILE_CHECK_STATE:"wix.code.LOAD_FILE_CHECK_STATE",SAVE_FILE_BEGIN:"wix.code.SAVE_FILE_BEGIN",SAVE_FILE:"wix.code.SAVE_FILE",SAVE_FILE_END:"wix.code.SAVE_FILE_END",SAVE_FILE_FAILURE:"wix.code.SAVE_FILE_FAILURE",SET_FILE:"wix.code.SET_FILE",REMOVE_FILE:"wix.code.REMOVE_FILE",SET_EXPANDED:"wix.code.SET_EXPANDED",SET_LOADING:"wix.code.SET_LOADING",SET_CHILDREN:"wix.code.SET_CHILDREN",GET_CHILDREN:"wix.code.GET_CHILDREN",REMOVE_CHILD:"wix.code.REMOVE_CHILD",ADD_CHILD:"wix.code.ADD_CHILD",SET_PENDING_RENAME:"wix.code.SET_PENDING_RENAME",SET_PENDING_DELETE:"wix.code.SET_PENDING_DELETE",PAGE_EDITOR_SET_CURRENT_TAB:"wix.code.PAGE_EDITOR_SET_CURRENT_TAB",CONSOLE_ADD_MESSAGE:"wix.code.CONSOLE_ADD_MESSAGE",CONSOLE_CLEAR:"wix.code.CONSOLE_CLEAR",FIND_REPLACE_TOGGLE_VISIBLE:"wix.code.FIND_REPLACE_TOGGLE_VISIBLE",FIND_REPLACE_SET_FIND_STRING:"wix.code.FIND_REPLACE_SET_FIND_STRING",FIND_REPLACE_SET_REPLACE_STRING:"wix.code.FIND_REPLACE_SET_REPLACE_STRING",FIND_REPLACE_TOGGLE_REGEX:"wix.code.FIND_REPLACE_TOGGLE_REGEX",FIND_REPLACE_TOGGLE_CASE_SENSITIVE:"wix.code.FIND_REPLACE_TOGGLE_CASE_SENSITIVE",FIND_REPLACE_TOGGLE_WHOLE_WORD:"wix.code.FIND_REPLACE_TOGGLE_WHOLE_WORD"}}),define("wixCode/core/services/periodicSaveService",["lodash"],function(e){function t(e){s(e)}function n(e){e.wixCode.fileSystem.flush()}function i(){s=e.debounce(n,r)}function o(){e.isFunction(s.cancel)&&s.cancel()}var r=2e3,s=e.debounce(n,r);return{doSave:t,_reset:i,cancel:o}}),define("wixCode/code/actions/fileActions",["coreUtilsLib","lodash","bluebird","wixCode/core/consts","wixCode/code/reducers/codeStateReader","wixCode/core/actions/types","wixCode/core/services/periodicSaveService"],function(e,t,n,i,o,r,s){function a(e){return e.data.id}function l(e){return!e||e.get("state")===i.FILE_STATES.VIRTUAL||e.get("state")===i.FILE_STATES.LOAD_FAILED}function c(t){return function(i){return function(r,s,a){function c(e){return r(h(i,g,e)),p(),e}function d(t){return r(f(i)),p({message:t,level:a.wixCode.log.levels.ERROR}),e.log.error(t),n.reject(t)}var p=a.documentServices.wixCode.log.trace({action:"loadFile",message:{fileId:i}});if(!i){var u=new Error("fileId must be defined");throw p({message:u,level:a.wixCode.log.levels.ERROR}),u}var C=o.getFile(s(),i);if(!l(C))return p(),n.resolve(C.get("content"));r(m(i)),window.setTimeout(function(){r(E(i))},1e3);var g=a.wixCode.fileSystem.getVirtualDescriptor(i,!1);return t(a,g).then(c).catch(d)}}}function d(e,t){return e.wixCode.fileSystem.readFile(t)}function p(e){return c(d)(e)}function u(e){return p(a(e))}function m(e){return{type:r.LOAD_FILE_BEGIN,fileId:e}}function E(e){return{type:r.LOAD_FILE_CHECK_STATE,fileId:e}}function h(e,t,n){return{type:r.LOAD_FILE_END,fileId:e,descriptor:t,content:n}}function f(e){return{type:r.LOAD_FILE_FAILURE,fileId:e}}function C(e,t){return function(n,i){var s=e.location;o.getFile(i(),s)||(n(m(s)),n(h(s,e,""))),n({type:r.CHANGE_CONTENT,fileId:s,content:t})}}function g(e,t){return function(n,i,o){var r=o.documentServices.wixCode.fileSystem.getVirtualDescriptor(e,!1),a=o.documentServices.wixCode.fileSystem.writeFile(r,t);return a.then(function(e){return s.doSave(o),e}).catch(function(){}),n(C(r,t)),a}}function _(e,t){return{type:r.SET_SELECTION,fileId:e,selection:t}}return{beginLoadFile:m,endLoadFile:h,failLoadFile:f,loadFileCheckState:E,load:u,loadFile:p,wrapLoadFile:c,changeContent:g,setSelection:_}}),define("wixCode/utils/utils",["lodash","wixCode/core/consts","platform"],function(e,t,n){function i(e){return"public/"+t.PAGES_ROOT+"/"+e+t.JS_EXTENSION}function o(t,n){var i=t.components.data.get(n);return e.get(i,"controllerType")}function r(t){if(!t||!e.endsWith(t,".json"))throw new Error("Not a valid schema file name: "+t);return t.substring(0,t.length-5)}function s(e){return e+".json"}function a(e,t){var i=e.components.getType(t),r=i;return i===n.constants.CONTROLLER_COMPONENT_TYPE&&(r=o(e,t)||i),r}function l(e,t){var i=e.components.getType(t),r=e.wixCode.getCompSdkType(t),s=r;return i===n.constants.CONTROLLER_COMPONENT_TYPE&&(s=o(e,t)||r),s}return{getCollectionNameFromSchemaFileName:r,getSchemaFileNameFromCollectionName:s,getFileIdFromPageId:i,getCompTypeOrControllerType:a,getSdkTypeOrControllerType:l}}),define("wixCode/code/actions/pageActions",["coreUtilsLib","bluebird","wixCode/core/consts","wixCode/code/actions/fileActions","wixCode/core/actions/types","wixCode/utils/utils","santaIde"],function(e,t,n,i,o,r,s){function a(e){function o(i){return i.wixCode.pages.hasCode(e)?i.wixCode.pages.readCode(e):t.resolve(n.DEAFULT_EMPTY_PAGE_CONTENT)}var s=r.getFileIdFromPageId(e);return i.wrapLoadFile(o)(s)}function l(e){return a(e.data.id)}function c(e){return{type:o.PAGE_EDITOR_SET_CURRENT_TAB,currentTab:e}}function d(n,o){var a=r.getFileIdFromPageId(n);return function(n){return n(i.loadFile(a)).then(function(e){var t=s.codeExportsService.addExport(e,o);return n(i.changeContent(a,t.newCode)),n(i.setSelection(a,{start:t.caretOffset,end:t.caretOffset})),t}).catch(function(n){return e.log.error(n),t.reject(n)})}}return{load:l,loadById:a,setCurrentTab:c,addExportStatement:d}}),define("wixCode/code/services/eventService",["lodash","bluebird","wixCode/core/errors","wixCode/core/consts","wixCode/code/services/codeEditorService","santaIde","wixCode/core/store/storeManager","wixCode/code/actions/pageActions","wixCode/code/actions/fileActions","wixCode/utils/utils"],function(e,t,n,i,o,r,s,a,l,c){function d(e){if(!e)throw new n.ArgumentError("componentType","eventService.getEvents",e);return r.codeModel.default.getTypeIndex().getEventsByName(e).asList()}function p(e){return e.charAt(0).toLowerCase()+e.slice(1)}function u(e){return e.slice(2)}function m(e,t,o){if(!e)throw new n.ArgumentError("currentPageId","eventService.generateEventHandlerCode",e);if(void 0===t)throw new n.ArgumentError("showOnAllPages","eventService.generateEventHandlerCode",t);if(C(o)!==T.VALID)throw new n.ArgumentError("functionName","eventService.generateEventHandlerCode",o);var r=s.getStore(),l=t?i.SITE_JS_PAGE_ID:e,c=g({functionName:o});r.dispatch(a.addExportStatement(l,c)),r.dispatch(a.setCurrentTab(t?i.PAGE_TABS.SITE:i.PAGE_TABS.PAGE))}function E(t,n){return e(t).invokeMap(String.prototype.split,n).map(function(t){return e.parseInt(e.last(t))||0}).reduce(function(e,t){return e>t?e:t+1},1)}function h(e,t,o,l,c){function d(e){var t=E(r.codeExportsService.exportStatementsWithPrefix(e,g+f),f);return g+f+t}if(!e)throw new n.ArgumentError("currentPageId","eventService.getDefaultEventHandlerName",e);if(void 0===t)throw new n.ArgumentError("showOnAllPages","eventService.getDefaultEventHandlerName",t);if(!o)throw new n.ArgumentError("eventName","eventService.getDefaultEventHandlerName",o);if(!l)throw new n.ArgumentError("componentType","eventService.getDefaultEventHandlerName",l);if(!c)throw new n.ArgumentError("componentName","eventService.getDefaultEventHandlerName",c);var m=s.getStore(),h=t?i.SITE_JS_PAGE_ID:e,f="_",C=p(u(o)),g=c+f+C;return m.dispatch(a.loadById(h)).then(function(e){var t;try{t=r.codeExportsService.exportStatementExists(e,g)}catch(e){t=!1}return t?d(e):g})}function f(e,o,d){if(!e)throw new n.ArgumentError("currentPageId","eventService.setFocusOnEventHandler",e);if(void 0===o)throw new n.ArgumentError("showOnAllPages","eventService.setFocusOnEventHandler",o);if(!d)throw new n.ArgumentError("functionName","eventService.setFocusOnEventHandler",d);var p=s.getStore(),u=o?i.SITE_JS_PAGE_ID:e,m=c.getFileIdFromPageId(u);return p.dispatch(a.loadById(u)).then(function(e){var n;try{n=r.codeExportsService.getCaretInfoForExportStatement(e,d)}catch(e){return t.reject("cannot navigate due to code error")}return n.found&&(p.dispatch(a.setCurrentTab(o?i.PAGE_TABS.SITE:i.PAGE_TABS.PAGE)),p.dispatch(l.setSelection(m,{start:n.caretOffset,end:n.caretOffset}))),n.found})}function C(t){var n=/^(?!(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$)[a-zA-Z_$][0-9a-zA-Z_$]*$/;return e.isEmpty(t)?T.VALID:t.length>_?T.TOO_LONG:n.test(t)?T.VALID:T.INVALID_FN_NAME}var g=e.template("export function <%= functionName %>(event) { \n //Add your code for this event here: \n }"),_=128,T={VALID:"VALID",INVALID_FN_NAME:"INVALID_FN_NAME",TOO_LONG:"TOO_LONG"};return{getEvents:d,generateEventHandlerCode:m,getDefaultEventHandlerName:h,setFocusOnEventHandler:f,validateEventHandlerName:C,EVENT_HANDLER_NAME_VALIDATIONS:T}}),define("wixCode/code/services/snippetsProvider",[],function(){function e(){}function t(){return[]}return{getSnippetDescriptor:e,getSnippetsByComponentType:t}}),define("wixCode/code/services/snippetService",["wixCode/code/services/snippetsProvider","wixCode/core/errors"],function(e,t){function n(){return{componentType:"some-type",adjacents:[]}}function i(i){if(!i)throw new t.ArgumentError("componentId","snippetService.getSnippets",i);var o=n(i);return e.getSnippetsByComponentType(o.componentType,o.adjacents)}function o(n,i){if(!n)throw new t.ArgumentError("snippetId","snippetService.generateSnippetCode",n);if(!i)throw new t.ArgumentError("componentId","snippetService.generateSnippetCode",i);return"/** "+e.getSnippetDescriptor(n).id+"**/"}return{getSnippets:i,generateSnippetCode:o}}),define("wixCode/core/components/propTypes",["lodash","react","core"],function(e,t,n){var i=n.constants.DEVELOPER_MODE.CONTAINER_STATES;return{context:t.PropTypes.shape({type:t.PropTypes.oneOf(e.values(n.constants.DEVELOPER_MODE.CONTEXT_TYPES)).isRequired,data:t.PropTypes.object.isRequired}),containerState:t.PropTypes.oneOf([i.MINIMIZED,i.MAXIMIZED,i.CUSTOM])}}),define("wixCode/core/components/console/constants",[],function(){return{LOG_LEVEL:{ERROR:"ERROR",WARNING:"WARNING",INFO:"INFO",LOG:"LOG"},WIX_CODE_MESSAGE_INTENT:"WIX_CODE",WIX_CODE_MESSAGE_TYPE:"console"}}),define("wixCode/core/components/console/message/consoleMessage.rt",["react","lodash","symbols","wixCode/core/components/console/constants"],function(e,t,n,i){return function(){return e.createElement("div",{className:"wix-code-console-message "+this.props.logLevel.toLowerCase()},e.createElement("div",{className:"icon"},this.props.logLevel===i.LOG_LEVEL.ERROR?e.createElement(n.symbol,{key:"errorIcon",name:"code-console-error-icon"}):null,this.props.logLevel===i.LOG_LEVEL.WARNING?e.createElement(n.symbol,{key:"warningIcon",name:"code-console-warning-icon"}):null,this.props.logLevel===i.LOG_LEVEL.INFO?e.createElement(n.symbol,{key:"infoIcon",name:"code-console-info-icon"}):null),e.createElement("div",{className:"message"},this.props.args.join(" ")),e.createElement("div",{className:"called-from"},this.props.calledFrom))}}),define("wixCode/core/components/console/message/consoleMessage",["react","wixCode/core/components/console/message/consoleMessage.rt"],function(e,t){return e.createClass({displayName:"WixCodeConsoleMessage",propTypes:{logLevel:e.PropTypes.string.isRequired,args:e.PropTypes.array.isRequired,calledFrom:e.PropTypes.string},render:t})}),define("wixCode/core/components/toolbarButton/toolbarButton.rt",["react","lodash","symbols","baseUI"],function(e,t,n,i){return function(){return e.createElement(i.tooltip,this.getTooltipProps(),e.createElement("div",{className:"wix-code-ide-toolbar-button "+t({disabled:this.props.disabled}).transform(function(e,t,n){t&&e.push(n)},[]).join(" "),role:"button",onClick:this.props.onClick},e.createElement(n.symbol,{name:this.props.symbolName})))}}),define("wixCode/core/components/toolbarButton/toolbarButton",["react","wixCode/core/components/toolbarButton/toolbarButton.rt"],function(e,t){return e.createClass({displayName:"ideToolbarButton",propTypes:{onClick:e.PropTypes.func.isRequired,symbolName:e.PropTypes.string.isRequired,tooltipData:e.PropTypes.shape({presenter:e.PropTypes.func.isRequired,props:e.PropTypes.object.isRequired,delay:e.PropTypes.string}).isRequired,disabled:e.PropTypes.bool},getTooltipProps:function(){var t=this.props.tooltipData;return{value:e.createElement(t.presenter,t.props),delay:t.delay,disabled:this.props.disabled}},render:t})}),define("wixCode/core/components/toolbarButton/sizingButtons/sizingButtons.rt",["react","lodash","wixCode/core/components/toolbarButton/toolbarButton"],function(e,t,n){return function(){function t(){this.containerStateButtonClicked(this.actions.REVERT_MAXIMIZE)}function i(){this.containerStateButtonClicked(this.actions.MAXIMIZE)}function o(){this.containerStateButtonClicked(this.actions.REVERT_MINIMIZE)}function r(){this.containerStateButtonClicked(this.actions.MINIMIZE)}return e.createElement("div",{className:"wix-code-sizing-button-container"},this.shouldShowToolbarButton(this.actions.REVERT_MAXIMIZE)?e.createElement(n,{id:this.actions.REVERT_MAXIMIZE,key:"toolbar-revert-maximize",onClick:t.bind(this),symbolName:"revert_maximize_ide",tooltipData:this.TOOLTIP_DATA.REVERT_MAXIMIZE}):null,this.shouldShowToolbarButton(this.actions.MAXIMIZE)?e.createElement(n,{id:this.actions.MAXIMIZE,key:"toolbar-maximize",onClick:i.bind(this),symbolName:"maximize_ide",tooltipData:this.TOOLTIP_DATA.MAXIMIZE}):null,this.shouldShowToolbarButton(this.actions.REVERT_MINIMIZE)?e.createElement(n,{id:this.actions.REVERT_MINIMIZE,key:"toolbar-revert-minimize",onClick:o.bind(this),symbolName:"revert_minimize_ide",tooltipData:this.TOOLTIP_DATA.REVERT_MINIMIZE}):null,this.shouldShowToolbarButton(this.actions.MINIMIZE)?e.createElement(n,{id:this.actions.MINIMIZE,key:"toolbar-minimize",onClick:r.bind(this),symbolName:"minimize_ide",tooltipData:this.TOOLTIP_DATA.MINIMIZE}):null)}}),define("wixCode/bi/events.json",[],function(){return{LEFT_TREE_CLICK_ON_ITEM:{evid:93,src:79,endpoint:"platform",fields:{item_name:"string",item_type:"string"}},LEFT_TREE_CLICK_ON_SECTION:{evid:94,src:79,endpoint:"platform",fields:{section_name:"string",action:"string"}},LEFT_TREE_CLICK_ON_SETTINGS:{evid:95,src:79,endpoint:"platform",fields:{item_name:"string",item_type:"string"}},LEFT_TREE_CLICK_ON_PLUS:{evid:96,src:79,endpoint:"platform",fields:{section_name:"string"}},LEFT_TREE_CLICK_ON_SETTINGS_ITEM:{evid:97,src:79,endpoint:"platform",fields:{item_name:"string",item_type:"string",menu_entry_name:"string"}},LEFT_TREE_CLICK_ON_ADD_QUICK_LINK:{evid:98,src:79,endpoint:"platform",fields:{section_name:"string"}},LEFT_TREE_CLICK_ON_PLUS_ITEM:{evid:99,src:79,endpoint:"platform",fields:{section_name:"string",menu_entry_name:"string"}},LEFT_TREE_ITEM_CREATED:{evid:100,src:79,endpoint:"platform",fields:{section_name:"string",path:"string",type:"string"}},IDE_TOGGLE_JS_SITE:{evid:112,src:79,endpoint:"platform",fields:{toggle_name:"string"}},IDE_TOOLBAR_BUTTON_CLICK:{evid:113,src:79,endpoint:"platform",fields:{item_name:"string"}},IDE_TOOLBAR_TOGGLE:{evid:114,src:79,endpoint:"platform",fields:{toggle_name:"string"}},IDE_OPEN_MEDIA_MANAGER:{evid:115,src:79,endpoint:"platform",fields:{}},IDE_IMAGE_ADDED:{evid:116,src:79,endpoint:"platform",fields:{}},PROPERTIES_PANEL_NICKNAME_FOCUSED:{endpoint:"code",src:39,evid:142,fields:{element_type:"string",site_id:"guid"}},PROPERTIES_PANEL_ENABILITY_TOGGLE:{endpoint:"code",src:39,evid:145,fields:{element_type:"string",site_id:"guid",state:"string"}},PROPERTIES_PANEL_VISIBILITY_TOGGLE:{endpoint:"code",src:39,evid:146,fields:{element_type:"string",is_visible:"bool",site_id:"guid"}},PROPERTIES_PANEL_COLLAPSIBLITY_TOGGLE:{endpoint:"code",src:39,evid:147,fields:{element_type:"string",is_collapsed:"bool",site_id:"guid"}},PROPERTIES_PANEL_EVENT_HANDLER_ADD_PRESSED:{endpoint:"code",src:39,evid:148,fields:{default_handler_name:"string",element_type:"string",event:"string",site_id:"guid"}},PROPERTIES_PANEL_EVENT_HANDLER_ADDED:{endpoint:"code",src:39,evid:149,fields:{element_type:"string",event:"string",handler_name:"string",site_id:"guid"}},PROPERTIES_PANEL_EVENT_HANDLER_NAVIGATION:{endpoint:"code",src:39,evid:150,fields:{element_type:"string",event:"string",handler_name:"string",site_id:"guid"}},PROPERTIES_PANEL_EVENT_HANDLER_REMOVED:{endpoint:"code",src:39,evid:151,fields:{element_type:"string",event:"string",handler_name:"string",site_id:"guid"}},LEFT_TREE_CLICK_ON_COLLECTION:{evid:102,src:83,endpoint:"platform-cm",fields:{origin:"string",collection_name:"string"}},LEFT_TREE_CLICK_ON_PERMISSIONS:{evid:120,src:83,endpoint:"platform-cm",fields:{origin:"string",collection_name:"string"}}}}),define("wixCode/bi/bi",["wixCode/bi/events.json"],function(e){return{events:e,registerEvents:function(t){t.documentServices.bi.register("wixCode","event",e)}}}),define("wixCode/core/components/toolbarButton/sizingButtons/constants",[],function(){var e={MINIMIZE:"minimize.container",REVERT_MINIMIZE:"revert.minimize.container",MAXIMIZE:"maximize.container",REVERT_MAXIMIZE:"revert.maximize.container"},t={};return t[e.MINIMIZE]="minimize",t[e.REVERT_MINIMIZE]="open",t[e.MAXIMIZE]="maximize",t[e.REVERT_MAXIMIZE]="restore",{actions:e,actionToBIName:t}}),define("wixCode/core/components/toolbarButton/sizingButtons/sizingButtons",["react","core","baseUI","lodash","wixCode/core/components/toolbarButton/sizingButtons/sizingButtons.rt","wixCode/bi/bi","wixCode/core/components/toolbarButton/sizingButtons/constants"],function(e,t,n,i,o,r,s){var a={MAXIMIZE:{presenter:n.popoverTemplates.titleBodyAndLinkTooltip,id:"wixCodeMaximizeTooltip",props:{text:"WixCode_CodePanel_TopBar_Maximize_Tooltip"}},REVERT_MAXIMIZE:{presenter:n.popoverTemplates.titleBodyAndLinkTooltip,id:"wixCodeRevertMaximizeTooltip",props:{text:"WixCode_CodePanel_TopBar_Restore_Tooltip"}},MINIMIZE:{presenter:n.popoverTemplates.titleBodyAndLinkTooltip,id:"wixCodeMinimizeTooltip",props:{text:"WixCode_CodePanel_TopBar_Minimize_Tooltip"}},REVERT_MINIMIZE:{presenter:n.popoverTemplates.titleBodyAndLinkTooltip,id:"wixCodeRevertMinimizeTooltip",props:{text:"WixCode_CodePanel_TopBar_Open_Tooltip"}}};return e.createClass({displayName:"WixCodeSizingButtons",propTypes:{containerStateService:e.PropTypes.object.isRequired,containerState:e.PropTypes.string.isRequired,showMaximize:e.PropTypes.bool,showMinimize:e.PropTypes.bool},mixins:[t.mixins.editorAPIMixin],TOOLTIP_DATA:a,actions:s.actions,getDefaultProps:function(){return{showMaximize:!0,showMinimize:!0}},containerStateButtonClicked:function(e){switch(this.getEditorAPI().bi.event(r.events.IDE_TOOLBAR_BUTTON_CLICK,{item_name:s.actionToBIName[e]}),e){case this.actions.MINIMIZE:this.props.containerStateService.minimize();break;case this.actions.REVERT_MINIMIZE:this.props.containerStateService.revertMinimize();break;case this.actions.MAXIMIZE:this.props.containerStateService.maximize();break;case this.actions.REVERT_MAXIMIZE:this.props.containerStateService.revertMaximize()}},shouldShowToolbarButton:function(e){var n=t.constants.DEVELOPER_MODE.CONTAINER_STATES;switch(e){case this.actions.MINIMIZE:return this.props.showMinimize&&(this.props.containerState===n.MAXIMIZED||this.props.containerState===n.CUSTOM);case this.actions.REVERT_MINIMIZE:return this.props.showMinimize&&this.props.containerState===n.MINIMIZED;case this.actions.MAXIMIZE:return this.props.showMaximize&&(this.props.containerState===n.MINIMIZED||this.props.containerState===n.CUSTOM);case this.actions.REVERT_MAXIMIZE:return this.props.showMaximize&&this.props.containerState===n.MAXIMIZED}},render:o})}),define("wixCode/core/components/console/topBar/topBar.rt",["react","lodash","wixCode/core/components/toolbarButton/sizingButtons/sizingButtons","wixCode/core/components/toolbarButton/toolbarButton","util"],function(e,t,n,i,o){return function(){function t(){this.onTopBarClick()}function r(e){e.stopPropagation()}function s(){this.props.onDeleteMessages()}return e.createElement("div",{className:"wix-code-top-bar"},e.createElement("div",{className:"tool-bar",onClick:t.bind(this)},e.createElement("span",{className:"text"},o.translate("WixCode_Console_Title")),e.createElement("div",{className:"actions-container",onClick:r.bind(this)},e.createElement(i,{id:"deleteMessages",onClick:s.bind(this),symbolName:"code-console-delete-messages",tooltipData:this.tooltipData.DELETE_MESSAGES}),e.createElement(n,{id:"sizingButtons",containerStateService:this.consoleContainerStateService,containerState:this.props.containerState,showMaximize:!1,showMinimize:!0}))))}}),define("wixCode/core/services/consoleContainerStateService",[],function(){function e(e){o=e}function t(){o.consolePane.minimize()}function n(){o.consolePane.unMinimize()}function i(){return o.consolePane.minimizedByUser()}var o;return{initialize:e,minimize:t,revertMinimize:n,minimizedByUser:i}}),define("wixCode/core/components/console/topBar/topBar",["react","lodash","baseUI","core","wixCode/core/components/console/topBar/topBar.rt","wixCode/core/services/consoleContainerStateService","wixCode/core/components/propTypes"],function(e,t,n,i,o,r,s){var a={DELETE_MESSAGES:{presenter:n.popoverTemplates.titleBodyAndLinkTooltip,id:"wixCodeDeleteMessagesTooltip",props:{text:"WixCode_Console_Topbar_Delete_Messages_Tooltip_Title"}}};return e.createClass({displayName:"WixCodeConsoleTopBar",propTypes:{containerState:s.containerState.isRequired,onDeleteMessages:e.PropTypes.func.isRequired},tooltipData:a,onTopBarClick:function(){var e=i.constants.DEVELOPER_MODE.CONTAINER_STATES;this.props.containerState!==e.MAXIMIZED&&(this.props.containerState===e.MINIMIZED?r.revertMinimize():r.minimize())},consoleContainerStateService:r,render:o})}),define("wixCode/core/components/console/console.rt",["react","lodash","util","wixCode/core/components/console/message/consoleMessage","wixCode/core/components/console/topBar/topBar","baseUILib"],function(e,t,n,i,o,r){return function(){function s(t,n){return e.createElement(i,{logLevel:t.logLevel,args:t.args,key:n})}return e.createElement("div",{className:"wix-code-console "+(this.props.className||""),id:this.props.id},e.createElement(o,{containerState:this.props.containerState,onDeleteMessages:this.onDeleteMessages}),e.createElement("div",{className:"console"},this.hasMessages()?null:e.createElement("div",{className:"no-logs-to-show",key:"no-logs"},e.createElement("span",{className:"title"},n.translate("WixCode_Console_No_Messages"))),this.hasMessages()?e.createElement(r.CustomScroll,{key:"custom-scroll",ref:"customScroll",heightRelativeToParent:"100%",addScrolledClass:!1,keepAtBottom:!0},e.createElement.apply(this,["div",{className:"message-container"},t.map(this.getMessages(),s.bind(this))])):null))}}),define("wixCode/core/actions/consoleActions",["wixCode/core/actions/types"],function(e){function t(t){return{type:e.CONSOLE_ADD_MESSAGE,message:t}}function n(){return{type:e.CONSOLE_CLEAR}}return{addMessage:t,clear:n}}),define("wixCode/core/reducers/consoleStateReader",[],function(){function e(e){return e.getIn(["console"])}return{getMessages:e}}),define("wixCode/core/components/console/console",["react","reduxLibs","wixCode/core/components/console/console.rt","wixCode/core/components/propTypes","wixCode/core/actions/consoleActions","wixCode/core/reducers/consoleStateReader"],function(e,t,n,i,o,r){function s(e){return{messages:r.getMessages(e)}}var a=t.reactRedux,l=e.createClass({displayName:"WixCodeConsole",propTypes:{store:e.PropTypes.object.isRequired,containerState:i.containerState.isRequired},hasMessages:function(){return this.props.messages.size>0},getMessages:function(){return this.props.messages.toJS()},onDeleteMessages:function(){this.props.clear()},render:n});return a.connect(s,{clear:o.clear},null,{withRef:!0})(l)}),define("wixCode/core/components/console/consoleContainer.rt",["react","lodash","wixCode/core/components/console/console"],function(e,t,n){return function(){return e.createElement(n,{id:this.props.id,className:this.props.className,containerState:this.props.containerState,store:this.store})}}),define("wixCode/core/components/console/consoleContainer",["react","wixCode/core/store/storeManager","wixCode/core/components/propTypes","wixCode/core/components/console/consoleContainer.rt"],function(e,t,n,i){return e.createClass({displayName:"WixCodeConsoleContainer",propTypes:{containerState:n.containerState.isRequired},componentWillMount:function(){this.store=t.getStore()},render:i})}),define("wixCode/code/actions/collectionActions",["coreUtilsLib","bluebird","wixCode/utils/utils","wixCode/code/actions/fileActions"],function(e,t,n,i){function o(e){return e.data.id}function r(e){var t=o(e);return i.loadFile(t)}return{load:r}}),define("wixCode/core/actions/ideActions",["core","wixCode/code/actions/fileActions","wixCode/code/actions/collectionActions","wixCode/code/actions/pageActions"],function(e,t,n,i){function o(o){return o===e.constants.DEVELOPER_MODE.CONTEXT_TYPES.PAGE?i:o===e.constants.DEVELOPER_MODE.CONTEXT_TYPES.FILE?t:o===e.constants.DEVELOPER_MODE.CONTEXT_TYPES.COLLECTION?n:void 0}function r(e){return function(t){if(!e)throw new Error("`nextContext` parameter must be defined");t(o(e.type).load(e))}}function s(e,t){return function(e){e(r(t))}}return{saveCurrentAndLoadNext:s,loadNext:r}}),define("wixCode/core/components/codeEditor/codeEditor.rt",["react","lodash"],function(e,t){return function(){var t=this;return e.createElement("div",{className:"wix-code-code-editor "+this.props.className},e.createElement("div",{ref:function(e){t.codeEditorTooltipViewPlaceHolder=e}}),e.createElement("div",{id:"contentassist",className:"wix-code-content-assist"}),e.createElement("div",{ref:function(e){t.orionMountPoint=e},className:"orion-code-editor"}))}}),define("wixCode/code/actions/findReplaceActions",["wixCode/core/consts","wixCode/core/actions/types"],function(e,t){function n(e){return{type:t.FIND_REPLACE_TOGGLE_VISIBLE,visible:e}}function i(e){return function(t){e=e||{},t(n(!0)),e.findString&&t(r(e.findString)),e.replaceString&&t(s(e.replaceString))}}function o(){return n(!1)}function r(e){return{type:t.FIND_REPLACE_SET_FIND_STRING,findString:e}}function s(e){return{type:t.FIND_REPLACE_SET_REPLACE_STRING,replaceString:e}}function a(e){return{type:t.FIND_REPLACE_TOGGLE_REGEX,enabled:e}}function l(e){return{type:t.FIND_REPLACE_TOGGLE_CASE_SENSITIVE,enabled:e}}function c(e){return{type:t.FIND_REPLACE_TOGGLE_WHOLE_WORD,enabled:e}}return{show:i,hide:o,toggleVisible:n,setFindString:r,setReplaceString:s,toggleRegex:a,toggleCaseSensitive:l,toggleWholeWord:c}}),define("wixCode/code/reducers/findReplaceStateReader",[],function(){function e(e){return e.getIn(["findReplace","visible"])}function t(e){return e.getIn(["findReplace","findString"])}function n(e){return e.getIn(["findReplace","replaceString"])}function i(e){return e.get("findReplace").toJS()}return{getIsVisible:e,getFindString:t,getReplaceString:n,getFindReplaceState:i}}),define("wixCode/code/services/findReplaceProxy",["wixCode/core/store/storeManager","wixCode/code/actions/findReplaceActions","wixCode/code/reducers/findReplaceStateReader"],function(e,t,n){return{getFindString:function(){var t=e.getStore().getState();return n.getFindString(t)},getReplaceString:function(){var t=e.getStore().getState();return n.getReplaceString(t)},hide:function(){(0,e.getStore().dispatch)(t.hide())},show:function(n){var i=e.getStore().dispatch;t.show(n)(i)}}}),define("wixCode/core/components/codeEditor/codeEditor",["reactDOM","react","jquery","lodash","core","util","wixCode/core/consts","wixCode/core/components/codeEditor/codeEditor.rt","santaIde","wixCode/code/services/codeEditorService","wixCode/code/services/findReplaceProxy"],function(e,t,n,i,o,r,s,a,l,c,d){function p(e){return{start:e.start,end:e.end}}return t.createClass({displayName:"CodeEditor",mixins:[r.singlePassDOMReadWriteMixin,o.mixins.editorAPIMixin],propTypes:{fileId:t.PropTypes.string.isRequired,content:t.PropTypes.string.isRequired,contentType:t.PropTypes.string,readOnly:t.PropTypes.bool.isRequired,onContentChanged:t.PropTypes.func.isRequired,onEditorLoaded:t.PropTypes.func,onFocus:t.PropTypes.func,onBlur:t.PropTypes.func,selection:t.PropTypes.object,onSelection:t.PropTypes.func,getSymbolTable:t.PropTypes.func},render:a,getDefaultProps:function(){return{fileId:null,content:null,readOnly:!1,onContentChanged:i.noop,onEditorLoaded:i.noop,onFocus:i.noop,onBlur:i.noop,selection:{start:0,end:0},onSelection:i.noop}},componentWillMount:function(){this._lastKnownSize={width:0,height:0}},componentDidMount:function(){this._initializeCodeEditor()},componentWillReceiveProps:function(e){this.props.readOnly!==e.readOnly&&this._setReadOnly(e.readOnly)},componentDidUpdate:function(e){this.editorViewer&&this._updateOrionCodeEditorWithProps(e,this.props)},MEASURE_PATCH_EVERY_RENDER:!0,measurePhase:function(){var t=e.findDOMNode(this);return{width:t.clientWidth,height:t.clientHeight}},patchPhase:function(e){this._lastKnownSize.width===e.width&&this._lastKnownSize.height===e.height||(this._lastKnownSize=e,this._doResize())},_doResize:function(){var e=this._getTextView();e&&e.resize()},componentWillUnmount:function(){c.destroyEditor()},_moveTooltipView:function(){var e=n(".textviewTooltip").detach();n(this.codeEditorTooltipViewPlaceHolder).append(e)},_initializeCodeEditor:function(){var e=this;(new l.CodeEditor).create({parent:e.orionMountPoint,autoSave:-1,mediaManagementService:e.getEditorAPI().wixCode.media,customFindReplace:d,overviewRuler:!1,showOccurrences:!1}).then(function(t){e.editorViewer=t,t.setContents(e.props.content||"",e.props.contentType||"text/plain"),t.readonly=e.props.readOnly,e._moveTooltipView(),e._setSelection(e.props.selection),e._getTextView(t).addEventListener("ModelChanged",e._onModelChanged),e._getTextView(t).addEventListener("Selection",e._onSelection),e._getTextView(t).addEventListener("Focus",e._onFocus),e._getTextView(t).addEventListener("Blur",e._onBlur),e.editorViewer.editor.getTextView().setOptions({themeClass:"santa-theme"}),c.setEditor(t),e._refreshSymbolTable(),e.props.onEditorLoaded()})},_onSelection:function(e){var t=p(e.newValue);i.isEqual(this.props.selection,t)||this.props.onSelection(t)},_getSelection:function(){return p(this._getTextView().getSelection())},_setSelection:function(e,t){if(e=p(e),!i.isEqual(this._getSelection(),e)){var n=this;window.setTimeout(function(){n._getTextView().setSelection(e.start,e.end,!0),t&&n._getTextView().focus()},0)}},_onModelChanged:function(){this.props.content!==this._getText()&&(this.props.onContentChanged(this._getText()),this._checkSyntax())},_getTextView:function(e){return e=e||this.editorViewer,e&&e.editor?e.editor.getTextView():null},_getText:function(){var e=this._getTextView();return e?e.getText():""},_setText:function(e){this._getText()!==e&&this._getTextView().setText(e,void 0,void 0,!0)},_setReadOnly:function(e){var t=this._getTextView();t&&t.setOptions({readonly:e})},_switchFile:function(e){this.editorViewer.editor.markClean(),this._setText(e),this.editorViewer.editor.getUndoStack().reset()},_updateOrionCodeEditorWithProps:function(e,t){var n=e.fileId!==t.fileId;n?this._switchFile(t.content):this._setText(t.content),this._setSelection(t.selection,!n)},_onFocus:function(){this.props.onFocus(),this._refreshSymbolTable(!0)},_onBlur:function(){this.props.onBlur()},_refreshSymbolTable:function(e){if(!i.isUndefined(this.props.getSymbolTable)||!e){var t=this.props.getSymbolTable?this.props.getSymbolTable():l.codeModel.default.newSymbolTable();this.editorViewer.symbolService.update(t),this._checkSyntax()}},_checkSyntax:i.debounce(function(){this.editorViewer&&this.editorViewer.refreshSyntaxCheck()},500)})}),define("wixCode/code/components/codeEditorContainer/overlayPanels/failOverlayPanel.rt",["react","lodash","util"],function(e,t,n){return function(){return e.createElement("div",{className:"wix-code-page-editor-overlay"},e.createElement("div",{className:"message-container"},e.createElement("p",{className:"lead"},n.translate("WixCode_FailToLoadFile_Lead")),e.createElement("p",{className:"sub"},n.translate("WixCode_FailToLoadFile_Sub"))))}}),define("wixCode/code/components/codeEditorContainer/overlayPanels/failOverlayPanel",["react","lodash","core","wixCode/core/consts","wixCode/code/components/codeEditorContainer/overlayPanels/failOverlayPanel.rt"],function(e,t,n,i,o){return e.createClass({displayName:"FailOverlayPanel",render:o})}),define("wixCode/code/components/codeEditorContainer/overlayPanels/loadingOverlayPanel.rt",["react","lodash","baseUI"],function(e,t,n){return function(){return e.createElement("div",{className:"wix-code-page-editor-overlay"},e.createElement("div",{className:"message-container"},e.createElement(n.preloader,{ref:"preloader"})))}}),define("wixCode/code/components/codeEditorContainer/overlayPanels/loadingOverlayPanel",["react","lodash","core","wixCode/core/consts","wixCode/code/components/codeEditorContainer/overlayPanels/loadingOverlayPanel.rt"],function(e,t,n,i,o){return e.createClass({displayName:"LoadingOverlayPanel",render:o})}),define("wixCode/code/components/codeEditorContainer/codeEditorContainer.rt",["react","lodash","wixCode/core/components/codeEditor/codeEditor","wixCode/code/components/codeEditorContainer/overlayPanels/failOverlayPanel","wixCode/code/components/codeEditorContainer/overlayPanels/loadingOverlayPanel","wixCode/core/consts"],function(e,t,n,i,o,r){return function(){return e.createElement("div",{className:"wix-code-code-editor-container"},this.props.file&&this.props.file.get("state")===r.FILE_STATES.IDLE?e.createElement(n,{key:"codeEditor",fileId:this.props.fileId,content:this.props.file.get("content"),contentType:this.props.contentType,selection:this.props.selection,onContentChanged:this.onContentChanged,onFocus:this.props.onEditorFocus,onBlur:this.props.onEditorBlur,onSelection:this.onSelection,getSymbolTable:this.props.getSymbolTable}):null,this.props.file&&this.props.file.get("state")===r.FILE_STATES.LOAD_FAILED?e.createElement(i,{key:"failOverlayPanel"}):null,this.props.file&&this.props.file.get("state")===r.FILE_STATES.LOAD_TAKING_LONGER_THAN_USUAL?e.createElement(o,{key:"loadingOverlayPanel"}):null)}}),define("wixCode/code/components/codeEditorContainer/codeEditorContainer",["react","reduxLibs","wixCode/code/actions/fileActions","wixCode/code/reducers/codeStateReader","wixCode/code/components/codeEditorContainer/codeEditorContainer.rt"],function(e,t,n,i,o){function r(e,t){return{file:i.getFile(e,t.fileId),selection:i.getFileSelection(e,t.fileId)}}var s=t.reactRedux,a=e.createClass({displayName:"CodeEditorContainer",render:o,propTypes:{store:e.PropTypes.object.isRequired,file:e.PropTypes.object,fileId:e.PropTypes.string.isRequired,contentType:e.PropTypes.string,changeContent:e.PropTypes.func.isRequired,setSelection:e.PropTypes.func.isRequired,onEditorFocus:e.PropTypes.func,onEditorBlur:e.PropTypes.func,getSymbolTable:e.PropTypes.func},getDefaultProps:function(){return{contentType:"application/javascript"}},onContentChanged:function(e){this.props.changeContent(this.props.fileId,e)},onSelection:function(e){return this.props.setSelection(this.props.fileId,e)}});return s.connect(r,{changeContent:n.changeContent,setSelection:n.setSelection},null,{withRef:!0})(a)}),define("wixCode/core/services/ideContainerStateService",[],function(){function e(e){s=e}function t(){s.idePane.minimize()}function n(){s.idePane.unMinimize()}function i(){s.idePane.maximize()}function o(){s.idePane.unMaximize()}function r(e){s.treePane.toggle(e)}var s;return{initialize:e,minimize:t,revertMinimize:n,maximize:i,revertMaximize:o,toggleTree:r}}),define("wixCode/code/components/findReplace/findReplace.rt",["react","lodash","baseUI","util","symbols"],function(e,t,n,i,o){return function(){return e.createElement("div",{className:"wix-code-find-replace",onKeyDown:this.onKeyDown},e.createElement(n.textInput,{id:"findInput",className:"find-replace-input",label:"WixCode_CodePanel_Find_Label",onChange:this.handleFindChange,focus:!0,value:this.props.findString}),e.createElement("span",{className:"find-button",onClick:this.next},e.createElement(o.symbol,{name:"findReplaceNext"})),e.createElement("span",{className:"find-button previous",onClick:this.previous},e.createElement(o.symbol,{name:"findReplacePrevious"})),e.createElement("span",{className:"separator"}),e.createElement(n.textInput,{id:"replaceInput",className:"find-replace-input replace-with-input",label:"WixCode_CodePanel_Replace_With_Label",onChange:this.handleReplaceChange,value:this.props.replaceString}),e.createElement(n.button,{className:"replace-button btn-md btn-confirm-secondary",id:"replaceButton",label:"WixCode_CodePanel_Replace_Button",onClick:this.replace}),e.createElement(n.button,{className:"replace-all-button btn-md btn-confirm-secondary",id:"replaceAllButton",label:"WixCode_CodePanel_Replace_All_Button",onClick:this.replaceAll}),e.createElement("div",{className:"separator"}),e.createElement(n.toggleButton,{className:"toggle-button",name:"regex",tooltipValue:"WixCode_CodePanel_Regex_Tooltip",value:this.props.regex,onChange:this.handleToggleRegex}),e.createElement(n.toggleButton,{className:"toggle-button",name:"caseSensitive",tooltipValue:"WixCode_CodePanel_Match_Case_Tooltip",value:this.props.caseSensitive,onChange:this.handleToggleCaseSensitive}),e.createElement(n.toggleButton,{className:"toggle-button",name:"wholeWord",tooltipValue:"WixCode_CodePanel_Whole_Word_Tooltip",value:this.props.wholeWord,onChange:this.handleToggleWholeWord}))}}),define("wixCode/code/components/findReplace/findReplace",["react","reduxLibs","wixCode/core/components/propTypes","wixCode/code/actions/findReplaceActions","wixCode/code/reducers/findReplaceStateReader","wixCode/code/services/codeEditorService","wixCode/code/components/findReplace/findReplace.rt"],function(e,t,n,i,o,r,s){function a(e){return o.getFindReplaceState(e)}var l=t.reactRedux,c=e.createClass({displayName:"FindReplace",render:s,propTypes:{store:e.PropTypes.object.isRequired,hideFindReplace:e.PropTypes.func.isRequired},next:function(){r.getServices().textSearcher.next()},previous:function(){r.getServices().textSearcher.previous()},replace:function(){r.getServices().textSearcher.replace()},replaceAll:function(){r.getServices().textSearcher.replaceAll()},handleFindChange:function(e){this.props.setFindString(e),r.getServices().textSearcher.handleFindInput()},handleReplaceChange:function(e){this.props.setReplaceString(e)},handleToggleRegex:function(e){this.props.toggleRegex(e),r.getServices().textSearcher.toggleRegex(e)},handleToggleCaseSensitive:function(e){this.props.toggleCaseSensitive(e),r.getServices().textSearcher.toggleCaseSensitive(e)},handleToggleWholeWord:function(e){this.props.toggleWholeWord(e),r.getServices().textSearcher.toggleWholeWord(e)},onKeyDown:function(e){27===e.keyCode&&this.props.hideFindReplace()}});return l.connect(a,{setFindString:i.setFindString,setReplaceString:i.setReplaceString,toggleRegex:i.toggleRegex,toggleCaseSensitive:i.toggleCaseSensitive,toggleWholeWord:i.toggleWholeWord,hideFindReplace:i.hide},null,{withRef:!0})(c)}),define("wixCode/code/components/topBar/topBar.rt",["react","lodash","wixCode/core/components/toolbarButton/toolbarButton","wixCode/core/components/toolbarButton/sizingButtons/sizingButtons","wixCode/code/components/findReplace/findReplace"],function(e,t,n,i,o){return function(){function r(){this.onTopBarClick()}function s(e){e.stopPropagation()}function a(){this.toggleTree()}function l(e){e.stopPropagation()}function c(){this.undo()}function d(){this.redo()}function p(){this.searchReplace()}function u(){this.formatCode()}function m(){this.openHelp()}return e.createElement("div",{className:"wix-code-top-bar"},e.createElement("div",{className:"tool-bar",onClick:r.bind(this)},e.createElement("div",{className:"tree-button-container",onClick:s.bind(this)},e.createElement(n,{id:"toggleTree",onClick:a.bind(this),symbolName:this.getToggleTreeIcon(),tooltipData:this.getToggleTreeTooltipData()})),e.createElement("span",{className:"text"},this.props.title),e.createElement("div",{className:"actions-container",onClick:l.bind(this)},e.createElement(n,{id:"undo",onClick:c.bind(this),symbolName:"undo2",tooltipData:this.TOOLTIP_DATA.UNDO,disabled:this.isButtonDisabled()}),e.createElement(n,{id:"redo",onClick:d.bind(this),symbolName:"redo2",tooltipData:this.TOOLTIP_DATA.REDO,disabled:this.isButtonDisabled()}),e.createElement("div",{className:"search-button-container "+t({selected:this.props.findReplaceVisible}).transform(function(e,t,n){t&&e.push(n)},[]).join(" ")},e.createElement(n,{id:"findReplace",onClick:p.bind(this),symbolName:"search_replace_code",tooltipData:this.TOOLTIP_DATA.SEARCH,disabled:this.isButtonDisabled()})),e.createElement(n,{id:"formatCode",onClick:u.bind(this),symbolName:"format_code",tooltipData:this.TOOLTIP_DATA.FORMAT,disabled:this.isButtonDisabled()}),e.createElement(n,{id:"formatCode",onClick:m.bind(this),symbolName:"wix_code_topbar_help",tooltipData:this.TOOLTIP_DATA.HELP}),e.createElement(i,{containerStateService:this.ideContainerStateService,containerState:this.props.containerState,showMaximize:this.props.showMaximize,showMinimize:this.props.showMinimize}))),this.props.findReplaceVisible?e.createElement(o,{key:"findReplace",store:this.props.store}):null)}}),define("wixCode/code/components/topBar/topBar",["react","core","baseUI","reduxLibs","wixCode/core/components/propTypes","wixCode/code/reducers/findReplaceStateReader","wixCode/code/actions/findReplaceActions","wixCode/core/services/ideContainerStateService","wixCode/code/services/codeEditorService","wixCode/bi/bi","wixCode/code/components/topBar/topBar.rt"],function(e,t,n,i,o,r,s,a,l,c,d){function p(e){return{findReplaceVisible:r.getIsVisible(e)}}var u=i.reactRedux,m={SHOW_TREE_VIEW:{presenter:n.popoverTemplates.titleBodyAndLinkTooltip,id:"wixCodeShowTreeViewTooltip",props:{title:"WixCode_CodePanel_TopBar_Show_Tree_View_Tooltip_Title",text:"WixCode_CodePanel_TopBar_Show_Tree_View_Tooltip_Body"},delay:"1000"},HIDE_TREE_VIEW:{presenter:n.popoverTemplates.titleBodyAndLinkTooltip,id:"wixCodeHideTreeViewTooltip",props:{title:"WixCode_CodePanel_TopBar_Hide_Tree_View_Tooltip_Title",text:"WixCode_CodePanel_TopBar_Hide_Tree_View_Tooltip_Body"},delay:"1000"},UNDO:{presenter:n.popoverTemplates.titleBodyAndLinkTooltip,id:"wixCodeUndoTooltip",props:{text:"TOPBAR_UNDO_TOOLTIP_TITLE"}},REDO:{presenter:n.popoverTemplates.titleBodyAndLinkTooltip,id:"wixCodeRedoTooltip",props:{text:"TOPBAR_REDO_TOOLTIP_TITLE"}},SEARCH:{presenter:n.popoverTemplates.titleBodyAndLinkTooltip,id:"wixCodeSearchTooltip",props:{text:"WixCode_CodePanel_TopBar_Search_Tooltip"}},FORMAT:{presenter:n.popoverTemplates.titleBodyAndLinkTooltip,id:"wixCodeFormatTooltip",props:{text:"WixCode_CodePanel_TopBar_Format_Tooltip"}},HELP:{presenter:n.popoverTemplates.titleBodyAndLinkTooltip,id:"wixCodeHelpTooltip",props:{text:"WixCode_CodePanel_TopBar_Help_Tooltip"}}},E=e.createClass({displayName:"WixCodeTopBar",render:d,propTypes:{containerState:o.containerState.isRequired,isTreePaneOpen:e.PropTypes.bool.isRequired,title:e.PropTypes.string.isRequired,showMaximize:e.PropTypes.bool,showMinimize:e.PropTypes.bool,findReplaceVisible:e.PropTypes.bool,showFindReplace:e.PropTypes.func.isRequired,hideFindReplace:e.PropTypes.func.isRequired},mixins:[t.mixins.editorAPIMixin],getDefaultProps:function(){return{findReplaceVisible:!1}},TOOLTIP_DATA:m,ideContainerStateService:a,onTopBarClick:function(){var e=t.constants.DEVELOPER_MODE.CONTAINER_STATES;this.props.containerState!==e.MAXIMIZED&&(this.props.containerState===e.MINIMIZED?(this.getEditorAPI().bi.event(c.events.IDE_TOOLBAR_TOGGLE,{toggle_name:"open"}),a.revertMinimize()):(this.getEditorAPI().bi.event(c.events.IDE_TOOLBAR_TOGGLE,{toggle_name:"close"}),a.minimize()))},execCommandIfPaneNotMinimized:function(e,n){var i=t.constants.DEVELOPER_MODE.CONTAINER_STATES;if(this.props.containerState===i.MINIMIZED)return a.revertMinimize();this.getEditorAPI().bi.event(c.events.IDE_TOOLBAR_BUTTON_CLICK,{item_name:n}),e()},undo:function(){this.execCommandIfPaneNotMinimized(l.getServices().commandService.undo,"undo")},redo:function(){this.execCommandIfPaneNotMinimized(l.getServices().commandService.redo,"redo")},formatCode:function(){this.execCommandIfPaneNotMinimized(l.getServices().commandService.formatCode,"format")},searchReplace:function(){var e=this.props.findReplaceVisible?this.props.hideFindReplace:this.props.showFindReplace;this.execCommandIfPaneNotMinimized(e,"search")},openHelp:function(){function e(){t.panelManager.openHelpCenter("cf4866c1-7181-490c-bc4a-22330e5e97f2",{},{origin:"wixCodeHelpTooltip",panel_name:"wixCodeHelpTooltip"})}var t=this.getEditorAPI();this.execCommandIfPaneNotMinimized(e,"help")},toggleTree:function(){a.toggleTree()},getToggleTreeTooltipData:function(){return this.props.isTreePaneOpen?m.HIDE_TREE_VIEW:m.SHOW_TREE_VIEW},getToggleTreeIcon:function(){return this.props.isTreePaneOpen?"tree_icon_close":"tree_icon_open"},isButtonDisabled:function(){var e=t.constants.DEVELOPER_MODE.CONTAINER_STATES;return this.props.containerState===e.MINIMIZED}});return u.connect(p,{showFindReplace:s.show,hideFindReplace:s.hide},null,{withRef:!0})(E)}),define("wixCode/code/components/fileEditor/fileEditor.rt",["react","lodash","wixCode/code/components/codeEditorContainer/codeEditorContainer","wixCode/code/components/topBar/topBar"],function(e,t,n,i){return function(){return e.createElement("div",{className:"wix-code-file-editor wix-code-ide"},e.createElement(i,{store:this.props.store,title:this.props.context.data.name,containerState:this.props.containerState,isTreePaneOpen:this.props.isTreePaneOpen,showMaximize:!1,showMinimize:!1}),e.createElement("div",{className:"editor-body"},e.createElement(n,{store:this.props.store,fileId:this.props.context.data.id,onEditorFocus:this.onEditorFocus})))}}),define("wixCode/code/components/fileEditor/fileEditor",["react","wixCode/core/components/propTypes","wixCode/code/components/fileEditor/fileEditor.rt","util"],function(e,t,n,i){return e.createClass({displayName:"FileEditor",render:n,propTypes:{store:e.PropTypes.object.isRequired,context:t.context.isRequired,containerState:t.containerState.isRequired},onEditorFocus:function(){i.keyboardShortcuts.disable()}})}),define("wixCode/core/messages",[],function(){return{FILE_EDITOR_STATUS_SAVING_FILE:"saving...",FILE_EDITOR_STATUS_LOADING_FILE:"loading...",SITE_JS:"site.js"}}),define("wixCode/code/reducers/pageEditorStateReader",[],function(){function e(e){return e.getIn(["pageEditor","currentTab"])}return{getCurrentTab:e}}),define("wixCode/code/services/codeIntelligenceService",["lodash","santaIde","platform","wixCode/utils/utils"],function(e,t,n,i){function o(e){e(r)}function r(e){e&&e.exports&&t.codeModel.default.importTypes(e.exports)}function s(t,n){n.components=e.mapValues(n.components,function(e,n){var o=t.components.get.byId(n);return e.type=i.getCompTypeOrControllerType(t,o),e})}function a(t,n){n.components=e.mapValues(n.components,function(e,n){var o=t.components.get.byId(n);return e.sdkType=i.getSdkTypeOrControllerType(t,o),e})}function l(n,i){var o=n.wixCode.generateRemoteModelInterface(i).toJson();a(n,o),s(n,o);var r={type:"Container",children:e.map(o.connections[i],function(t,n){var i=e(t).keys().head();return e.assign({compName:n,children:[],compId:i},o.components[i])})},l=t.codeModel.default.populateSymbolTable(r);return c(l,o),l}function c(t,i){t.idTable=e.mapValues(t.idTable,function(t){return e.isUndefined(t.type)&&e.get(i.components[t.compId],"publicAPI")&&(t.type=e.assign(n.constants.TPA_WIDGET_TYPE_TEMPLATE,{eventHandlersDefinition:e.get(i.components[t.compId],"publicAPI")})),t})}return{initialize:o,getContentAssistForPage:l}}),define("wixCode/code/components/pageEditor/pageEditor.rt",["react","lodash","core","util","wixCode/code/components/codeEditorContainer/codeEditorContainer","wixCode/code/components/topBar/topBar","wixCode/core/consts"],function(e,t,n,i,o,r,s){return function(){return e.createElement("div",{className:"wix-code-page-editor"},e.createElement(r,{store:this.props.store,title:this.getTopBarTitle(),containerState:this.props.containerState,isTreePaneOpen:this.props.isTreePaneOpen}),e.createElement("div",{className:"editor-body"},e.createElement("div",{className:"tabs"},e.createElement("div",{id:"wix-code-page-editor-tabs-js",className:t({"tab-item":!0,"is-selected":this.props.currentTab===s.PAGE_TABS.PAGE}).transform(function(e,t,n){t&&e.push(n)},[]).join(" "),onClick:this.onTabChanged.bind(this,s.PAGE_TABS.PAGE)},e.createElement("span",{className:"text"},i.translate("WixCode_CodePanel_Tabs_Page"))),e.createElement("div",{id:"wix-code-page-editor-tabs-site",className:t({"tab-item":!0,"is-selected":this.props.currentTab===s.PAGE_TABS.SITE}).transform(function(e,t,n){t&&e.push(n)},[]).join(" "),onClick:this.onTabChanged.bind(this,s.PAGE_TABS.SITE)},e.createElement("span",{className:"text"},i.translate("WixCode_CodePanel_Tabs_Site")))),e.createElement(o,{store:this.props.store,fileId:this.getFileId(),onEditorFocus:this.onEditorFocus,onEditorBlur:this.onEditorBlur,getSymbolTable:this.getSymbolTable})))}}),define("wixCode/code/components/pageEditor/pageEditor",["react","lodash","core","util","wixCode/core/consts","wixCode/core/messages","wixCode/utils/utils","reduxLibs","wixCode/core/components/propTypes","wixCode/core/actions/ideActions","wixCode/code/reducers/pageEditorStateReader","wixCode/code/actions/pageActions","wixCode/code/services/codeIntelligenceService","wixCode/bi/bi","wixCode/code/components/pageEditor/pageEditor.rt"],function(e,t,n,i,o,r,s,a,l,c,d,p,u,m,E){function h(e,t){return e===o.PAGE_TABS.PAGE?t:g}function f(e){return{currentTab:d.getCurrentTab(e)}}var C=a.reactRedux,g={type:n.constants.DEVELOPER_MODE.CONTEXT_TYPES.PAGE,data:{displayName:r.SITE_JS,id:o.SITE_JS_PAGE_ID}},_=e.createClass({displayName:"PageEditor",render:E,propTypes:{store:e.PropTypes.object.isRequired,context:l.context.isRequired,currentPageId:e.PropTypes.string.isRequired,currentTab:e.PropTypes.string.isRequired,containerState:l.containerState.isRequired},mixins:[i.translationMixin,n.mixins.editorAPIMixin],componentWillReceiveProps:function(e){this.props.currentPageId!==e.currentPageId&&this.props.setCurrentTab(o.PAGE_TABS.PAGE)},componentWillMount:function(){this.props.setCurrentTab(o.PAGE_TABS.PAGE)},onTabChanged:function(e){var t=h(this.props.currentTab,this.props.context),n=h(e,this.props.context);this.getEditorAPI().bi.event(m.events.IDE_TOGGLE_JS_SITE,{toggle_name:n.data.id===o.SITE_JS_PAGE_ID?"site":"js"}),this.props.saveCurrentAndLoadNext(t,n),this.props.setCurrentTab(e)},getSymbolTable:function(){return u.getContentAssistForPage(this.getEditorAPI(),this.props.context.data.id)},onEditorFocus:function(){i.keyboardShortcuts.disable()},onEditorBlur:function(){i.keyboardShortcuts.enable()},getFileId:function(){var e=h(this.props.currentTab,this.props.context);return s.getFileIdFromPageId(e.data.id)},getTopBarTitle:function(){if(this.props.currentTab===o.PAGE_TABS.SITE)return this.translateIfNeeded("WixCode_CodePanel_TopBar_Site_Title");var e=this.props.context.data.displayName,t=this.props.context.data.isPopup?"WixCode_CodePanel_TopBar_Popup_Title":"WixCode_CodePanel_TopBar_Page_Title";return this.translateTemplate(t,{pageName:e})}});return C.connect(f,{saveCurrentAndLoadNext:c.saveCurrentAndLoadNext,setCurrentTab:p.setCurrentTab},null,{withRef:!0})(_)}),define("wixCode/core/components/ide/ide.rt",["react","lodash","wixCode/code/components/fileEditor/fileEditor","wixCode/code/components/pageEditor/pageEditor","core"],function(e,t,n,i,o){return function(){return e.createElement("div",{className:"wix-code-ide",id:this.props.id},this.props.context?e.createElement("div",{key:"EditorsContainer"},this.props.context.type===o.constants.DEVELOPER_MODE.CONTEXT_TYPES.PAGE?e.createElement(i,t.assign({},{key:"PageEditor",store:this.store},this.props)):null,this.props.context.type===o.constants.DEVELOPER_MODE.CONTEXT_TYPES.FILE?e.createElement(n,t.assign({},{key:"FileEditor",store:this.store},this.props)):null):null)}}),define("wixCode/core/components/ide/ide",["react","lodash","core","wixCode/core/store/storeManager","wixCode/core/actions/ideActions","wixCode/code/reducers/codeStateReader","wixCode/core/components/propTypes","wixCode/core/components/ide/ide.rt"],function(e,t,n,i,o,r,s,a){return e.createClass({displayName:"IDE",mixins:[n.mixins.editorAPIMixin],propTypes:{context:s.context.isRequired,currentPageId:e.PropTypes.string.isRequired,containerState:s.containerState.isRequired,isTreePaneOpen:e.PropTypes.bool.isRequired},render:a,componentWillMount:function(){this.store=i.getStore(),this.store.dispatch(o.loadNext(this.props.context))},shouldComponentUpdate:function(e){return this._wasPageOrContextChanged(e)||this._wasIdeContainerStateChanged(e)||this._wasTreePaneStateChanged(e)},componentWillUpdate:function(e){this._wasPageOrContextChanged(e)&&this.store.dispatch(o.saveCurrentAndLoadNext(this.props.context,e.context))},_wasPageOrContextChanged:function(e){return this.props.currentPageId!==e.currentPageId||!t.isEqual(this.props.context,e.context)},_wasIdeContainerStateChanged:function(e){return this.props.containerState!==e.containerState},_wasTreePaneStateChanged:function(e){return this.props.isTreePaneOpen!==e.isTreePaneOpen}})}),define("wixCode/code/actions/fileSystemActions",["lodash","bluebird","coreUtilsLib","wixCode/core/actions/types","wixCode/code/reducers/codeStateReader","wixCode/code/actions/fileActions"],function(e,t,n,i,o,r){function s(e){return{type:i.SET_FILE,file:e}}function a(e){return function(n,i,r){var s=r.documentServices.wixCode.log.trace({action:"expand",message:{fileId:e}}),a=i(),l=o.getFileSystemEntry(a,e).toJS();return l.loaded||l.loading?(n(_(e,!0)),s(),t.resolve()):(n(h(e,!0)),r.wixCode.fileSystem.getChildren(l.descriptor).then(function(t){n(f(e,t)),n(_(e,!0)),s()}).catch(function(e){throw s({message:e,level:r.wixCode.log.levels.ERROR}),e}).finally(function(){n(h(e,!1))}))}}function l(t){return function(n,i,r){var s=r.documentServices.wixCode.log.trace({action:"getChildren",message:{fileId:t}}),a=i(),l=o.getFileSystemEntry(a,t).toJS();return r.wixCode.fileSystem.getChildren(l.descriptor).then(function(t){return s(),e.map(t,function(t){return e.pick(t,["name","location"])})}).catch(function(e){throw s({message:e,level:r.wixCode.log.levels.ERROR}),e})}}function c(e){return function(t,n,i){t(v(e,!0));var r=i.documentServices.wixCode.log.trace({action:"deleteFile",message:{fileId:e}}),s=n(),a=o.getFileSystemEntry(s,e).toJS(),l=o.getFileSystemParentOf(s,e).toJS();return i.wixCode.fileSystem.deleteItem(a.descriptor).then(function(){l&&t(I(l.id,e)),r(),t(T(e))}).catch(function(n){throw r({message:n,level:i.wixCode.log.levels.ERROR}),t(v(e,!1)),n})}}function d(e,t){return function(n,i,r){var s=r.documentServices.wixCode.log.trace({action:"renameFile",message:{fileId:e,newName:t}}),a=i(),l=o.getFileSystemEntry(a,e).toJS(),c=o.getFileSystemParentOf(a,e).toJS();return n(S(e,t)),r.wixCode.fileSystem.move(l.descriptor,c.descriptor,t).then(function(t){return n(I(c.id,e)),n(T(e)),n(C(c.id,t)),s(),t.location}).catch(function(t){throw n(S(e,null)),s({message:t,level:r.wixCode.log.levels.ERROR}),t})}}function p(e,t){return function(i,r,s){var a=s.documentServices.wixCode.log.trace({action:"createFolder",message:{parentId:e,childName:t}}),l=r(),c=o.getFileSystemEntry(l,e).toJS(),d=E(s,t,c.descriptor,!0),p=d.location;return i(g(e,d)),s.documentServices.wixCode.fileSystem.createFolder(t,c.descriptor).then(function(t){return i(C(e,t)),a(),t.location}).catch(function(t){throw n.log.error(t),i(I(e,p)),i(T(p)),a({message:t,level:s.wixCode.log.levels.ERROR}),t})}}function u(t,n,i){return n===t.wixCode.fileSystem.getRoots().schemas.location&&e.endsWith(i,".json")}function m(e,t,i){return function(s,a,l){var c=i||"",d=l.documentServices.wixCode.log.trace({action:"createFile",message:{parentId:e,childName:t}}),p=a(),m=o.getFileSystemEntry(p,e).toJS(),h=E(l,t,m.descriptor,!1),f=h.location;return s(g(e,h)),s(r.changeContent(h.location,c)).then(function(n){return u(l,e,t)&&l.onCollectionAdded(),s(C(e,n)),d(),n.location}).catch(function(t){throw n.log.error(t),s(I(e,f)),s(T(f)),d({message:t,level:l.wixCode.log.levels.ERROR}),t})}}function E(e,t,n,i){return e.wixCode.fileSystem.getVirtualDescriptor(n.location+t,i)}function h(e,t){return{type:i.SET_LOADING,fileId:e,loading:t}}function f(e,t){return{type:i.SET_CHILDREN,fileId:e,children:t}}function C(e,t){return{type:i.ADD_CHILD,fileId:e,pendingCreation:!1,child:t}}function g(e,t){return{type:i.ADD_CHILD,fileId:e,pendingCreation:!0,child:t}}function _(e,t){return{type:i.SET_EXPANDED,fileId:e,expanded:t}}function T(e){return{type:i.REMOVE_FILE,fileId:e}}function I(e,t){return{type:i.REMOVE_CHILD,fileId:e,childId:t}}function S(e,t){return{type:i.SET_PENDING_RENAME,fileId:e,pendingRename:t}}function v(e,t){return{type:i.SET_PENDING_DELETE,fileId:e,pendingDelete:t}}function x(e){return _(e,!1)}return{setFile:s,renameFile:d,createFile:m,createFolder:p,delete:c,expand:a,collapse:x,getChildren:l,setChildren:f}}),define("wixCode/core/mixins/renameMixin",["react","core","bluebird"],function(e,t,n){return{getInitialState:function(){return{rename:null}},onRenameHide:function(){this.setState({rename:null})},onRenameApply:function(e,t,i,o){return this.setState({rename:null}),o===t?n.resolve():e?n.reject("Folder renaming not implemented yet"):void i(o)},showRenameInput:function(e,t){var i,o=this;if(t)i=e.length;else{var r=e.lastIndexOf(".");i=-1===r?e.length:r}return new n(function(e){o.setState({rename:{initialSelectionLength:i}},e)})}}}),define("wixCode/core/components/contextMenuItem/contextMenuItem.rt",["react","lodash","symbols"],function(e,t,n){return function(){return e.createElement("div",{className:"wix-code-context-menu-item"},e.createElement("div",{className:"icon"},e.createElement(n.symbol,{name:this.props.symbolName})),e.createElement("span",{className:"label"},this.props.label))}}),define("wixCode/core/components/contextMenuItem/contextMenuItem",["react","wixCode/core/components/contextMenuItem/contextMenuItem.rt"],function(e,t){return e.createClass({displayName:"ContextMenuItem",propTypes:{symbolName:e.PropTypes.string.isRequired,label:e.PropTypes.string.isRequired},render:t})}),define("wixCode/core/components/nameInput/nameInput.rt",["react","lodash","baseUI"],function(e,t,n){return function(){return e.createElement(n.textInput,{ref:"theInput",focus:!0,initialSelectionStart:0,initialSelectionEnd:this.props.initialSelectionLength,value:this.state.value,validator:this.props.validator,invalidMessage:this.props.invalidMessage,onChange:this.onChange,onChangeInValidationStatus:this.onChangeInValidationStatus,blurOnEnterKey:!1,blurOnEscKey:!1,onBlur:this.onBlur,onKeyDown:this.onKeyDown})}}),define("wixCode/core/components/nameInput/nameInput",["react","lodash","wixCode/core/components/nameInput/nameInput.rt"],function(e,t,n){return e.createClass({displayName:"NameInput",propTypes:{initialValue:e.PropTypes.string.isRequired,onApply:e.PropTypes.func.isRequired,onHide:e.PropTypes.func.isRequired},componentWillMount:function(){this.setState({value:this.props.initialValue,isValid:!0})},onChange:function(e){this.setState({value:e})},onChangeInValidationStatus:function(e){this.setState({isValid:e})},onKeyDown:function(e){"Escape"===e.key?this.props.onHide():"Enter"===e.key&&this.state.isValid&&this.props.onApply(this.state.value.trim())},onBlur:function(){this.state.isValid?this.props.onApply(this.state.value.trim()):this.props.onHide()},render:n})}),define("wixCode/core/components/pagesTree/pagesTree.rt",["react","lodash","symbols","baseUI","baseUILib","wixCode/core/components/contextMenuItem/contextMenuItem","util","experiment","wixCode/core/components/nameInput/nameInput"],function(e,t,n,i,o,r,s,a,l){return function(){function c(t,n,o){return e.createElement(i.dropDown.option,{value:n.event,key:"context-menu-action"+o},e.createElement(r,{symbolName:n.icon||"file",label:n.title}))}function d(t,n,o){return e.createElement(i.dropDown.option,{value:n.event,key:"context-menu-action"+o},e.createElement(r,{symbolName:n.icon||"file",label:n.title}))}function p(t,n,i){return e.createElement("li",{key:n.id},e.createElement(t,{devModeContext:this.props.devModeContext,dataSource:n,onPageSelected:this.props.onPageSelected}))}function u(){var u=this.getTreeClass();return e.createElement("div",{className:t({"wix-code-pages-tree":!0,root:this.isRoot(),rootType:this.getRootType()}).transform(function(e,t,n){t&&e.push(n)},[]).join(" ")},e.createElement("div",{className:t({"node-content":!0,selectable:this.isSelectable()&&!this.state.rename,selected:this.isSelected()&&!this.state.rename}).transform(function(e,t,n){t&&e.push(n)},[]).join(" "),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.onNodeClick},e.createElement("span",{className:"icon"},this.isRoot()&&!this.state.collapsed?e.createElement(n.symbol,{key:"icon_root_open",name:"root_folder_open"}):null,this.isRoot()&&this.state.collapsed?e.createElement(n.symbol,{key:"icon_root_closed",name:"root_folder_closed"}):null,this.isPage()?e.createElement(n.symbol,{key:"icon_page",name:"page"}):null,this.isLink()?e.createElement(n.symbol,{key:"icon_link",name:"pageItemLinkIcon"}):null,this.isPopup()?e.createElement(n.symbol,{key:"icon_popup",name:"popup"}):null,this.isMenuHeader()?e.createElement(n.symbol,{key:"icon_menu_header",name:"pageItemDropdownIcon"}):null),this.state.rename?null:e.createElement("span",{className:"label",key:"label"},this.props.dataSource.label),!this.state.rename&&(this.shouldShowStaticPageContextMenu()||this.shouldShowRootContextMenu()||this.shouldShowDynamicPageContextMenu())&&a.isOpen("dpages")?e.createElement.apply(this,[i.dropDown.contextMenu,{className:"wix-code-pages-tree-dd",key:"contextMenu",ref:"contextMenu",icon:this.isCustomRouter()||this.isPage()||this.isDataBindingRouter()?"file_menu":"root_folder_menu",onClick:this.onContextMenuClick,onChange:this.actionSelectedHandler.bind(this,this.props.dataSource)},this.isSettableItem()?e.createElement(i.dropDown.option,{value:this.ACTIONS.OPEN_SETTINGS,key:"action-open-settings"},e.createElement(r,{symbolName:"quickActionsSettings",label:s.translate("Platform_Page_Actions_Page_Settings")})):null,this.isSettableItem()&&!this.isMobileViewMode()&&this.isLinkablePage()?e.createElement(i.dropDown.option,{key:"quick-action-separator",className:"separator"},e.createElement(o.Divider,{long:!0})):null,this.isPagesRoot()&&!this.isMobileViewMode()?e.createElement(i.dropDown.option,{value:this.ACTIONS.ADD_CUSTOM_ROUTER,key:"action-new-custom-routing-url"},e.createElement(r,{symbolName:"router_icon",label:s.translate("PLATFORM_ROUTING_SITEMENU_PAGES_ADD_ROUTER")})):null,this.isPage()&&this.isLinkablePage()&&!this.isDynamicPage()&&!this.isMobileViewMode()?e.createElement(i.dropDown.option,{value:this.ACTIONS.SET_AS_DYNAMIC_PAGE,key:"action-add-custom-routing-page"},e.createElement(r,{symbolName:"page_dynamic_icon",label:s.translate("Platform_Page_Actions_Set_Dynamic_Page")})):null,this.isRouter()&&!this.isMobileViewMode()?t.map(this.getRouterContextMenuItems(),c.bind(this,u)):null,this.isDynamicPage()&&!this.isMobileViewMode()?t.map(this.getDynamicPagesContextMenuItems(),d.bind(this,u)):null]):null,this.state.rename?e.createElement(l,{key:"rename-input",initialValue:this.props.dataSource.label,initialSelectionLength:this.state.rename.initialSelectionLength,validator:this.validatePageName,invalidMessage:s.validate.pageNameValidator,onHide:this.onRenameHide,onApply:this.onRenameApply.bind(this,!1,this.props.dataSource.label,this.renamePage)}):null),this.state.collapsed?null:e.createElement.apply(this,["ul",{className:"subtree",key:"subtree",shouldShowContextMenukey:"subtree"},t.map(this.props.dataSource.items,p.bind(this,u))]))}return u.apply(this,[])}}),define("wixCode/core/components/pagesTree/pagesTree",["react","lodash","core","panels","util","wixCode/core/components/propTypes","wixCode/core/mixins/renameMixin","platform","wixCode/bi/bi","wixCode/core/components/pagesTree/pagesTree.rt"],function(e,t,n,i,o,r,s,a,l,c){var d=e.createClass({displayName:"PagesTree",mixins:[n.mixins.editorAPIMixin,s],propTypes:{devModeContext:r.context.isRequired,dataSource:e.PropTypes.object.isRequired,onPageSelected:e.PropTypes.func},componentWillMount:function(){this.editorAPI=this.getEditorAPI(),this.dataBindingAppData=this.editorAPI.documentServices.platform.getAppDataByAppDefId(this.editorAPI.documentServices.platform.editorApps.DATA_BINDING.appDefId),this.dynamicPagesAppData=this.editorAPI.documentServices.platform.getAppDataByAppDefId(this.editorAPI.documentServices.platform.editorApps.DYNAMIC_PAGES.appDefId)},getInitialState:function(){return{collapsed:!1,hasMouseInside:!1}},ACTIONS:{ADD_CUSTOM_ROUTER:"addCustomRouter",SET_AS_DYNAMIC_PAGE:"setAsDynamicPage",ADD_DYNAMIC_PAGE:"addDynamicPageClicked",RENAME_PAGE:"Pages_Actions_Page_Rename",OPEN_SETTINGS:"Open_Settings_Panel"},getTreeClass:function(){return d},renamePage:function(e){this.editorAPI.pages.data.update(this.props.dataSource.pageData.id,{title:e}),this.editorAPI.history.add("Rename Page")},validatePageName:function(e){return!o.validate.pageNameValidator(e)},onNodeClick:function(){if(this.isRoot())return this.getEditorAPI().bi.event(l.events.LEFT_TREE_CLICK_ON_SECTION,{section_name:"pages",action:this.state.collapsed?"open":"close"}),void this.setState({collapsed:!this.state.collapsed});(this.isPage()||this.isPopup())&&this.props.onPageSelected&&this.props.onPageSelected(this.props.dataSource.pageData,this.props.dataSource.type)},isSettableItem:function(){return this.isPage()||this.isDynamicPage()},getRootType:function(){return this.props.dataSource.type},isRoot:function(){return this.props.dataSource.isRoot},isPagesRoot:function(){return this.props.dataSource.isRoot&&"__PAGES__"===this.props.dataSource.id},isCustomRouter:function(){return!!this.props.dataSource.routerType&&this.props.dataSource.routerType===n.constants.ROUTER_TYPES.CUSTOM_ROUTER},isDataBindingRouter:function(){return!!this.props.dataSource.routerType&&this.props.dataSource.routerType===n.constants.ROUTER_TYPES.DATA_BINDING},isRouter:function(){return this.isCustomRouter()||this.isDataBindingRouter()},isPage:function(){return!this.isRoot()&&this.props.dataSource.type.isPage},isDynamicPage:function(){return!this.isRoot()&&this.props.dataSource.type.isDynamicPage},isPopup:function(){return!this.isRoot()&&this.props.dataSource.type.isPopup},isLink:function(){return!this.isRoot()&&this.props.dataSource.type.isLink},isMenuHeader:function(){return!this.isRoot()&&this.props.dataSource.type.isDropdown},isSelectable:function(){return this.isPage()||this.isPopup()},isSelected:function(){return!(!this.isPage()&&!this.isPopup())&&(this.props.devModeContext.type===n.constants.DEVELOPER_MODE.CONTEXT_TYPES.PAGE&&this.props.devModeContext.data.id===this.props.dataSource.pageData.id)},onMouseEnter:function(){this.setState({hasMouseInside:!0})},onMouseLeave:function(){this.setState({hasMouseInside:!1})},isLinkablePage:function(){return this.editorAPI.documentServices.routers.pages.isConnectablePage(this.props.dataSource.pageData.id)},shouldShowStaticPageContextMenu:function(){return this.isPage()&&(this.state.hasMouseInside||this.refs.contextMenu&&this.refs.contextMenu.isExpanded())},shouldShowDynamicPageContextMenu:function(){return this.isDynamicPage()&&(this.state.hasMouseInside||this.refs.contextMenu&&this.refs.contextMenu.isExpanded())},shouldShowRootContextMenu:function(){return(this.isPagesRoot()||this.isCustomRouter()||this.isDataBindingRouter())&&!this.isMobileViewMode()&&(this.state.hasMouseInside||this.isSelected()||this.refs.contextMenu&&this.refs.contextMenu.isExpanded())},onContextMenuClick:function(e){this.isPagesRoot()?this.getEditorAPI().bi.event(l.events.LEFT_TREE_CLICK_ON_PLUS,{section_name:"pages"}):this.getEditorAPI().bi.event(l.events.LEFT_TREE_CLICK_ON_SETTINGS,{item_name:t.get(this.props,"dataSource.pageData.id"),item_type:this.props.dataSource.type.isDynamicPage?"dynamic_page":"page"}),e.stopPropagation()},getRouterContextMenuItems:function(){return this.editorAPI.pages.dynamicPages.getRouterActionOptions(this.props.dataSource.prefix)},getDynamicPagesContextMenuItems:function(){return this.editorAPI.pages.dynamicPages.getDynamicPageOptions(this.props.dataSource.pageData.id,"pageActions")},isMobileViewMode:function(){var e=this.editorAPI.documentServices.viewMode;return e.get()===e.VIEW_MODES.MOBILE},actionSelectedHandler:function(e,n){switch(this.isPagesRoot()?this.getEditorAPI().bi.event(l.events.LEFT_TREE_CLICK_ON_PLUS_ITEM,{section_name:"pages",menu_entry_name:n}):this.getEditorAPI().bi.event(l.events.LEFT_TREE_CLICK_ON_SETTINGS_ITEM,{item_name:t.get(this.props,"dataSource.pageData.id"),item_type:this.props.dataSource.type.isDynamicPage?"dynamic_page":"page",menu_entry_name:n}),n){case this.ACTIONS.OPEN_SETTINGS:return this.editorAPI.navigateAndOpenPagesPanel(this.props.dataSource.pageData.id,{menuItemToShowSettingsFor:e});case a.constants.pages.page_actions.rename.title:return this.showRenameInput(e.label,!0);case this.ACTIONS.SET_AS_DYNAMIC_PAGE:var i=e.pageData.id;return void this.editorAPI.documentServices.platform.notifyApplication(this.dataBindingAppData.applicationId,{eventType:"addDynamicPageClicked",eventPayload:{pageRef:this.editorAPI.documentServices.pages.getReference(i),origin:"idePagesTree"}});case this.ACTIONS.ADD_DYNAMIC_PAGE:return void this.editorAPI.documentServices.platform.notifyApplication(this.dataBindingAppData.applicationId,{eventType:"addDynamicPageClicked",eventPayload:{prefix:e.prefix,origin:"idePagesTree"}});case this.ACTIONS.ADD_CUSTOM_ROUTER:return void this.editorAPI.documentServices.platform.notifyApplication(this.dynamicPagesAppData.applicationId,{eventType:"addDynamicPageClicked",eventPayload:{publicUrl:this.editorAPI.documentServices.generalInfo.getPublicUrl(),origin:"idePagesTree"}});default:var o,r;e.prefix?o=this.editorAPI.documentServices.routers.getRouterRef.byPrefix(e.prefix):(r=this.editorAPI.documentServices.pages.getReference(e.pageData.id),o=this.editorAPI.documentServices.routers.getRouterRef.byPage(r));var s=this.editorAPI.documentServices.routers.get.byRef(o),c={routerRef:o,publicUrl:this.editorAPI.documentServices.generalInfo.getPublicUrl(),origin:"idePagesTree"};r&&(c.pageRef=r);var d=t.get(this.editorAPI.documentServices.platform.getAppDataByAppDefId(s.appDefinitionId),"applicationId");this.editorAPI.documentServices.platform.notifyApplication(d,{eventType:n,eventPayload:c})}},render:c});return d}),define("wixCode/core/components/fileTree/fileTree.rt",["react","lodash","baseUILib","util","symbols","baseUI","wixCode/core/components/nameInput/nameInput","wixCode/core/components/contextMenuItem/contextMenuItem"],function(e,t,n,i,o,r,s,a){return function(){function l(t,n,i){return e.createElement("li",{key:"child-"+n.name},e.createElement(t,{store:this.props.store,devModeContext:this.props.devModeContext,id:n.id,isBackend:this.props.isBackend,onFileSelected:this.props.onFileSelected,onFileDelete:this.props.onFileDelete,isReservedFileSystemItem:this.props.isReservedFileSystemItem,isReservedChildNameInParent:this.isReservedChildName,isDuplicateChildNameInParent:this.isDuplicateChildName,onOpenWebmodulePermissions:this.props.onOpenWebmodulePermissions}))}function c(){var c=this.getTreeClass();return e.createElement("div",{className:t({"wix-code-file-tree":!0,root:this.props.isRoot}).transform(function(e,t,n){t&&e.push(n)},[]).join(" ")},e.createElement("div",{className:t({"node-content":!0,pending:this.hasPendingOperation(),selectable:this.isSelectable()&&!this.state.rename,selected:this.isSelected()&&!this.state.rename}).transform(function(e,t,n){t&&e.push(n)},[]).join(" "),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.onNodeClick},this.hasPendingOperation()?e.createElement("span",{className:"icon",key:"preloader"},e.createElement(r.preloader,{})):null,this.hasPendingOperation()?null:e.createElement("span",{className:"icon",key:"icon"},this.props.isFolder?null:e.createElement(o.symbol,{key:"icon_file",name:this.getFileSymbolName(this.props.name)}),this.props.isFolder&&!this.props.expanded?e.createElement(o.symbol,{key:"icon_folder_closed",name:this.props.isRoot?"root_folder_closed":"folder_closed"}):null,this.props.isFolder&&this.props.expanded?e.createElement(o.symbol,{key:"icon_folder_open",name:this.props.isRoot?"root_folder_open":"folder_open"}):null),this.state.rename?null:e.createElement("span",{className:"label",key:"label"},this.props.pendingRename||this.props.labelOverride||this.props.name),this.shouldShowContextMenu()?e.createElement(r.dropDown.contextMenu,{className:"wix-code-file-tree-dd",key:"contextMenu",ref:"contextMenu",icon:this.props.isRoot&&this.props.isFolder?"root_folder_menu":"file_menu",onClick:this.onContextMenuClick,onChange:this.actionSelectedHandler},this.props.isFolder&&this.props.isBackend?e.createElement(r.dropDown.option,{value:this.QUICK_ACTIONS.NEW_JSW_FILE,key:"action-new-jsw-file"},e.createElement(a,{symbolName:"file-jsw",label:i.translate("WixCode_TreeView_FileTree_QuickActions_NewJswFile")})):null,this.props.isFolder?e.createElement(r.dropDown.option,{value:this.QUICK_ACTIONS.NEW_JS_FILE,key:"action-new-js-file"},e.createElement(a,{symbolName:"file-js",label:i.translate("WixCode_TreeView_FileTree_QuickActions_NewJsFile")})):null,this.props.isFolder?e.createElement(r.dropDown.option,{value:this.QUICK_ACTIONS.NEW_FILE,key:"action-new-file"},e.createElement(a,{symbolName:"file",label:i.translate("WixCode_TreeView_FileTree_QuickActions_NewFile")})):null,this.props.isFolder?e.createElement(r.dropDown.option,{value:this.QUICK_ACTIONS.NEW_FOLDER,key:"action-new-folder"},e.createElement(a,{symbolName:"folder_closed",label:i.translate("WixCode_TreeView_FileTree_QuickActions_NewFolder")})):null,this.props.isFolder&&!this.props.isRoot?e.createElement(r.dropDown.option,{className:"separator",key:"action-separator"},e.createElement(n.Divider,{long:!0})):null,this.props.isRoot||this.props.isFolder?null:e.createElement(r.dropDown.option,{value:this.QUICK_ACTIONS.RENAME,key:"action-rename"},e.createElement(a,{symbolName:"quickActionsRename",label:i.translate("WixCode_TreeView_FileTree_QuickActions_Rename")})),this.props.isRoot?null:e.createElement(r.dropDown.option,{value:this.QUICK_ACTIONS.DELETE,key:"action-delete"},e.createElement(a,{symbolName:"qaDelete",label:i.translate("WixCode_TreeView_FileTree_QuickActions_Delete")})),!this.props.isRoot&&this.isWebModule()?e.createElement(r.dropDown.option,{value:this.QUICK_ACTIONS.OPEN_WEBMODULE_PERMISSIONS,key:"action-delete"},e.createElement(a,{symbolName:"quickActionsRename",label:i.translate("WixCode_TreeView_FileTree_QuickActions_OpenWebmodulePermissions")})):null):null,this.state.rename?e.createElement(s,{key:"rename-input",initialValue:this.props.name,initialSelectionLength:this.state.rename.initialSelectionLength,validator:[i.validate.notEmptyString,this.validateNotReservedInParent,this.validateNotDuplicateInParent,this.validateLegalFileName],invalidMessage:["WixCode_FileNameValidationError_Empty","WixCode_FileNameValidationError_Reserved","WixCode_FileNameValidationError_Duplicate","WixCode_FileNameValidationError_Invalid"],onHide:this.onRenameHide,onApply:this.onRenameApply.bind(this,this.props.isFolder,this.props.name,this.renameFile)}):null),this.props.expanded?e.createElement.apply(this,["ul",{className:"subtree",key:"subtree"},!this.props.isRoot||this.state.newChild||this.props.childItems.length?null:e.createElement("li",{className:"empty-dir-message",key:"empty-dir-message"},e.createElement(r.button,{label:this.props.isBackend?"WixCode_TreeView_AddWebModuleToDirectory":"WixCode_TreeView_AddFileToDirectory",className:"btn-text link",onClick:this.onQuickAddItemClick})),this.state.newChild?e.createElement("li",{key:"new-child"},e.createElement(s,{initialValue:this.state.newChild.initialName,initialSelectionLength:this.state.newChild.initialSelectionLength,validator:[i.validate.notEmptyString,this.validateNotReservedChildName,this.validateNotDuplicateChildName,this.validateLegalFileName],invalidMessage:["WixCode_FileNameValidationError_Empty","WixCode_FileNameValidationError_Reserved","WixCode_FileNameValidationError_Duplicate","WixCode_FileNameValidationError_Invalid"],onHide:this.onNewChildHide,onApply:this.onNewChildApply})):null,t.map(this.props.childItems,l.bind(this,c))]):null)}return c.apply(this,[])}}),define("wixCode/core/components/fileTree/fileTree",["react","lodash","bluebird","core","reduxLibs","wixCode/code/actions/fileSystemActions","wixCode/code/reducers/codeStateReader","wixCode/core/components/propTypes","wixCode/core/components/fileTree/fileTree.rt","wixCode/core/consts","wixCode/core/mixins/renameMixin","wixCode/bi/bi"],function(e,t,n,i,o,r,s,a,l,c,d,p){function u(e){e.panelManager.openPanel("wixCode.panels.fileSystemOperationErrorPanel")}function m(e){return e.replace(/\.jsw$/,"")}function E(e){return t.endsWith(e,".jsw")}function h(e){var t=e.split(".");return 1===t.length||""===t[0]&&2===t.length?"":t.pop()}function f(e,n,i){var o=i.map(function(t){var n=s.getFileSystemEntry(e,t);return{id:n.get("id"),name:n.get("descriptor").get("name"),pendingCreation:n.get("pendingCreation"),isFolder:n.get("descriptor").get("directory")}}).toArray();return t(o).reject(function(e){return n.isReservedFileSystemItem(n.id,e.name)}).orderBy(["pendingCreation","isFolder","name"],["desc","desc","asc"]).value()}function C(e,t){var n=s.getFileSystemEntry(e,t.id);return{name:n.get("descriptor").get("name"),pendingRename:n.get("pendingRename"),pendingDelete:n.get("pendingDelete"),pendingCreation:n.get("pendingCreation"),isFolder:n.get("descriptor").get("directory"),childItems:f(e,t,n.get("childIds")),expanded:n.get("expanded"),loading:n.get("loading")}}var g=o.reactRedux,_=/^[\w-](?:[\w\.-]*[\w-])*$/,T=e.createClass({displayName:"FileTree",mixins:[d,i.mixins.editorAPIMixin],propTypes:{store:e.PropTypes.object.isRequired,devModeContext:a.context.isRequired,id:e.PropTypes.string.isRequired,isRoot:e.PropTypes.bool,isBackend:e.PropTypes.bool,labelOverride:e.PropTypes.string,isReservedFileSystemItem:e.PropTypes.func,isReservedChildNameInParent:e.PropTypes.func,isDuplicateChildNameInParent:e.PropTypes.func,onFileSelected:e.PropTypes.func.isRequired,onFileDelete:e.PropTypes.func.isRequired,onOpenWebmodulePermissions:e.PropTypes.func,name:e.PropTypes.string.isRequired,pendingRename:e.PropTypes.string,isFolder:e.PropTypes.bool.isRequired,childItems:e.PropTypes.array.isRequired,loading:e.PropTypes.bool.isRequired,expanded:e.PropTypes.bool.isRequired},getDefaultProps:function(){return{isReservedChildNameInParent:t.constant(!1),isDuplicateChildNameInParent:t.constant(!1),isReservedFileSystemItem:t.constant(!1)}},getInitialState:function(){return{hasMouseInside:!1,newChild:null}},QUICK_ACTIONS:{NEW_FOLDER:"NEW_FOLDER",NEW_FILE:"NEW_FILE",NEW_JS_FILE:"NEW_JS_FILE",NEW_JSW_FILE:"NEW_JSW_FILE",DELETE:"DELETE",RENAME:"RENAME",OPEN_WEBMODULE_PERMISSIONS:"OPEN_WEBMODULE_PERMISSIONS"},onMouseEnter:function(){this.setState({hasMouseInside:!0})},renameFile:function(e){var n=this.getEditorAPI();return this.props.renameFile(this.props.id,e).then(this.props.onFileSelected).catch(t.partial(u,n))},isRouterFile:function(){return"routers.js"===this.props.name},isWebModule:function(){return E(this.props.name)&&this.props.isBackend},onMouseLeave:function(){this.setState({hasMouseInside:!1})},onContextMenuClick:function(e){this.props.isRoot?this.getEditorAPI().bi.event(p.events.LEFT_TREE_CLICK_ON_PLUS,{section_name:this.props.name}):this.getEditorAPI().bi.event(p.events.LEFT_TREE_CLICK_ON_SETTINGS,{item_name:this.props.id,item_type:this.props.isFolder?"folder":"file"}),e.stopPropagation()},shouldShowContextMenu:function(){return!(this.isRouterFile()||this.state.rename||this.hasPendingOperation())&&(this.state.hasMouseInside||this.isSelected()||this.refs.contextMenu&&this.refs.contextMenu.isExpanded())},hasPendingOperation:function(){return this.props.pendingRename||this.props.loading||this.props.pendingCreation||this.props.pendingDelete},actionSelectedHandler:function(e){switch(this.props.isRoot?this.getEditorAPI().bi.event(p.events.LEFT_TREE_CLICK_ON_PLUS_ITEM,{section_name:this.props.name,menu_entry_name:e}):this.getEditorAPI().bi.event(p.events.LEFT_TREE_CLICK_ON_SETTINGS_ITEM,{item_name:this.props.id,item_type:this.props.isFolder?"folder":"file",menu_entry_name:e}),e){case this.QUICK_ACTIONS.NEW_JS_FILE:return this.showNewJsFile();case this.QUICK_ACTIONS.NEW_JSW_FILE:return this.showNewJswFile();case this.QUICK_ACTIONS.NEW_FILE:return this.showNewChildInput("new-file",null,!1);case this.QUICK_ACTIONS.NEW_FOLDER:return this.showNewChildInput("new-folder",null,!0);case this.QUICK_ACTIONS.DELETE:return this.props.onFileDelete(this.props.id);case this.QUICK_ACTIONS.RENAME:return this.showRenameInput(this.props.name,this.props.isFolder);case this.QUICK_ACTIONS.OPEN_WEBMODULE_PERMISSIONS:return this.props.onOpenWebmodulePermissions(this.props.name)}},onQuickAddItemClick:function(){this.getEditorAPI().bi.event(p.events.LEFT_TREE_CLICK_ON_ADD_QUICK_LINK,{section_name:this.props.name}),this.props.isBackend?this.showNewJswFile():this.showNewJsFile()},showNewJsFile:function(){return this.showNewChildInput("new-file","js",!1)},showNewJswFile:function(){return this.showNewChildInput("aModule","jsw",!1)},showNewChildInput:function(e,i,o){function r(e){return e+(i?"."+i:"")}var s=this;return this.props.expand(this.props.id).then(function(){for(var i=t.map(s.props.childItems,"name"),a=e,l=1;t.includes(i,r(a));l++)a=e+"-"+l;return new n(function(e){s.setState({newChild:{initialName:r(a),initialSelectionLength:a.length,isFolder:o}},e)})})},getTreeClass:function(){return I},onNodeClick:function(){this.hasPendingOperation()||(this.props.isFolder?(this.props.isRoot?this.getEditorAPI().bi.event(p.events.LEFT_TREE_CLICK_ON_SECTION,{section_name:this.props.name,action:this.state.collapsed?"open":"close"}):this.getEditorAPI().bi.event(p.events.LEFT_TREE_CLICK_ON_ITEM,{item_name:this.props.id,item_type:"folder"}),this.props.expanded?this.props.collapse(this.props.id):this.props.expand(this.props.id)):this.props.onFileSelected(this.props.id))},isSelectable:function(){return!this.props.isFolder},isSelected:function(){return this.props.devModeContext.type===i.constants.DEVELOPER_MODE.CONTEXT_TYPES.FILE&&this.props.devModeContext.data.id===this.props.id},onNewChildHide:function(){this.setState({newChild:null})},onNewChildApply:function(e){var n=this.getEditorAPI(),i=this.state.newChild.isFolder;return this.setState({newChild:null}),i?this.props.createFolder(this.props.id,e).then(function(e){n.bi.event(p.events.LEFT_TREE_ITEM_CREATED,{section_name:this.props.isBackend?"backend":"public",path:e,type:"folder"})}.bind(this)).catch(t.partial(u,n)):this.props.createFile(this.props.id,e,this.getInitialFileContent(e)).then(function(e){n.bi.event(p.events.LEFT_TREE_ITEM_CREATED,{section_name:this.props.isBackend?"backend":"public",path:e,type:h(e)}),this.props.onFileSelected(e)}.bind(this)).catch(t.partial(u,n))},isReservedChildName:function(e){return this.props.isReservedFileSystemItem(this.props.id,e)},getInitialFileContent:function(e){return E(e)?t.template(c.DEFAULT_WEB_MODULE_CONTENT)({moduleName:m(e)}):""},isDuplicateChildName:function(e){return t.some(this.props.childItems,{name:e})},getFileSymbolName:function(e){return E(e)?"file-jsw":t.endsWith(e,".js")?"file-js":"file"},validateLegalFileName:function(e){return e=e.trim(),_.test(e)},validateNotDuplicateChildName:function(e){return(e=e.trim())===this.state.newChild.initialName||!this.isDuplicateChildName(e)},validateNotReservedChildName:function(e){return e=e.trim(),!this.isReservedChildName(e)},validateNotDuplicateInParent:function(e){return(e=e.trim())===this.props.name||!this.props.isDuplicateChildNameInParent(e)},validateNotReservedInParent:function(e){return e=e.trim(),!this.props.isReservedChildNameInParent(e)},render:l}),I=g.connect(C,{renameFile:r.renameFile,createFile:r.createFile,createFolder:r.createFolder,expand:r.expand,collapse:r.collapse},null,{withRef:!0})(T);return I.defaultProps={isReservedChildNameInParent:t.constant(!1),isDuplicateChildNameInParent:t.constant(!1),isReservedFileSystemItem:t.constant(!1)},I}),define("wixCode/core/components/collectionsTree/collectionsTree.rt",["react","lodash","util","symbols","baseUI","experiment","wixCode/core/components/nameInput/nameInput","wixCode/core/components/contextMenuItem/contextMenuItem"],function(e,t,n,i,o,r,s,a){return function(){function n(t,n,i,o){return e.createElement("li",{key:"child-"+i.name},e.createElement(t,{store:this.props.store,devModeContext:this.props.devModeContext,id:i.id,onCollectionSelected:this.props.onCollectionSelected,onAddDynamicPage:this.props.onAddDynamicPage,onOpenCollectionPermissions:this.props.onOpenCollectionPermissions,onCreateCollection:this.props.onCreateCollection}))}function s(){var s=this.getTreeClass(),l=r.isOpen("dpages");return e.createElement("div",{className:t({"wix-code-file-tree":!0,root:this.props.isRoot}).transform(function(e,t,n){t&&e.push(n)},[]).join(" ")},e.createElement("div",{className:t({"node-content":!0,pending:this.hasPendingOperation(),selectable:this.isSelectable()&&!this.state.rename,selected:this.isSelected()&&!this.state.rename}).transform(function(e,t,n){t&&e.push(n)},[]).join(" "),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.onNodeClick},this.hasPendingOperation()?e.createElement("span",{className:"icon",key:"preloader"},e.createElement(o.preloader,{})):null,this.hasPendingOperation()?null:e.createElement("span",{className:"icon",key:"icon"},this.props.isRoot?null:e.createElement(i.symbol,{key:"icon_collection",name:"collection"}),this.props.isRoot&&!this.props.expanded?e.createElement(i.symbol,{key:"icon_folder_closed",name:"root_folder_closed"}):null,this.props.isRoot&&this.props.expanded?e.createElement(i.symbol,{key:"icon_folder_open",name:"root_folder_open"}):null),this.state.rename?null:e.createElement("span",{className:"label",key:"label"},this.props.pendingRename||this.props.labelOverride||this.props.name),this.shouldShowContextMenu()?e.createElement(o.dropDown.contextMenu,{className:"wix-code-file-tree-dd",key:"contextMenu",ref:"contextMenu",icon:this.props.isRoot?"root_folder_menu":"file_menu",onClick:this.onContextMenuClick,onChange:this.actionSelectedHandler},this.props.isRoot?e.createElement(o.dropDown.option,{value:this.QUICK_ACTIONS.NEW_COLLECTION,key:"action-new"},e.createElement(a,{symbolName:"collection",label:this.translateIfNeeded("WixCode_TreeView_Data_NewCollection")})):null,l&&!this.props.isRoot?e.createElement(o.dropDown.option,{value:this.QUICK_ACTIONS.ADD_DYNAMIC_PAGE,key:"dpage-item"},e.createElement(a,{symbolName:"page_dynamic_icon",label:this.translateIfNeeded("WixCode_TreeView_FileTree_QuickActions_Add_Dynamic_Page")})):null,l&&!this.props.isRoot?e.createElement(o.dropDown.option,{value:this.QUICK_ACTIONS.OPEN_COLLECTION_PERMISSIONS,key:"cpermissions-item"},e.createElement(a,{symbolName:"file",label:this.translateIfNeeded("WixCode_TreeView_FileTree_QuickActions_UpdatePermissions")})):null):null),this.props.expanded?e.createElement.apply(this,["ul",{className:"subtree",key:"subtree"},!this.props.isRoot||this.state.newChild||this.props.childItems.length?null:e.createElement("li",{className:"empty-dir-message",key:"empty-dir-message"},e.createElement(o.button,{label:"WixCode_TreeView_AddCollectionToDirectory",className:"btn-text link",onClick:this.onQuickAddItemClick})),t.map(this.props.childItems,n.bind(this,s,l))]):null)}return s.apply(this,[])}}),define("wixCode/core/components/collectionsTree/collectionsTree",["react","lodash","bluebird","core","util","reduxLibs","experiment","wixCode/utils/utils","wixCode/code/actions/fileSystemActions","wixCode/code/reducers/codeStateReader","wixCode/core/components/propTypes","wixCode/bi/bi","wixCode/core/components/collectionsTree/collectionsTree.rt"],function(e,t,n,i,o,r,s,a,l,c,d,p,u){function m(e,n,i){var o=i.map(function(t){var n=c.getFileSystemEntry(e,t);return{id:n.get("id"),name:a.getCollectionNameFromSchemaFileName(n.get("descriptor").get("name")),pendingCreation:n.get("pendingCreation"),isFolder:n.get("descriptor").get("directory")}}).toArray();return t(o).reject({name:void 0}).orderBy(["pendingCreation","isFolder","name"],["desc","desc","asc"]).value()}function E(e,t){var n=c.getFileSystemEntry(e,t.id),i=n.get("descriptor").get("directory"),o=n.get("descriptor").get("name");return{name:i?o:a.getCollectionNameFromSchemaFileName(o),pendingCreation:n.get("pendingCreation"),isFolder:i,childItems:m(e,t,n.get("childIds")),expanded:n.get("expanded"),loading:n.get("loading")}}var h=r.reactRedux,f=e.createClass({displayName:"CollectionsTree",mixins:[o.translationMixin,i.mixins.editorAPIMixin],propTypes:{store:e.PropTypes.object.isRequired,devModeContext:d.context.isRequired,id:e.PropTypes.string.isRequired,isRoot:e.PropTypes.bool,labelOverride:e.PropTypes.string,onCollectionSelected:e.PropTypes.func.isRequired,onAddDynamicPage:e.PropTypes.func.isRequired,onOpenCollectionPermissions:e.PropTypes.func.isRequired,onCreateCollection:e.PropTypes.func.isRequired,name:e.PropTypes.string.isRequired,isFolder:e.PropTypes.bool.isRequired,childItems:e.PropTypes.array.isRequired,loading:e.PropTypes.bool.isRequired,expanded:e.PropTypes.bool.isRequired},getInitialState:function(){return{hasMouseInside:!1,newChild:null}},QUICK_ACTIONS:{NEW_COLLECTION:"NEW_COLLECTION",ADD_DYNAMIC_PAGE:"ADD_DYNAMIC_PAGE",OPEN_COLLECTION_PERMISSIONS:"OPEN_COLLECTION_PERMISSIONS"},onMouseEnter:function(){this.setState({hasMouseInside:!0})},onMouseLeave:function(){this.setState({hasMouseInside:!1})},onContextMenuClick:function(e){this.props.isRoot?this.getEditorAPI().bi.event(p.events.LEFT_TREE_CLICK_ON_PLUS,{section_name:"database"}):this.props.isFolder||this.getEditorAPI().bi.event(p.events.LEFT_TREE_CLICK_ON_SETTINGS,{item_name:this.props.name,item_type:"collection"}),e.stopPropagation()},shouldShowContextMenu:function(){return!this.hasPendingOperation()&&(!(!this.props.isRoot&&!s.isOpen("dpages"))&&(this.state.hasMouseInside||this.isSelected()||this.refs.contextMenu&&this.refs.contextMenu.isExpanded()))},hasPendingOperation:function(){return this.props.loading||this.props.pendingCreation},actionSelectedHandler:function(e){switch(this.props.isRoot?this.getEditorAPI().bi.event(p.events.LEFT_TREE_CLICK_ON_PLUS_ITEM,{section_name:"database",menu_entry_name:e}):this.getEditorAPI().bi.event(p.events.LEFT_TREE_CLICK_ON_SETTINGS_ITEM,{item_name:this.props.name,item_type:"collection",menu_entry_name:e}),e){case this.QUICK_ACTIONS.NEW_COLLECTION:return this.props.onCreateCollection();case this.QUICK_ACTIONS.ADD_DYNAMIC_PAGE:return this.props.onAddDynamicPage(this.props.name);case this.QUICK_ACTIONS.OPEN_COLLECTION_PERMISSIONS:return this.props.onOpenCollectionPermissions(this.props.name)}},onQuickAddItemClick:function(){this.getEditorAPI().bi.event(p.events.LEFT_TREE_CLICK_ON_ADD_QUICK_LINK,{section_name:"database"}),this.props.onCreateCollection()},getTreeClass:function(){return C},onNodeClick:function(){this.hasPendingOperation()||(this.props.isFolder?(this.props.isRoot&&this.getEditorAPI().bi.event(p.events.LEFT_TREE_CLICK_ON_SECTION,{section_name:"database",action:this.props.expanded?"close":"open"}),this.props.expanded?this.props.collapse(this.props.id):this.props.expand(this.props.id)):this.props.onCollectionSelected(this.props.id))},isSelectable:function(){return!this.props.isFolder},isSelected:function(){return this.props.devModeContext.type===i.constants.DEVELOPER_MODE.CONTEXT_TYPES.COLLECTION&&this.props.devModeContext.data.id===this.props.id},render:u}),C=h.connect(E,{expand:l.expand,collapse:l.collapse},null,{withRef:!0})(f);return C}),define("wixCode/core/components/ideTree/ideTree.rt",["react","lodash","util","experiment","baseUI","wixCode/core/components/pagesTree/pagesTree","wixCode/core/components/fileTree/fileTree","wixCode/core/components/collectionsTree/collectionsTree"],function(e,t,n,i,o,r,s,a){return function(){return e.createElement("div",{className:"wix-code-ide-tree"},e.createElement("div",{className:"title"},n.translate("WixCode_TreeView_Title")),e.createElement(r,{devModeContext:this.props.context,dataSource:this.getPageTreeDataSource(),onPageSelected:this.onPageSelected}),this.shouldDisplayPopupsTree()?e.createElement(r,{key:"wixCodePopupsTree",devModeContext:this.props.context,dataSource:this.getPopupsDataSource(),onPageSelected:this.onPopupSelected}):null,e.createElement(s,{store:this.store,devModeContext:this.props.context,id:this.getPublicRootId(),isRoot:!0,labelOverride:this.translateIfNeeded("WixCode_TreeView_Public_Section"),onFileSelected:this.onFileSelected,onFileDelete:this.onFileDelete,isReservedFileSystemItem:this.isReservedFileSystemItem}),e.createElement(s,{store:this.store,devModeContext:this.props.context,id:this.getBackendRootId(),isRoot:!0,labelOverride:this.translateIfNeeded("WixCode_TreeView_Backend_Section"),isBackend:!0,onFileSelected:this.onFileSelected,onFileDelete:this.onFileDelete,onOpenWebmodulePermissions:this.onOpenWebmodulePermissions,isReservedFileSystemItem:this.isReservedFileSystemItem}),i.isOpen("se_platform1")?e.createElement(a,{key:"collections",store:this.store,devModeContext:this.props.context,id:this.getSchemasRootId(),isRoot:!0,labelOverride:this.translateIfNeeded("WixCode_TreeView_Data_Label"),onCollectionSelected:this.onCollectionSelected,onAddDynamicPage:this.onSchemaAddDynamicPage,onOpenCollectionPermissions:this.onOpenCollectionPermissions,onCreateCollection:this.onCreateCollection}):null)}}),define("wixCode/core/components/ideTree/ideTree",["react","lodash","core","util","constants","platform","wixCode/core/consts","wixCode/utils/utils","wixCode/core/store/storeManager","wixCode/code/reducers/codeStateReader","wixCode/code/actions/fileSystemActions","wixCode/core/actions/ideActions","wixCode/core/components/propTypes","wixCode/bi/bi","wixCode/core/components/ideTree/ideTree.rt","experiment"],function(e,t,n,i,o,r,s,a,l,c,d,p,u,m,E,h){return e.createClass({displayName:"IdeTree",mixins:[n.mixins.editorAPIMixin,i.translationMixin],propTypes:{context:u.context.isRequired},componentWillMount:function(){var e=this.getEditorAPI();this.store=l.getStore(),this.dataBindingAppData=e.documentServices.platform.getAppDataByAppDefId(e.documentServices.platform.editorApps.DATA_BINDING.appDefId),this.dynamicPagesAppData=e.documentServices.platform.getAppDataByAppDefId(e.documentServices.platform.editorApps.DYNAMIC_PAGES.appDefId)},getPublicRootId:function(){return this.getEditorAPI().wixCode.fileSystem.getRoots().public.location},getBackendRootId:function(){return this.getEditorAPI().wixCode.fileSystem.getRoots().backend.location},getSchemasRootId:function(){return this.getEditorAPI().wixCode.fileSystem.getRoots().schemas.location},getPageTreeDataSource:function(){var e=this.getEditorAPI(),t={id:"__PAGES__",isRoot:!0,label:"Pages",type:"page"};if(t.items=e.mainMenu.getMenuItemsTreeForPagesFixed(),h.isOpen("dpages")){var n=e.pages.dynamicPages.getMenuItems();t.items=t.items.concat(n)}return t},onPageSelected:function(e,t){var n=this.getEditorAPI();n.bi.event(m.events.LEFT_TREE_CLICK_ON_ITEM,{item_name:e.id,item_type:t.isDynamicPage?"dynamic_page":"page"}),n.panelManager.closeAllPanelsOfType(o.PANEL_TYPES.FULL_STAGE),n.pages.navigateTo(e.id)},getPopupsDataSource:function(){function e(e){return{id:e.id,label:e.title,pageData:e,type:{isPage:!1,isLink:!1,isPopup:!0}}}var t=this.getEditorAPI(),n={id:"__POPUPS__",isRoot:!0,label:this.translateIfNeeded("WixCode_TreeView_Lightbox_Section")};return n.items=t.pages.popupPages.getDataList().map(e),n},onPopupSelected:function(e){var t=this.getEditorAPI();t.bi.event(m.events.LEFT_TREE_CLICK_ON_ITEM,{item_name:e.id,item_type:"light_box"}),t.panelManager.closeAllPanelsOfType(o.PANEL_TYPES.FULL_STAGE),t.pages.navigateTo(e.id)},shouldDisplayPopupsTree:function(){return this.getEditorAPI().documentServices.pages.popupPages.getDataList().length},isPagesRoot:function(e,t){return e===this.getPublicRootId()&&t===s.PAGES_ROOT},isAuthorizationConfig:function(e,t){return e===this.getBackendRootId()&&t===s.AUTHORIZATION_CONFIG_FILE_NAME},isReservedFileSystemItem:function(e,t){return this.isPagesRoot(e,t)||this.isAuthorizationConfig(e,t)},onFileSelected:function(e){var i=this.getEditorAPI();i.bi.event(m.events.LEFT_TREE_CLICK_ON_ITEM,{item_name:e,item_type:"file"});var o=c.getFileSystemEntry(this.store.getState(),e).get("descriptor").toJS();i.panelManager.closeAllPanels();var r=i.developerMode.createContext(n.constants.DEVELOPER_MODE.CONTEXT_TYPES.FILE,t.assign({id:e},o));i.developerMode.setContext(r)},onCollectionSelected:function(e){var i=this.getEditorAPI(),o=c.getFileSystemEntry(this.store.getState(),e).get("descriptor").toJS(),r=a.getCollectionNameFromSchemaFileName(o.name);i.bi.event(m.events.LEFT_TREE_CLICK_ON_ITEM,{item_name:r,item_type:"collection"}),i.bi.event(m.events.LEFT_TREE_CLICK_ON_COLLECTION,{origin:"ideTree",collection_name:r}),i.panelManager.closeAllPanels(),i.wixCode.fileSystem.flush();var s=i.developerMode.createContext(n.constants.DEVELOPER_MODE.CONTEXT_TYPES.COLLECTION,t.assign({id:e},o));i.developerMode.setContext(s),i.documentServices.platform.notifyApplication(this.dataBindingAppData.applicationId,{eventType:"treeItemSelected",eventPayload:{itemName:r,instance:i.wixCode.getClientSpec().instance,origin:"ideTree"}})},onSchemaAddDynamicPage:function(e){var t=this.getEditorAPI();h.isOpen("dpages")&&(t.documentServices.platform.notifyApplication(this.dataBindingAppData.applicationId,{eventType:"addDynamicPageClicked",eventPayload:{collectionName:e,origin:"ideTree"}}),this.getEditorAPI().panelManager.closeAllPanels())},onOpenCollectionPermissions:function(e){var t=this.getEditorAPI();t.bi.event(m.events.LEFT_TREE_CLICK_ON_PERMISSIONS,{origin:"ideTree",collection_name:e}),t.documentServices.platform.notifyApplication(this.dataBindingAppData.applicationId,{eventType:"openCollectionPermissionsClicked",eventPayload:{collectionName:e,origin:"ideTree"}})},onOpenWebmodulePermissions:function(e){this.getEditorAPI().documentServices.platform.notifyApplication(this.dynamicPagesAppData.applicationId,{eventType:"openWebmodulePermissionsClicked",eventPayload:{fileName:e,origin:"ideTree"}})},onCreateCollection:function(){var e=this.getEditorAPI(),t=r.constants.EVENTS.createCollectionButtonClicked;e.documentServices.platform.notifyApplication(this.dataBindingAppData.applicationId,{eventType:t,eventPayload:{origin:"ideTree"}})},onFileDelete:function(e){var i=this.getEditorAPI(),o=c.getFileSystemEntry(this.store.getState(),e).get("descriptor").toJS();i.panelManager.openPanel("wixCode.panels.deleteFileSystemItemWarningPanel",{fileName:o.name,isFolder:o.directory,onConfirm:t.partial(this.onFileDeleteConfirm,e,n.constants.DEVELOPER_MODE.CONTEXT_TYPES.FILE)})},onFileDeleteConfirm:function(e,n){var i=this.getEditorAPI(),o=t.partial(this.onFileDeleteSuccess,e,n);return this.store.dispatch(d.delete(e)).then(o).catch(function(){i.panelManager.openPanel("wixCode.panels.fileSystemOperationErrorPanel")})},onFileDeleteSuccess:function(e,t){var i=this.getEditorAPI();this.props.context.type===t&&this.props.context.data.id===e&&i.developerMode.setContext(i.developerMode.createContext(n.constants.DEVELOPER_MODE.CONTEXT_TYPES.PAGE))},render:E})}),define("wixCode/core/components/developerToolBar/eventsBinding/eventControl/eventControl.rt",["react","lodash","symbols","baseUI"],function(e,t,n,i){return function(){return e.createElement("div",{className:"component-event "+("none"===this.props.handlerInputState?"add-event-symbol":"add-event-label")},e.createElement("span",{className:"label label-switch event-label",key:"eventLabel",type:this.props.eventType},this.props.eventLabel),e.createElement("div",{className:"event-handler-wrapper"},"none"===this.props.handlerInputState?e.createElement("div",{className:"add-event-wrapper",key:"showAdd"},e.createElement(i.tooltip,{value:this.props.eventDescription,styleType:"small",alignment:i.uiConstants.TOOLTIP.ALIGNMENT.BOTTOM,ref:"eventDescriptionTooltip",shouldTranslate:!1},e.createElement("span",{},e.createElement(i.symbol,{name:"infoIcon",className:"infoIcon",ref:"eventDescriptionIcon"}))),this.props.isReadOnly?null:e.createElement(n.symbol,{onClick:this.props.onAddEventHandlerClicked,ref:"eventPlusIcon",key:"eventPlusIcon",name:"leftBarAddPanel",className:"plusIcon"})):null,"editing"===this.props.handlerInputState?e.createElement(i.textInput,{key:"showInput",ref:"eventNameInput",shouldTranslate:!1,focus:!0,onBlur:this.props.onHandlerNameChanged,value:this.props.handlerName,validator:this.props.isHandlerNameValid,invalidMessage:this.props.getNameInvalidMessage,blurOnEnterKey:!1,onKeyDown:this.onKeyDown}):null,e.createElement(i.tooltip,this.getTooltipProps(),e.createElement("span",{},"exist"===this.props.handlerInputState?e.createElement("label",{onClick:this.props.onHandlerNameClicked,className:"handler-name",ref:"eventLabel",key:"showLabel"},this.props.handlerName):null))),this.props.isReadOnly||"exist"!==this.props.handlerInputState?null:e.createElement(n.symbol,{key:"deleteBtn",name:"delete",className:"delete-handler",ref:"deleteIcon",onClick:this.props.onRemoveHandlerClicked}))}}),define("wixCode/core/components/developerToolBar/eventsBinding/eventControl/eventControl",["react","lodash","baseUI","wixCode/core/components/developerToolBar/eventsBinding/eventControl/eventControl.rt"],function(e,t,n,i){return e.createClass({displayName:"eventControl",propTypes:{eventLabel:e.PropTypes.string.isRequired,eventType:e.PropTypes.string.isRequired,eventDescription:e.PropTypes.string.isRequired,handlerInputState:e.PropTypes.oneOf(["none","editing","exist"]).isRequired,handlerName:e.PropTypes.string,onHandlerNameClicked:e.PropTypes.func.isRequired,onAddEventHandlerClicked:e.PropTypes.func.isRequired,onHandlerNameChanged:e.PropTypes.func.isRequired,onRemoveHandlerClicked:e.PropTypes.func.isRequired,isHandlerNameValid:e.PropTypes.func.isRequired,getNameInvalidMessage:e.PropTypes.func.isRequired,isReadOnly:e.PropTypes.bool,isErrorTooltipActive:e.PropTypes.bool,onErrorTooltipClosed:e.PropTypes.func},onKeyDown:function(e){"Enter"===e.key&&this.props.isHandlerNameValid(e.target.value)&&this.props.onHandlerNameChanged(e)},getTooltipProps:function(){var e={styleType:"small",closeTriggers:[n.uiConstants.TOOLTIP.TRIGGERS.MOUSE_LEAVE]};return this.props.isErrorTooltipActive?t.assign(e,{value:"WixCode_prop_panel_navigate_to_handler_function_error",shouldTranslate:!0,delay:"0",onClose:this.props.onErrorTooltipClosed,openTriggers:[n.uiConstants.TOOLTIP.TRIGGERS.IMMEDIATE],alignment:n.uiConstants.TOOLTIP.ALIGNMENT.TOP}):t.assign(e,{value:this.props.handlerName,shouldTranslate:!1,delay:"600",openTriggers:[n.uiConstants.TOOLTIP.TRIGGERS.MOUSE_ENTER],alignment:n.uiConstants.TOOLTIP.ALIGNMENT.BOTTOM})},render:i})}),define("wixCode/core/components/developerToolBar/eventsBinding/eventsBinding.rt",["react","lodash","wixCode/core/components/developerToolBar/eventsBinding/eventControl/eventControl","baseUI","util"],function(e,t,n,i,o){return function(){function i(i,o){return e.createElement(n,t.assign({},{key:o,ref:"eventControl"+o},this.getEventProps(i)))}return e.createElement("div",{className:"events-binding"},e.createElement.apply(this,["span",{className:"inner form layout-title",key:"eventsTab"},e.createElement("span",{className:"events-title"},o.translate("WixCode_PropertiesPanel_EventsTab_Title")),t.map(this.props.eventList,i.bind(this))]))}}),define("wixCode/core/components/developerToolBar/eventsBinding/eventsBinding",["react","lodash","core","util","platform","wixCode/bi/bi","wixCode/utils/utils","wixCode/core/components/developerToolBar/eventsBinding/eventsBinding.rt"],function(e,t,n,i,o,r,s,a){function l(e,t,n,i,o){e.bi.event(n,{site_id:e.documentServices.generalInfo.getSiteId(),element_type:s.getCompTypeOrControllerType(e,t),event:i,handler_name:o})}function c(e,t){var n=e.components.getType(t)===o.constants.CONTROLLER_COMPONENT_TYPE?"runAppCode":"runCode";return e.behaviors.getDefinition(n)}function d(e,t,n){var i=c(e,t);return i.params={callbackId:n,compId:t.id},i}function p(e,n,i){if(!n)return null;var o=e.behaviors.get(n),r=c(e,n),s={action:{name:i},behavior:{name:r.name,type:r.type,targetId:u(e,n).id}};return t.find(o,s)}function u(e,t){return e.wixCode.getWidgetRef(t)}function m(e,t,n,i,o){var r=e.components.code.getNickname(t),s=e.components.getType(t),a=e.documentServices.pages.getFocusedPageId(),l=e.components.isShowOnAllPages(t);e.wixCode.events.getDefaultEventHandlerName(a,l,i,s,r).then(function(i){var r=u(e,t),s=d(e,t,i),a={type:"comp",name:n};e.behaviors.update(t,a,r,s),o(i)})}function E(e){return t.get(e,"behavior.params.callbackId")}function h(e,t,n){return n===t?"editing":e?"exist":"none"}function f(e,t,n){var i=this.getEditorAPI();i.developerMode.ui.idePane.unMinimize(),m(i,e,t,n,function(o){this.setState({currentlyEdited:t,handlerDefaultName:o}),i.bi.event(r.events.PROPERTIES_PANEL_EVENT_HANDLER_ADD_PRESSED,{site_id:i.documentServices.generalInfo.getSiteId(),element_type:s.getCompTypeOrControllerType(i,e),event:n,default_handler_name:o})}.bind(this))}function C(e,t,n){var i=this.getEditorAPI(),o=i.documentServices.pages.getFocusedPageId(),s=i.components.isShowOnAllPages(e),a=E(p(i,e,t));i.wixCode.ui.setFocusOnEventHandler(o,s,a).then(null,g.bind(this,t)),l(i,e,r.events.PROPERTIES_PANEL_EVENT_HANDLER_NAVIGATION,n,a)}function g(e){this.setState({navigationErrorForEventType:e})}function _(e,n,i){var o=this.getEditorAPI(),s=this.props.editedComponent,a=i.target.value,c=p(o,s,e),d=u(o,s),m=o.documentServices.pages.getFocusedPageId(),h=o.components.isShowOnAllPages(s);if(o.wixCode.events.validateEventHandlerName(a)!==o.wixCode.events.EVENT_HANDLER_NAME_VALIDATIONS.VALID&&""!==a&&(a=this.state.handlerDefaultName),t.set(c,"behavior.params.callbackId",a),o.behaviors.update(s,c.action,d,c.behavior),t.isEmpty(a))return o.behaviors.remove(s,c.action,d,c.behavior),void this.setState({currentlyEdited:null,handlerDefaultName:null});o.wixCode.events.generateEventHandlerCode(m,h,a),this.setState({currentlyEdited:null,handlerDefaultName:null}),l(o,s,r.events.PROPERTIES_PANEL_EVENT_HANDLER_ADDED,n,E(c))}function T(e,t){var n=this.getEditorAPI(),i=this.props.editedComponent,o=p(n,i,e),s=u(n,i);o&&(n.behaviors.remove(i,o.action,s,o.behavior),this.setState({currentlyEdited:null,handlerDefaultName:null}),l(n,i,r.events.PROPERTIES_PANEL_EVENT_HANDLER_REMOVED,t,E(o)))}function I(e){var t=this.getEditorAPI(),n=t.wixCode.events.EVENT_HANDLER_NAME_VALIDATIONS;return t.wixCode.events.validateEventHandlerName(e)===n.VALID}function S(e){var t=this.getEditorAPI().wixCode.events.validateEventHandlerName(e);return i.translate(x[t])}function v(){this.setState({navigationErrorForEventType:null})}var x={INVALID_FN_NAME:"WixCode_PropertiesPanel_HandlerName_Validation_InvalidJSFunctionName",TOO_LONG:"WixCode_PropertiesPanel_HandlerName_Validation_TooLong"};return e.createClass({displayName:"eventsBinding",mixins:[n.mixins.editorAPIMixin],propTypes:{editedComponent:e.PropTypes.object.isRequired,eventList:e.PropTypes.arrayOf(e.PropTypes.object).isRequired,isReadOnly:e.PropTypes.bool},getInitialState:function(){return{currentlyEdited:null,handlerDefaultName:null}},componentWillReceiveProps:function(e){t.isEqual(e.editedComponent,this.props.editedComponent)||this.setState({currentlyEdited:null,handlerDefaultName:null})},getEventProps:function(e){var t=this.getEditorAPI(),n=this.props.editedComponent,i=p(t,n,e.type),o=h(!!i,e.type,this.state.currentlyEdited);return{eventLabel:e.name+":",eventType:e.type,eventDescription:e.description,handlerInputState:o,handlerName:E(i),onAddEventHandlerClicked:f.bind(this,n,e.type,e.name),onHandlerNameClicked:C.bind(this,n,e.type,e.name),onHandlerNameChanged:_.bind(this,e.type,e.name),onRemoveHandlerClicked:T.bind(this,e.type,e.name),isHandlerNameValid:I.bind(this),getNameInvalidMessage:S.bind(this),isReadOnly:this.props.isReadOnly,isErrorTooltipActive:e.type===this.state.navigationErrorForEventType,onErrorTooltipClosed:v.bind(this)}},render:a})}),define("wixCode/core/components/developerToolBar/developerToolBar.rt",["react","lodash","baseUI","symbols","util","wixCode/core/components/developerToolBar/eventsBinding/eventsBinding","baseUILib"],function(e,t,n,i,o,r,s){return function(){function a(e,t){this.startDrag(t,this.getDragLimits())}function l(){var l=1===t.get(this.props.editedComponents,"length");return e.createElement("div",{className:t(this.getClasses()).transform(function(e,t,n){t&&e.push(n)},[]).join(" "),onContextMenu:this.props.onContextMenu,ref:"developerToolBarContainer"},e.createElement(s.PanelHeader,{className:"header light",onMouseDown:a.bind(this,l),onClose:this.onClose,onHelp:this.openHelpCenter},e.createElement("span",{className:"layout-title",style:{marginTop:"6px",textAlign:"left",paddingLeft:"12px"}},o.translate("WixCode_PropertiesPanel_PanelTitle"))),e.createElement(s.Divider,{long:!0}),l?null:e.createElement("div",{key:"emptyStatePanel",ref:"emptyStatePanel"},e.createElement("div",{className:"rich-text-paragraph inner form",key:"emptyStateText"},e.createElement("p",{className:"empty-state-text"},o.translate("WixCode_PropertiesPanel_EmptyState_Description"))),e.createElement(i.symbol,{className:"empty-state-symbol",name:"emptyPropertiesPanel"})),l?e.createElement("div",{className:"inner form",key:"controlsContainer"},e.createElement(n.textInput,{label:o.translate("WixCode_PropertiesPanel_ID_Label")+":",shouldTranslate:!1,disabled:this.props.isReadOnly,ref:"nameChangeInput",onFocus:this.onNameFocus,onChange:this.onNameChange,value:this.getComponentName(),validator:this.getNameValidator(),invalidMessage:this.getNameInvalidMessage}),l&&this.isComponentHiddenable()?e.createElement("div",{className:"checkBoxContainer",key:"visibility"},e.createElement(s.Checkbox,{label:"WixCode_PropertiesPanel_Visibility_Label",labelAfterSymbol:!0,value:!this.isComponentVisible(),onChange:this.toggleComponentVisibility,disabled:this.props.isReadOnly,ref:"visibilityChangeInput"})):null,l&&this.isComponentCollapsible()?e.createElement("div",{className:"checkBoxContainer",key:"collapsiblity"},e.createElement(s.Checkbox,{label:"WixCode_PropertiesPanel_Collapse_Label",labelAfterSymbol:!0,value:this.isComponentCollapsed(),onChange:this.toggleComponentCollapsiblity,disabled:this.props.isReadOnly,ref:"collapsiblityChangeInput"})):null,l&&this.isComponentDisableable()?e.createElement("div",{className:"checkBoxContainer",key:"enability"},e.createElement(s.Checkbox,{label:"WixCode_PropertiesPanel_Enabled_Label",labelAfterSymbol:!0,onChange:this.toggleComponentEnability,value:this.isComponentEnabled(),disabled:this.props.isReadOnly,ref:"enabilityChangeInput"})):null):null,this.shouldRenderEventsBindingComp()?e.createElement("div",{key:"events"},e.createElement(s.Divider,{long:!0}),e.createElement(r,t.assign({},{ref:"eventsBinding",isReadOnly:this.props.isReadOnly},this.getEventsBindingProps()))):null,l&&this.shouldShowReadOnlyTooltip()?e.createElement(n.bubble,{key:"readOnlyTooltip",ref:"readOnlyTooltip",width:"222px",value:this.getTooltipValue(),targetNode:this.refs.developerToolBarContainer}):null)}return l.apply(this,[])}}),define("wixCode/core/components/developerToolBar/developerToolBar",["react","lodash","jquery","util","panels","core","baseUI","rEditor","wixCode/bi/bi","wixCode/utils/utils","wixCode/core/components/developerToolBar/developerToolBar.rt"],function(e,t,n,i,o,r,s,a,l,c,d){function p(e,n){var i=t.head(e);return n.components.properties.get(i)}function u(e){return{right:C,top:g+e.getPreviewPosition().top}}function m(e,t,n){return e.validateNickname(t,n)===e.VALIDATIONS.VALID}function E(e,t){var n=c.getSdkTypeOrControllerType(e,t);return e.wixCode.events.getEvents(n)}var h=a.mixins.hiddenableMixin,f=a.mixins.keepInViewportMixin,C=42,g=42,_={ALREADY_EXISTS:"WixCode_PropertiesPanel_ID_Validation_NotUnique",TOO_SHORT:"WixCode_PropertiesPanel_ID_Validation_Empty",TOO_LONG:"WixCode_PropertiesPanel_ID_Validation_TooLong",INVALID_NAME:"WixCode_PropertiesPanel_ID_Validation_InvalidName"};return e.createClass({displayName:"developerToolBar",mixins:[r.mixins.editorAPIMixin,i.draggableMixin,h,f],propTypes:{editedComponents:e.PropTypes.arrayOf(e.PropTypes.object),wixCodeLoaded:e.PropTypes.bool.isRequired,toolsHidden:e.PropTypes.bool,isReadOnly:e.PropTypes.bool},componentWillMount:function(){this.initalPosition=u(this.getEditorAPI())},getInitialState:function(){return{readOnlyTooltipOpen:!1}},componentDidMount:function(){this.openFirstTimeTooltipIfNeeded()},openFirstTimeTooltipIfNeeded:function(){this.state.readOnlyTooltip||this.setState({readOnlyTooltipOpen:!0})},openHelpCenter:function(){var e={origin:r.constants.BI.HELP.ORIGIN.PANEL,panel_name:"wixCode.components.developerToolBar"};this.getEditorAPI().panelManager.openHelpCenter("2ec37118-35d1-4068-a491-7640c1481aa1",null,e)},getComponentPosition:function(e){return this.state.isCustomPosition?this.fitPositionToScreen(e,10,C):this.initalPosition},onDragEnd:function(){this.updateLastCustomXPosition(this.draggable.nodePosition.x)},getClasses:function(){return t.assign({"developer-toolbar":!0,hidden:this.props.hidden},this.getHiddenableClasses())},onNameFocus:function(){var e=this.getEditorAPI();e.bi.event(l.events.PROPERTIES_PANEL_NICKNAME_FOCUSED,{site_id:e.documentServices.generalInfo.getSiteId(),element_type:c.getCompTypeOrControllerType(e,t.head(this.props.editedComponents))})},onNameChange:function(e){var n=t.head(this.props.editedComponents);this.getEditorAPI().components.code.setNickname(n,e)},getComponentName:function(){var e=t.head(this.props.editedComponents);return this.getEditorAPI().components.code.getNickname(e)},getNameValidator:function(){var e=this.getEditorAPI().components.code,n=t.head(this.props.editedComponents);return m.bind(null,e,n)},getNameInvalidMessage:function(e){var n=t.head(this.props.editedComponents),o=this.getEditorAPI().components.code.validateNickname(n,e);return i.translate(_[o])},isComponentVisible:function(){var e=p(this.props.editedComponents,this.getEditorAPI());return!t.get(e,"isHidden")},toggleComponentVisibility:function(){var e=this.getEditorAPI(),n=t.head(this.props.editedComponents),i=p(this.props.editedComponents,e);if(this.isComponentHiddenable()){var o=!t.get(i,"isHidden");e.components.properties.update(n,{isHidden:o}),e.bi.event(l.events.PROPERTIES_PANEL_VISIBILITY_TOGGLE,{site_id:e.documentServices.generalInfo.getSiteId(),element_type:c.getCompTypeOrControllerType(e,n),is_visible:!o})}},isComponentHiddenable:function(){var e=t.head(this.props.editedComponents);return!!e&&this.getEditorAPI().components.is.hiddenable(e)},isComponentCollapsible:function(){var e=t.head(this.props.editedComponents);return!!e&&this.getEditorAPI().components.is.collapsible(e)},isComponentCollapsed:function(){var e=p(this.props.editedComponents,this.getEditorAPI());return Boolean(t.get(e,"isCollapsed"))},toggleComponentCollapsiblity:function(){var e=this.getEditorAPI(),n=t.head(this.props.editedComponents),i=p(this.props.editedComponents,e);if(this.isComponentCollapsible()){var o=!t.get(i,"isCollapsed");e.components.properties.update(n,{isCollapsed:o}),e.bi.event(l.events.PROPERTIES_PANEL_COLLAPSIBLITY_TOGGLE,{site_id:e.documentServices.generalInfo.getSiteId(),element_type:c.getCompTypeOrControllerType(e,n),is_collapsed:o})}},isComponentEnabled:function(){var e=p(this.props.editedComponents,this.getEditorAPI());return!t.get(e,"isDisabled")},toggleComponentEnability:function(){var e=this.getEditorAPI(),n=t.head(this.props.editedComponents),i=p(this.props.editedComponents,e);if(this.isComponentDisableable()){var o=!t.get(i,"isDisabled");e.components.properties.update(n,{isDisabled:o}),e.bi.event(l.events.PROPERTIES_PANEL_ENABILITY_TOGGLE,{site_id:e.documentServices.generalInfo.getSiteId(),element_type:c.getCompTypeOrControllerType(e,n),state:o?"disable":"enable"})}},isComponentDisableable:function(){var e=t.head(this.props.editedComponents);return this.getEditorAPI().components.is.disableable(e)},shouldRenderEventsBindingComp:function(){var e=1===t.get(this.props.editedComponents,"length");if(!this.props.wixCodeLoaded||!e)return!1;var n=this.getEditorAPI(),i=n.components.is.group(this.props.editedComponents),o=0===E(n,t.head(this.props.editedComponents)).length;return!(i||o)},getEventsBindingProps:function(){var e=this.getEditorAPI(),n=t.head(this.props.editedComponents);return{eventList:E(e,n),editedComponent:n}},onClose:function(){this.getEditorAPI().developerToolBar.toggle()},shouldShowReadOnlyTooltip:function(){return this.props.isReadOnly&&this.state.readOnlyTooltipOpen&&!this.getEditorAPI().getUserPreferences().global.get("wixCodePropertiesPanelMobileFirstTimeShowed")},getTooltipValue:function(){return e.createElement(s.popoverTemplates.titleBodyAndLinkTooltip,{title:"WixCode_PropertiesPanel_Mobile_FirstTime_Tooltip_Title",text:"WixCode_PropertiesPanel_Mobile_FirstTime_Tooltip_Text",onClose:this.onCloseTooltip})},onCloseTooltip:function(){this.getEditorAPI().getUserPreferences().global.set("wixCodePropertiesPanelMobileFirstTimeShowed",!0),this.setState({readOnlyTooltipOpen:!1})},render:d})}),define("wixCode/core/components/developerWelcomePanel/developerWelcomePanel.rt",["react","lodash","panels","core"],function(e,t,n,i){return function(){return e.createElement(n.focusPanels.popupTemplate,{ref:"popup",panelName:this.props.panelName,h1text:"WixCode_FirstTimePopup_Title",h2text:"WixCode_FirstTimePopup_SubTitle",symbolName:"welcomePopupDeveloperMode",bodyText:"WixCode_FirstTimePopup_Body",btnText:"WixCode_FirstTimePopup_Button",hideDontShowCheckbox:!0})}}),define("wixCode/core/components/developerWelcomePanel/developerWelcomePanel",["react","core","wixCode/core/components/developerWelcomePanel/developerWelcomePanel.rt"],function(e,t,n){return e.createClass({displayName:"developerWelcomePanel",mixins:[t.mixins.editorAPIMixin],getDefaultProps:function(){return{panelName:"wixCode.panels.developerWelcomePanel"}},propTypes:{panelName:e.PropTypes.string},render:n})}),define("wixCode/core/components/deleteFileSystemItemWarningPanel/deleteFileSystemItemWarningPanel.rt",["react","lodash","panels","util","baseUI"],function(e,t,n,i,o){return function(){return e.createElement(n.frames.messagePanelFrame,{panelName:this.props.panelName,onConfirm:this.props.onConfirm,confirmLabel:this.props.isFolder?"WixCode_Folder_Delete_Confirm":"WixCode_File_Delete_Confirm",cancelLabel:this.props.isFolder?"WixCode_Folder_Delete_Cancel":"WixCode_File_Delete_Cancel",className:"important",panelTitle:i.translate(this.props.isFolder?"WixCode_Folder_Delete_PanelTitle":"WixCode_File_Delete_PanelTitle")},e.createElement("div",{className:"wix-code-delete-file-message"},e.createElement("div",{className:"icon"},e.createElement(o.symbol,{name:"deleteGeneralIcon"})),this.props.isFolder?e.createElement("div",{key:"file-message",className:"message"},this.translateTemplate("WixCode_Folder_Delete_Message",{folderName:this.props.fileName})):null,this.props.isFolder?null:e.createElement("div",{key:"folder-message",className:"message"},this.translateTemplate("WixCode_File_Delete_Message",{fileName:this.props.fileName}))))}}),define("wixCode/core/components/deleteFileSystemItemWarningPanel/deleteFileSystemItemWarningPanel",["react","util","wixCode/core/components/deleteFileSystemItemWarningPanel/deleteFileSystemItemWarningPanel.rt"],function(e,t,n){return e.createClass({displayName:"deleteFileSystemItemWarningPanel",mixins:[t.translationMixin],render:n})}),define("wixCode/core/components/fileSystemOperationErrorPanel/fileSystemOperationErrorPanel.rt",["react","lodash","util","baseUI","panels"],function(e,t,n,i,o){return function(){return e.createElement(o.frames.messagePanelFrame,{panelName:this.props.panelName,panelTitle:n.translate("WixCode_FileSystemOperationError_PanelTitle"),confirmLabel:"WixCode_FileSystemOperationError_Confirm"},e.createElement("div",{className:"wix-code-fs-operation-error"},e.createElement("div",{className:"icon"},e.createElement(i.symbol,{name:"plaster"})),e.createElement("div",{className:"message"},n.translate("WixCode_FileSystemOperationError_Message"))))}}),define("wixCode/core/components/fileSystemOperationErrorPanel/fileSystemOperationErrorPanel",["react","util","wixCode/core/components/fileSystemOperationErrorPanel/fileSystemOperationErrorPanel.rt"],function(e,t,n){return e.createClass({displayName:"fileSystemOperationErrorPanel",mixins:[t.translationMixin],render:n})}),define("wixCode/code/services/uiService",["wixCode/code/services/eventService","wixCode/core/services/ideContainerStateService"],function(e,t){function n(){return t.revertMinimize(),e.setFocusOnEventHandler.apply(e,arguments)}return{setFocusOnEventHandler:n,toggleTree:t.toggleTree}}),define("wixCode/core/reducers/genericReducer",["wixImmutable"],function(e){return function(t,n){return function(i,o){return void 0===i&&(i=e.fromJS(t)),n[o.type]?n[o.type](i,o):i}}}),define("wixCode/core/reducers/ideReducer",["wixImmutable","wixCode/core/reducers/genericReducer"],function(e,t){return t({},{})}),define("wixCode/core/reducers/consoleReducer",["wixCode/core/reducers/genericReducer","wixCode/core/actions/types"],function(e,t){var n=[],i={};return i[t.CONSOLE_ADD_MESSAGE]=function(e,t){return e.push(t.message)},i[t.CONSOLE_CLEAR]=function(e){return e.clear()},e(n,i)}),define("wixCode/code/reducers/fileSystemReducer",["lodash","wixImmutable","wixCode/core/reducers/genericReducer","wixCode/core/actions/types"],function(e,t,n,i){function o(e){return new l({id:e.location,descriptor:t.fromJS(e)})}function r(e,t){return e.set(t.id,t)}var s={},a={},l=t.Record({id:null,descriptor:null,pendingRename:null,pendingDelete:!1,pendingCreation:!1,expanded:!1,loading:!1,loaded:!1,childIds:new t.Set});return a[i.SET_FILE]=function(e,t){return r(e,o(t.file))},a[i.REMOVE_FILE]=function(e,t){return e.delete(t.fileId)},a[i.SET_EXPANDED]=function(e,t){return e.setIn([t.fileId,"expanded"],t.expanded)},a[i.SET_LOADING]=function(e,t){return e.setIn([t.fileId,"loading"],t.loading)},a[i.SET_CHILDREN]=function(n,i){var s=[];return e.forEach(i.children,function(e){var t=o(e);n=r(n,t),s.push(t.id)}),n=n.setIn([i.fileId,"childIds"],new t.Set(s)),n=n.setIn([i.fileId,"loaded"],!0)},a[i.ADD_CHILD]=function(e,t){var n=o(t.child);return t.pendingCreation&&(n=n.set("pendingCreation",!0)),(e=r(e,n)).updateIn([t.fileId,"childIds"],function(e){return e.add(n.get("id"))})},a[i.REMOVE_CHILD]=function(e,t){return e.updateIn([t.fileId,"childIds"],function(e){return e.delete(t.childId)})},a[i.SET_PENDING_RENAME]=function(e,t){return e.setIn([t.fileId,"pendingRename"],t.pendingRename)},a[i.SET_PENDING_DELETE]=function(e,t){return e.setIn([t.fileId,"pendingDelete"],t.pendingDelete)},n(s,a)}),define("wixCode/code/reducers/filesReducer",["wixImmutable","wixCode/core/reducers/genericReducer","wixCode/core/actions/types","wixCode/core/consts"],function(e,t,n,i){var o={};return o[n.CHANGE_CONTENT]=function(e,t){return e.setIn([t.fileId,"content"],t.content).setIn([t.fileId,"state"],i.FILE_STATES.IDLE)},o[n.LOAD_FILE_BEGIN]=function(t,n){var o=e.fromJS({descriptor:null,content:"",state:i.FILE_STATES.IDLE});return t.update(n.fileId,o,function(e){return e.set("state",i.FILE_STATES.LOADING)})},o[n.LOAD_FILE_END]=function(t,n){return t.getIn([n.fileId,"state"])===i.FILE_STATES.IDLE?t:t.set(n.fileId,e.fromJS({content:n.content,descriptor:n.descriptor,state:i.FILE_STATES.IDLE}))},o[n.LOAD_FILE_FAILURE]=function(e,t){return e.getIn([t.fileId,"state"])===i.FILE_STATES.IDLE?e:e.setIn([t.fileId,"state"],i.FILE_STATES.LOAD_FAILED)},o[n.LOAD_FILE_CHECK_STATE]=function(e,t){return e.getIn([t.fileId,"state"])===i.FILE_STATES.LOADING?e.setIn([t.fileId,"state"],i.FILE_STATES.LOAD_TAKING_LONGER_THAN_USUAL):e},o[n.REMOVE_FILE]=function(e,t){return e.delete(t.fileId)},t({},o)}),define("wixCode/code/reducers/pageEditorReducer",["wixCode/core/reducers/genericReducer","wixCode/core/actions/types","wixCode/core/consts"],function(e,t,n){var i={};return i[t.PAGE_EDITOR_SET_CURRENT_TAB]=function(e,t){return e.set("currentTab",t.currentTab)},e({currentTab:n.PAGE_TABS.PAGE},i)}),define("wixCode/code/reducers/filesSelectionReducer",["wixCode/core/reducers/genericReducer","wixCode/core/actions/types"],function(e,t){var n={};return n[t.SET_SELECTION]=function(e,t){return e.set(t.fileId,t.selection)},e({},n)}),define("wixCode/code/reducers/findReplaceReducer",["wixCode/core/reducers/genericReducer","wixCode/core/actions/types"],function(e,t){var n={};return n[t.FIND_REPLACE_TOGGLE_VISIBLE]=function(e,t){return e.set("visible",t.visible)},n[t.FIND_REPLACE_SET_FIND_STRING]=function(e,t){return e.set("findString",t.findString)},n[t.FIND_REPLACE_SET_REPLACE_STRING]=function(e,t){return e.set("replaceString",t.replaceString)},n[t.FIND_REPLACE_TOGGLE_REGEX]=function(e,t){return e.set("regex",t.enabled)},n[t.FIND_REPLACE_TOGGLE_CASE_SENSITIVE]=function(e,t){return e.set("caseSensitive",t.enabled)},n[t.FIND_REPLACE_TOGGLE_WHOLE_WORD]=function(e,t){return e.set("wholeWord",t.enabled)},e({visible:!1,regex:!1,caseSensitive:!1,wholeWord:!1},n)}),define("wixCode/core/reducers/rootReducer",["redux-immutablejs","wixCode/core/reducers/ideReducer","wixCode/core/reducers/consoleReducer","wixCode/code/reducers/fileSystemReducer","wixCode/code/reducers/filesReducer","wixCode/code/reducers/pageEditorReducer","wixCode/code/reducers/filesSelectionReducer","wixCode/code/reducers/findReplaceReducer"],function(e,t,n,i,o,r,s,a){return e.combineReducers({ide:t,console:n,fileSystemStructure:i,files:o,filesSelection:s,pageEditor:r,findReplace:a})}),define("wixCode/core/services/reactBootstrapper",["lodash","util","wixCode/core/store/storeManager","wixCode/core/reducers/rootReducer"],function(e,t,n,i){function o(o){var r=t.url.parseUrlParams(window.location),s="all"===r.debug||e.includes(r.debug,"wixCode");return n.initialize(i,s,o)}return{initialize:o}}),define("wixCode/core/services/fileSystemApiCreator",["lodash","bluebird","wixCode/code/actions/fileActions","wixCode/code/actions/fileSystemActions","wixCode/code/reducers/codeStateReader"],function(e,t,n,i,o){function r(e){return e.replace(/\/[^\/]+$/,"/")}return function(e){function s(s,a){var l=r(s.location);return o.getFileSystemEntry(e.getState(),l)?(o.getFileSystemEntry(e.getState(),s.location)?e.dispatch(n.changeContent(s.location,a)):e.dispatch(i.createFile(l,s.name,a))).then(function(){return o.getFileSystemEntry(e.getState(),s.location).descriptor.toJS()}):t.reject("Cannot write a file in a non-existing folder")}return{writeFile:s}}}),define("wixCode/core/services/consoleApiCreator",["core","wixCode/core/actions/consoleActions","wixCode/core/services/consoleContainerStateService","wixCode/core/components/console/constants"],function(e,t,n,i){return function(o,r){function s(e){var t;try{t=JSON.parse(e.data)}catch(e){return}t.intent===i.WIX_CODE_MESSAGE_INTENT&&t.type===i.WIX_CODE_MESSAGE_TYPE&&a(t.data)}function a(e){d(e,r.developerMode.ui.consolePane.getState()),o.dispatch(t.addMessage(e))}function l(e){return e.logLevel===i.LOG_LEVEL.INFO}function c(t){return t===e.constants.DEVELOPER_MODE.CONTAINER_STATES.MINIMIZED}function d(e,t){l(e)||!c(t)||n.minimizedByUser()||n.revertMinimize()}function p(){window.addEventListener("message",s,!1)}function u(){o.dispatch(t.clear())}return{handleOnMessage:s,registerToMessages:p,clear:u}}}),define("wixCode/core/services/mediaManagementServiceCreator",["bluebird","lodash","util","wixCode/bi/bi"],function(e,t,n,i){function o(e,t,i,o){return n.imageTransform.getFromImageData(e,t,i,o||n.imageTransform.getImageScale(e,t,i),n.imageTransform.alignTypes.CENTER).uri}function r(e){function n(e,t){if(t.length!==e)throw s}function i(e){return t(e).split("_").map(t.parseInt).tap(t.partial(n,2)).value()}function o(e){var t=i(e[2]);return{uri:e[1],width:t[0],height:t[1],title:e[3]}}function r(e){if(d!==e[0])throw new Error("Invalid version:"+e[0]+"provided.")}var s=new Error("Invalid wix code URI provided: "+e);if(!e)throw s;return t(e.substr(c.length,e.length)).split("/").tap(r).tap(t.partial(n,4)).thru(o).value()}function s(e){return t.startsWith(e,c)}function a(e){return p(e)}function l(t){var n=t.mediaServices.mediaManager,o=n.categories.IMAGE;return t.bi.event(i.events.IDE_OPEN_MEDIA_MANAGER,{}),new e(function(e){n.open(o,{callback:e,multiSelect:!1})}).then(function(e){if(e&&e.length)return t.bi.event(i.events.IDE_IMAGE_ADDED,{}),a(e[0])})}var c="image://",d="v1",p=t.template(c+d+"/${uri}/${width}_${height}/${title}");return function(e){return{openMediaManager:t.partial(l,e),getUrlFromImageData:o,extractImageDataFromWixCodeUri:r,isWixUri:s}}}),define("wixCode/code/services/fileTreeHandlerService",["lodash","santaIde","bluebird","core","wixCode/core/errors","wixCode/core/consts","wixCode/code/actions/fileSystemActions","wixCode/code/actions/fileActions","wixCode/code/reducers/codeStateReader","wixCode/core/store/storeManager"],function(e,t,n,i,o,r,s,a,l,c){function d(e){return c.getStore().dispatch(s.expand(e))}function p(e,t){return c.getStore().dispatch(a.setSelection(e,{start:t,end:t}))}function u(i,r){if(!i)throw new o.ArgumentError("filePath","pageTreeHandlerService.goToFileLine",i);if(r.functionName||e.isNumber(r.caretOffset)){var s=c.getStore();return r.caretOffset?p(i,r.caretOffset):s.dispatch(a.loadFile(i)).then(function(e){var o;try{o=t.codeExportsService.getCaretInfoForExportStatement(e,r.functionName)}catch(e){return n.reject("cannot navigate due to code error")}o.found&&p(i,o.caretOffset)})}}function m(t,n){return e(t.wixCode.fileSystem.getRoots()).map("location").find(function(t){return e.startsWith(n,t)})}function E(t,n,r){if(!n)throw new o.ArgumentError("filePath","pageTreeHandlerService.setFocusOnBackedFileLine",n);return d(m(t,n)).then(c.getStore).then(function(e){return l.getFileSystemEntry(e.getState(),n)}).then(function(e){if(!e)throw new o.FileSystemError("The file "+n+" does not exist");return e.get("descriptor").toJS()}).then(function(o){t.panelManager.closeAllPanels();var r=t.developerMode.createContext(i.constants.DEVELOPER_MODE.CONTEXT_TYPES.FILE,e.assign({id:n},o));return t.developerMode.setContext(r)}).then(u.bind(this,n,r||{}))}return{navigateToFile:E}}),define("wixCode/code/services/collectionsTreeHandlerService",["lodash","core","wixCode/code/actions/fileSystemActions","wixCode/code/reducers/codeStateReader","wixCode/core/store/storeManager"],function(e,t,n,i,o){function r(e){return o.getStore().dispatch(n.expand(e))}function s(n,r){var s=n.wixCode.fileSystem.getRoots().schemas.location+r+".json",a=i.getFileSystemEntry(o.getStore().getState(),s).get("descriptor").toJS(),l=n.developerMode.createContext(t.constants.DEVELOPER_MODE.CONTEXT_TYPES.COLLECTION,e.assign({id:s},a));n.developerMode.setContext(l)}function a(e,t){var n=e.documentServices.platform.getAppDataByAppDefId(e.documentServices.platform.editorApps.DATA_BINDING.appDefId);e.wixCode.fileSystem.flush(),e.documentServices.platform.notifyApplication(n.applicationId,{eventType:"treeItemSelected",eventPayload:{itemName:t,instance:e.wixCode.getClientSpec().instance,origin:"ideTree"}})}function l(e,t){return r(e.wixCode.fileSystem.getRoots().schemas.location).then(function(){e.panelManager.closeAllPanels(),s(e,t),a(e,t)})}return{navigateToCollection:l}}),define("wixCode/core/services/wixCodeLoaderService",["coreUtilsLib","lodash","bluebird","wixCode/code/actions/fileSystemActions","wixCode/code/services/eventService","wixCode/code/services/uiService","wixCode/code/services/snippetService","wixCode/core/services/reactBootstrapper","wixCode/code/services/codeIntelligenceService","wixCode/core/services/ideContainerStateService","wixCode/core/services/fileSystemApiCreator","wixCode/core/services/consoleApiCreator","wixCode/core/services/mediaManagementServiceCreator","wixCode/core/services/consoleContainerStateService","wixCode/code/services/fileTreeHandlerService","wixCode/code/services/collectionsTreeHandlerService"],function(e,t,n,i,o,r,s,a,l,c,d,p,u,m,E,h){function f(e){c.initialize(e.developerMode.ui),l.initialize(e.documentServices.platform.registerToManifestAdded),m.initialize(e.developerMode.ui)}function C(e,t){var n=t.wixCode.fileSystem.getRoots();e.dispatch(i.setFile(n.schemas)),e.dispatch(i.setFile(n.public)),e.dispatch(i.setFile(n.backend))}function g(e,n){var i={wixCode:{fileSystem:d(n),console:p(n,e),events:o,fileTree:E,collectionsTree:h,snippets:s,ui:r,media:u(e)}};t.merge(e,i)}function _(e){return new n(function(t,n){e.wixCode.isProvisioned()?t():(T(e),e.wixCode.provision({onSuccess:t,onError:n}))})}function T(e){e.components.code.generateNicknamesForSite(),e.history.clear()}function I(i){var o=a.initialize(i);return g(i,o),i.autosaveManager.init({enabled:!1},!0),i.documentServices.generalInfo.isFirstSave()||i.saveManager.saveInBackground(t.noop,t.noop,"toggleDeveloperMode"),_(i).then(function(){return f(i),C(o,i),i.wixCode.console.registerToMessages(),{store:o,editorAPI:i}}).catch(function(t){return e.log.error(t),n.reject(t)})}return{load:I}}),define("wixCode/editorAPIHooks/removeStaticCodeBehaviors",["lodash"],function(e){function t(e){return e.behavior&&"widget"===e.behavior.type&&"runCode"===e.behavior.name}function n(n){var i=JSON.parse(n),o=e.reject(i,t);return JSON.stringify(o)}function i(t,i){if(!e.has(i,"behaviors"))return i;if(e.isPlainObject(i.behaviors)){var o=e.get(i,"behaviors.items",[]);e.set(i,"behaviors.items",n(o))}return i}return i}),define("wixCode/core/components/wixCodeLoader/wixCodeLoader",["react","core","wixCode/core/services/wixCodeLoaderService","wixCode/editorAPIHooks/removeStaticCodeBehaviors","wixCode/core/consts"],function(e,t,n,i,o){return e.createClass({displayName:"wixCodeLoader",mixins:[t.mixins.editorAPIMixin],render:function(){return null},componentWillMount:function(){var e=this.getEditorAPI();e.wixCode.isLoaded()||(n.load(e).then(function(){e.wixCode.setLoaded()}).catch(function(){e.developerMode.toggle(),e.panelManager.openPanel("savePublish.panels.common.failPanel",{titleKey:"WixCode_DeveloperModeFail_Title",description:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION",stepsTitle:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION_BOLD",steps:["SAVE_PUBLISH_ERROR_OPTION_1","WixCode_DeveloperModeFail_Step2_Text","WixCode_DeveloperModeFail_Step3_Text"],helpMessage:"WixCode_DeveloperModeFail_Learn_More_Label",helpLinkMessage:"WixCode_DeveloperModeFail_Learn_More_Link",helpLink:o.DEVELOPER_MODE_FAIL_PANEL.HELP_LINK,errorCode:o.DEVELOPER_MODE_FAIL_PANEL.ERROR_CODE})}),e.registerSerializeComponentPlugin("*",i))}})}),define("wixCode",["util","coreUtilsLib","wixCode/code/services/eventService","wixCode/code/services/snippetService","wixCode/core/components/console/consoleContainer","wixCode/core/components/ide/ide","wixCode/core/components/ideTree/ideTree","wixCode/core/components/developerToolBar/developerToolBar","wixCode/core/components/developerWelcomePanel/developerWelcomePanel","wixCode/core/components/deleteFileSystemItemWarningPanel/deleteFileSystemItemWarningPanel","wixCode/core/components/fileSystemOperationErrorPanel/fileSystemOperationErrorPanel","wixCode/core/components/wixCodeLoader/wixCodeLoader","wixCode/code/services/fileTreeHandlerService"],function(e,t,n,i,o,r,s,a,l,c,d,p,u){return function(){var n=e.url.joinURL(e.serviceTopology.scriptsDomainUrl,"services","wix-code-ide","1.15.0","code_edit","built-codeEdit.css");t.cssUtils.addStylesheetOfUrl(n)}(),{snippets:i,events:n,pageTree:u,components:{console:o,IDE:r,Tree:s,developerToolBar:a,wixCodeLoader:p},panels:{fileSystemOperationErrorPanel:d,deleteFileSystemItemWarningPanel:c,developerWelcomePanel:l}}});
//# sourceMappingURL=wixCode.min.js.map