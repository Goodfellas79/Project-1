"use strict";define("stateManagement/store/connect",["lodash","react","reduxLibs","prop-types"],function(e,n,t,a){return function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.noop,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.noop,s=arguments[2];return function(i){var l=function(n,t){var a=t.dsRead;return function(t,s){var i=o(t,s,a),l=r(n,s);return e.assign({},i,l,s)}},c=function(e,a){return n.createElement(t.reactRedux.connectAdvanced(l,{methodName:"connect",shouldHandleStateChanges:s,dsRead:a.dsRead})(i),e)};return c.contextTypes={dsRead:a.object},c}}}),define("stateManagement/store/combineReducers",["lodash"],function(e){return function(n){return function(t,a){var o=!1,r=e.mapValues(t,function(t,r){var s=(n[r]||e.identity)(t,a);return s!==t&&(o=!0),s});return o?r:t}}}),define("stateManagement/panels/panelsActionTypes",[],function(){return{OPEN_PANEL:"openPanel",UPDATE_PANEL:"updatePanel",CLOSE_ALL_PANELS:"closeAllPanels",CLOSE_PANEL_BY_NAME:"closePanelByName",CLOSE_PANEL_BY_PROP:"closePanelByProp",STAGE_MOUSE_DOWN:"STAGE_MOUSE_DOWN",OPEN_HELP_CENTER:"openHelpCenter",CLOSE_HELP_CENTER:"closeHelpCenter"}}),define("stateManagement/panels/panelsReducer",["lodash","stateManagement/panels/panelsActionTypes","constants"],function(e,n,t){var a=n.OPEN_PANEL,o=n.UPDATE_PANEL,r=n.CLOSE_ALL_PANELS,s=n.CLOSE_PANEL_BY_NAME,i=n.CLOSE_PANEL_BY_PROP,l=n.STAGE_MOUSE_DOWN,c=[t.PANEL_TYPES.LEFT,t.PANEL_TYPES.PAGES,t.PANEL_TYPES.TPA_SETTINGS];return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case a:return n.concat(t.panelDescriptor);case o:return e.map(n,function(n){return n.name===t.panelDescriptor.name?e.assign({},n,t.panelDescriptor,{props:e.assign({},n.props,t.panelDescriptor.props)}):n});case s:return e.reject(n,{name:t.panelName});case i:return e.reject(n,function(e){return e.props[t.prop]===t.propValue});case r:return n.length?[]:n;case l:return e.reject(n,function(n){return e.includes(c,n.frameType)});default:return n}}}),define("stateManagement/selection/selectionActionTypes",[],function(){return{SELECT_COMPONENTS:"selectComponents",ADD_TO_SELECTION:"addToSelection",CLEAR_SELECTED_COMPONENTS:"clearSelectedComponents"}}),define("stateManagement/selection/selectionReducer",["lodash","coreUtilsLib","stateManagement/selection/selectionActionTypes"],function(e,n,t){var a=t.SELECT_COMPONENTS,o=t.ADD_TO_SELECTION,r=t.CLEAR_SELECTED_COMPONENTS;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=arguments[1];switch(s.type){case a:return e.isArray(s.compRefs)?s.compRefs:(n.log.error("selected comps must be an array"),t);case o:return e.isArray(s.compRefs)?t.concat(s.compRefs):(n.log.error("selected comps must be an array"),t);case r:return[];default:return t}}}),define("stateManagement/panels/helpPropsReducer",["lodash","stateManagement/panels/panelsActionTypes"],function(e,n){var t=n.OPEN_HELP_CENTER,a=n.CLOSE_HELP_CENTER;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments[1];switch(n.type){case t:return n.helpPanelProps;case a:return null;default:return e}}}),define("stateManagement/legacy/legacyActionTypes",[],function(){return{SET_STATE:"set-state"}}),define("stateManagement/legacy/setStateReducer",["lodash","stateManagement/legacy/legacyActionTypes"],function(e,n){var t=n.SET_STATE,a=e.assign;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1];switch(n.type){case t:return a({},e,n.state);default:return e}}}),define("stateManagement/legacy/legacyReducer",["lodash","stateManagement/legacy/setStateReducer"],function(e,n){return function(e){return function(t,a){var o=n(t,a);return e(o,a)}}}),define("stateManagement/devMode/devModeActionTypes",[],function(){return{RESET_CONTEXT:"resetContext"}}),define("stateManagement/devMode/devModeReducer",["lodash","core","stateManagement/devMode/devModeActionTypes"],function(e,n,t){var a={type:n.constants.DEVELOPER_MODE.CONTEXT_TYPES.PAGE,data:void 0},o=t.RESET_CONTEXT;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;switch(arguments[1].type){case o:return a;default:return e}}}),define("stateManagement/store/initialEditorState",["core","baseUI"],function(e,n){var t=e.constants,a=n.uiConstants;return{editorIsInit:!1,config:{topBarHeight:a.TOPBAR_HEIGHT,previewHeight:null,previewWidth:null,languages:["latin"],extraSiteHeight:40},navControlsSize:null,previewPosition:{top:a.TOPBAR_HEIGHT,left:0,height:0,width:0},editingAreaPosition:{top:0,left:0,height:0,width:0,right:0,bottom:0},wixCodeLoaded:!1,devModeContext:{type:t.DEVELOPER_MODE.CONTEXT_TYPES.PAGE,data:void 0},contextMenu:null,registeredMouseMoveAction:null,performingMouseMoveAction:!1,selectedComponents:null,focusedContainer:null,lastSelectionClickPos:null,previewMode:!1,isMobileEditor:!1,isLayoutTractorOpen:!1,snapData:null,lassoLayout:null,candidates:null,clipboard:{},site:{premiumPackage:void 0},topBar:{modeSwitchAnimationProgress:e.constants.TOP_BAR.EDITOR_MODE_SWITCH.ANIMATION_PROGRESS.IDLE,openedDropPanel:null,dropPanelDisabled:!1,shouldDropPanelRemainOpen:!1},viewTools:{toolbarEnabled:void 0,developerToolBarEnabled:void 0,platformToolBarEnabled:void 0,guidelinesEnabled:void 0,sectionsHandlesEnabled:void 0,snapToEnabled:void 0,rulersEnabled:void 0,rulers:{guidesState:void 0,selectedGuide:void 0,isHovered:void 0,isDragging:null}},hasDatabaseCollections:null,platformToolBarPanelProps:void 0,helpProps:null,attachCandidate:null,constraintArea:null,openPanels:[],previewingStatus:t.PROGRESS_STATUS.IDLE,savingStatus:t.PROGRESS_STATUS.IDLE,publishingStatus:t.PROGRESS_STATUS.IDLE,savePublish:{isSaveInProgress:!1,isPublishInProgress:!1,isDiffSaveInProgress:!1,publishPanelPromotionIndex:0},sitePremiumState:null,portalComps:{},mobile:{isHiddenItemsCounterVisible:!0,reAddedHiddenElement:{compRef:null,addingPhase:t.LEFT_BAR.MOBILE_HIDDEN_ELEMENTS.PROGRESS.IDLE}},applyModeFromClipboardSuggestion:null,leftBar:{isCollapsed:!1,isMobileCollapsed:!1,notifications:{},superApps:{desktop:[],mobile:[]},buttonsBoundingRect:{},buttonsActiveState:{}},topBarPagesFilter:"",topBarCustomization:{tooltipOverrides:{UNDO:null,SAVE:null}},pageSections:{sections:null,selectedSection:null},siteScale:1,pinPreviewRectStyle:{opacity:0},hideTools:!1,hideToolsAndMaintainStagePosition:!1,shouldHideToolsBtnBlink:!1,halfOpacityTools:!1,unreadComments:0,isOpenTextEditor:!1,imageCrop:{isOn:!1,cropArea:null,cropOriginArea:null},shouldOverlayUpdate:!0,tabIndicationState:{indication:"INACTIVE",activeMode:void 0},isTooltipsDisabled:!1,floatingBubble:{value:null,targetLayout:null,bubbleProps:{},shouldNotHideOnMouseLeaveTarget:!1},scrollTo:null,animateScrollTo:null,eventCounters:{focus:0,clearTextSelection:0},__renderCounter:0}}),define("stateManagement/store/createEditorStore",["reduxLibs","stateManagement/store/combineReducers","stateManagement/panels/panelsReducer","stateManagement/selection/selectionReducer","stateManagement/panels/helpPropsReducer","stateManagement/legacy/legacyReducer","stateManagement/devMode/devModeReducer","stateManagement/store/initialEditorState"],function(e,n,t,a,o,r,s,i){var l=e.redux,c=e.reduxThunk;return function(){var e=n({openPanels:t,helpProps:o,devModeContext:s,selectedComponents:a}),u={};return l.createStore(r(e),i,l.applyMiddleware(c.withExtraArgument(u)))}}),define("stateManagement/store/throttledStore",["lodash"],function(e){var n=function(e){return e()};return function(t,a){function o(){c=!1,e.forEach(e.clone(l),n)}function r(){t(r),c&&o()}function s(e){a.dispatch(e),o()}function i(n){return l.push(n),function(){l=e.without(l,n)}}var l=[],c=!1;return a.subscribe(function(){c=!0}),t(r),{subscribe:i,dispatchImmediate:s,dispatch:a.dispatch,getState:a.getState}}}),define("stateManagement/legacy/setStateAction",["stateManagement/legacy/legacyActionTypes"],function(e){var n=e.SET_STATE;return function(e){return{type:n,state:e}}}),define("stateManagement/store/splitDocumentServices",["lodash"],function(e){return function(n,t){return function(a){return{dsRead:e.reduce(n,function(n,t){var o=e.get(a,t);return e.set(n,t,o),n},{}),dsWrite:e.reduce(t,function(n,t){var o=e.get(a,t);return e.set(n,t,o),n},{})}}}}),define("stateManagement/store/dsPaths.json",[],function(){return{read:["pages.getReference","pages.getFocusedPageId","pages.getPrimaryPageId","components.isDescendantOfComp","components.getPage","components.data.get","components.design.get","components.properties.get","components.layout.getSnugLayout","components.layout.getSnugLayoutRelativeToScreen","components.layout.getSnugLayoutRelativeToScreenConsideringScroll","components.layout.getSnugLayoutRelativeToStructure","components.layout.canBeFixedPosition"],write:["waitForChangesApplied","components.setContainer","components.reparentComponentToPage","components.multiComponents.distribute","components.multiComponents.matchSize","bi.event"]}}),define("stateManagement/legacy/legacyLogic",["lodash","stateManagement/store/splitDocumentServices","stateManagement/store/dsPaths.json"],function(e,n,t){return{loadDocumentServices:function(a){return function(o,r,s){e.assign(s,n(t.read,t.write)(a))}}}}),define("stateManagement/legacy/legacy",["stateManagement/legacy/legacyReducer","stateManagement/legacy/setStateAction","stateManagement/legacy/legacyLogic"],function(e,n,t){return{reducer:e,setState:n,logic:t}}),define("stateManagement/panels/panelsActions",["stateManagement/panels/panelsActionTypes"],function(e){var n=e.OPEN_PANEL,t=e.UPDATE_PANEL,a=e.CLOSE_ALL_PANELS,o=e.CLOSE_PANEL_BY_NAME,r=e.CLOSE_PANEL_BY_PROP,s=e.STAGE_MOUSE_DOWN,i=e.OPEN_HELP_CENTER,l=e.CLOSE_HELP_CENTER;return{openPanel:function(e){return{type:n,panelDescriptor:e}},updatePanel:function(e){return{type:t,panelDescriptor:e}},closeAllPanels:function(){return{type:a}},closePanelByName:function(e){return{type:o,panelName:e}},closePanelByPropKey:function(e,n){return{type:r,prop:e,propValue:n}},stageMouseDown:function(){return{type:s}},setPanelType:function(e,n,a){return{type:t,panelDescriptor:{name:e,frameType:n,singleInstance:a}}},openHelpCenter:function(e){return{type:i,helpPanelProps:e}},closeHelpCenter:function(){return{type:l}}}}),define("stateManagement/panels/panelsSelectors",["lodash","reduxLibs"],function(e,n){var t=function(e){return e.openPanels},a=function(e){return e.helpProps};return{selectOpenPanels:t,selectOpenPlatformPanels:n.reselect.createSelector(t,function(n){return e.filter(n,{type:"platform"})}),selectHelpProps:a,isColorPickerClosed:n.reselect.createSelector(t,function(n){return-1===e.findIndex(n,{name:"panels.toolPanels.colorPicker.colorPickerPanel"})}),isLinkDialogClosed:n.reselect.createSelector(t,function(n){return-1===e.findIndex(n,{name:"panels.toolPanels.linkPanel"})})}}),define("stateManagement/devMode/devModeSelectors",[],function(){return{selectDevModeContext:function(e){return e.devModeContext}}}),define("stateManagement/devMode/devModeActions",["stateManagement/devMode/devModeActionTypes"],function(e){var n=e.RESET_CONTEXT;return{resetDevModeContext:function(){return{type:n}}}}),define("stateManagement/bi/bi",["lodash","util","experiment"],function(e,n,t){return{event:function(a,o){return function(r,s,i){var l=i.dsWrite;if(l){a=e.defaults({},a,{src:38,endpoint:"editor",sampleRatio:0,esi:n.editorModel.editorSessionId}),o=[].concat(o)||[{}];var c=n.editorModel.permissionsInfo;if(c){var u=c.ownerId,p=e.map(c.loggedInUserRoles,"role").join(",");o=e.map(o,function(n){return e.assign({},n,{ownerId:u,roles:p})})}t.isMultiValueExperimentOpen("editorHintsConfigs")&&require.defined("editorHints")&&require("editorHints").manager.handleBiEvent(a,o),e.forEach(o,function(e){l.bi.event(a,e)})}}}}}),define("stateManagement/panels/panelsLogic",["lodash","util","stateManagement/panels/panelsSelectors","stateManagement/devMode/devModeSelectors","stateManagement/panels/panelsActions","stateManagement/devMode/devModeActions","stateManagement/bi/bi","coreUtilsLib","constants","core"],function(e,n,t,a,o,r,s,i,l,c){function u(n,t){return e.defaults({},t,{panelName:n,key:n+e.uniqueId()})}function p(n){e.forEach(n,function(e){d(e)})}function d(n,t){n&&e.isFunction(n.resolve)&&n.resolve(t)}function m(){var t=n.editorModel.permissionsInfo;return t?"ownerId="+t.ownerId+"&roles="+e.map(t.loggedInUserRoles,"role").join(","):""}var f=a.selectDevModeContext,g=t.selectOpenPanels,E=t.selectOpenPlatformPanels,P=function(n){return function(t,a){var o=a(),s=g(o),i=e.difference(n,s),l=e.filter(i,{name:"platformPanels.fullStagePanel"});e.isEmpty(l)||f(o).type!==c.constants.DEVELOPER_MODE.CONTEXT_TYPES.COLLECTION||t(r.resetDevModeContext())}},M=function(n,t,a){return function(r,s){a||r(v()),e.includes(n,"help")&&i.log.error("openPanel method is deprecated for help panels. Use openHelpCenter instead");var l=g(s()),c=e.find(l,{name:n});r(c&&c.singleInstance?o.updatePanel({name:n,props:t}):S(n,t))}},S=function(n,t){return function(a){var r={name:n,props:u(n,t)};e.get(t,"token")&&e.assign(r,{token:e.get(t,"token")}),a(o.openPanel(r)),a(s.event(c.bi.events.panels.PANEL_OPENED,{panel_name:n}))}},v=function(){return function(n,t){var a=t(),r=g(a);e.forEach(r,function(e){n(s.event(c.bi.events.panels.PANEL_CLOSED,{panel_name:e.name}))}),p(E(a)),n(o.closeAllPanels()),n(P(r))}},T=function(n,t){return function(a,r){var i=r(),l=g(i);e(i).thru(E).filter(function(e){return e.props[n]===t}).forEach(function(e){d(e)}),a(o.closePanelByPropKey(n,t));var u=g(r()),p=e.difference(l,u);e.forEach(p,function(e){a(s.event(c.bi.events.panels.PANEL_CLOSED,{panel_name:e.props.panelName}))}),a(P(l))}},y=function(e){return function(n){n(T("panelName",e))}},C=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(a){a(v());var r={name:n,props:e.assign({},u(n,t),{useLastPanelPosition:!!t.useLastPanelPosition}),frameType:l.PANEL_TYPES.COMP};a(o.openPanel(r)),a(s.event(c.bi.events.panels.PANEL_OPENED,{panel_name:n}))}};return{updateOrOpenPanel:M,openComponentPanel:C,openPlatformPanel:function(n){return function(t){var a=e.assign({name:n.panelName,props:u(n.panelName,n.panelProps),type:l.PANEL_TYPES.PLATFORM,token:n.panelProps.token},e.get(n,"panelMetaData",{}));t(M(a.name,a.props,!a.closeAllOtherPanels)),t(o.updatePanel(a))}},closeOpenedPanels:v,closePanelByPropKey:T,closePanelByName:y,openHelpCenter:function(n,t,a){return function(r){var i=[],u=m();u&&i.push(u),a&&a.component&&i.push("selectedCompType="+a.component);var p=n||l.GENERAL_HELP_KEY,d=i.length?p+"?"+i.join("&"):p,f=e.assign({},t,{helpUrl:d,biHelpParams:a,panelName:"panels.helpPanels.helpPanel"});r(o.openHelpCenter(f));var g=e.assign({learn_more:!1},a);r(s.event(c.bi.events.help.HELP_CLICK,g))}},closeAllPanelsOfType:function(n){return function(t,a){var o=g(a());e(o).filter({frameType:n}).map("name").map(y).forEach(t)}},closePlatformPanel:function(n,t){return function(a,o){var r=g(o()),s=e.find(r,{token:n});s&&(d(s,t),a(y(s.name)))}},openFirstTimePanel:function(n){return function(t){if(e.includes(l.FIRST_TIME_PANEL_COMPONENTS,n)){var a="compPanels.panels."+n+".firstTime";t(C(a,{panelName:a,title:"firstTime"}))}}},updatePanel:function(e,n){return function(t){t(o.updatePanel({name:e,props:n}))}}}}),define("stateManagement/panels/panels",["stateManagement/panels/panelsActions","stateManagement/panels/panelsLogic","stateManagement/panels/panelsReducer","stateManagement/panels/helpPropsReducer","stateManagement/panels/panelsSelectors"],function(e,n,t,a,o){return{actions:e,logic:n,reducer:t,helpPropsReducer:a,selectors:o}}),define("stateManagement/selection/selectionSelectors",[],function(){return{selectSelectedCompsRefs:function(e){return e.selectedComponents}}}),define("stateManagement/selection/selectionActions",["stateManagement/selection/selectionActionTypes"],function(e){var n=e.SELECT_COMPONENTS,t=e.ADD_TO_SELECTION,a=e.CLEAR_SELECTED_COMPONENTS;return{addToSelection:function(e){return{type:t,compRefs:e}},selectComponents:function(e){return{type:n,compRefs:e}},clearSelectedComponents:function(){return{type:a}}}}),define("stateManagement/selection/selection",["stateManagement/selection/selectionReducer","stateManagement/selection/selectionSelectors","stateManagement/selection/selectionActions"],function(e,n,t){return{reducer:e,selectors:n,actions:t}}),define("stateManagement/applyModeFromClipboard/applyModeFromClipboardSelectors",[],function(){return{selectApplyModeFromClipboardSuggestion:function(e){return e.applyModeFromClipboardSuggestion}}}),define("stateManagement/applyModeFromClipboard/applyModeFromClipboard",["stateManagement/applyModeFromClipboard/applyModeFromClipboardSelectors"],function(e){return{selectors:e}}),define("stateManagement",["stateManagement/store/connect","stateManagement/store/createEditorStore","stateManagement/store/throttledStore","stateManagement/legacy/legacy","stateManagement/panels/panels","stateManagement/selection/selection","stateManagement/applyModeFromClipboard/applyModeFromClipboard","stateManagement/bi/bi","stateManagement/store/combineReducers","stateManagement/store/splitDocumentServices","stateManagement/store/dsPaths.json"],function(e,n,t,a,o,r,s,i,l,c,u){return{connect:e,createEditorStore:n,throttledStore:t,legacy:a,panels:o,selection:r,applyModeFromClipboard:s,bi:i,combineReducers:l,splitDocumentServices:c(u.read,u.write)}});
//# sourceMappingURL=stateManagement.min.js.map