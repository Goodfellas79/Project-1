"use strict";define("mediaServices/services/wixMediaManager/constants",["util"],function(e){return{BASE_HOST:e.serviceTopology.baseDomain,MMGR_BASE_URL:e.serviceTopology.mediaManagerUrl,MMGR_UOU_UPLOAD_NAMESPACE:"_WixCodeAnonymUpload",MMGR_LANGUAGE_CODE:e.editorModel.languageCode,MMGR_WINDOW_STYLE:"fullscreen",MMGR_MAX_PARALLEL_UPLOADS:6,MMGR_SELECTION_TYPE:["single","multiple"],MMGR_TRANSLATION_KEYS_MAP:{description:{private:"private_media.upload_restrictions_header_message",external:"social_images.upload_restrictions_header_message",public:"free_from_wix.upload_restrictions_header_message",photoStock:"bigstock_images.upload_restrictions_header_message"},tab:{private:"private_media_tab",external:"external_media_tab",public:"public_media_tab",photoStock:"photo_stock_tab"},noItems:{allMediaFolder:{header:"no_items.header_allMedia",text:"no_items.text_allMedia"},siteMediaFolder:{header:"no_items.header_siteMedia",text:"no_items.text_siteMedia"},userMediaFolder:{header:"no_items.header_user_folder",text:"no_items.text_user_folder"}},title:"header",submitButton:"footer.submit",uploadButton:"uploader.upload"},MMGR_SERVICES_LIST_MAP:{FACEBOOK:"facebook",FLICKR:"flickr",INSTAGRAM:"instagram",PICASA:"picasa",GOOGLE_DRIVE:"drive",DROPBOX:"dropbox"},SINGLE:0,MULTIPLE:1,PRIVATE_MEDIA:"private",MMGR_TABS_MAP:{MY_SHAPE:"private",MY_SHAPE_UOU:"private",MY_IMAGE:"private",MY_IMAGE_PRO:"private",MY_IMAGE_UOU:"private",MY_VIDEO:"private",MY_VIDEO_PRO:"private",MY_VIDEO_UOU:"private",MY_MUSIC:"private",MY_MUSIC_PRO:"private",MY_MUSIC_UOU:"private",MY_DOCUMENT:"private",MY_DOCUMENT_PRO:"private",MY_DOCUMENT_UOU:"private",MY_FLASH:"private",MY_FLASH_UOU:"private",MY_FAVICON:"private",MY_NETWORK:"external",FREE_FROM_WIX:"public",BIG_STOCK:"photoStock"},MMGR_IMAGE_ANALYSIS_OPTIONS:{faces:"face",labels:"label",dominantColors:"color",cropHints:"crop_hint",landmarks:"landmark",logos:"logo"}}}),define("mediaServices/services/wixMediaManager/presets",["mediaServices/services/wixMediaManager/constants"],function(e){return{SHAPE:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!1,canUseImageAnalysis:!1,tabsList:{open:["FREE_FROM_WIX"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:[],mmgrParams:{i18nPrefix:["shape","multiple_shapes"],mediaType:"shape",publicMediaRoot:"shapes",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},VECTOR_ART:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!1,canUseImageAnalysis:!1,tabsList:{open:["FREE_FROM_WIX"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:[],mmgrParams:{i18nPrefix:["shape","multiple_shapes"],mediaType:"shape",publicMediaRoot:"vector_art",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},IMAGE:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!0,tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","BIG_STOCK"],manage:["MY_IMAGE"],default:"MY_IMAGE"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["single_image","multiple_images"],mediaType:"picture",publicMediaRoot:"photos",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},IMAGE_PRO:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!0,tabsList:{open:["MY_IMAGE_PRO"],manage:["MY_IMAGE_PRO"],default:"MY_IMAGE_PRO"},socialNetworksList:[],mmgrParams:{i18nPrefix:["single_secure_image","addmultiple_secure_images"],mediaType:"secure_picture",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},IMAGE_UOU:{canAddMedia:!1,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!1,canUseImageAnalysis:!0,tabsList:{open:["MY_IMAGE_UOU"],manage:["MY_IMAGE_UOU"],default:"MY_IMAGE_UOU"},socialNetworksList:[],mmgrParams:{i18nPrefix:["single_image","multiple_images"],mediaType:"picture",publicMediaRoot:"",videoEncodingProfile:"",namespace:e.MMGR_UOU_UPLOAD_NAMESPACE},translationMap:{title:!0,tabCaption:!0,description:!0,uploadCaption:!1,noItems:!0,submitCaption:!1}},DOCUMENT_UOU:{canAddMedia:!1,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!1,canUseImageAnalysis:!1,tabsList:{open:["MY_DOCUMENT_UOU"],manage:["MY_DOCUMENT_UOU"],default:"MY_DOCUMENT_UOU"},socialNetworksList:[],mmgrParams:{i18nPrefix:["document","addmultiple_document"],mediaType:"document",publicMediaRoot:"",videoEncodingProfile:"",namespace:e.MMGR_UOU_UPLOAD_NAMESPACE},translationMap:{title:!0,tabCaption:!0,description:!0,uploadCaption:!1,noItems:!0,submitCaption:!1}},VIDEO:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!0,canUploadMedia:!0,canUseImageAnalysis:!1,tabsList:{open:["MY_VIDEO"],manage:["MY_VIDEO"],default:"MY_VIDEO"},socialNetworksList:[],mmgrParams:{i18nPrefix:["video","addmultiple_video"],mediaType:"video",publicMediaRoot:"",videoEncodingProfile:"mp4-storyboard",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},MUSIC:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!1,tabsList:{open:["MY_MUSIC"],manage:["MY_MUSIC"],default:"MY_MUSIC"},socialNetworksList:[],mmgrParams:{i18nPrefix:["music","addmultiple_music"],mediaType:"music",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},MUSIC_PRO:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!1,tabsList:{open:["MY_MUSIC_PRO"],manage:["MY_MUSIC_PRO"],default:"MY_MUSIC_PRO"},socialNetworksList:[],mmgrParams:{i18nPrefix:["secure_music","addmultiple_secure_music"],mediaType:"secure_music",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},DOCUMENT:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!1,tabsList:{open:["MY_DOCUMENT"],manage:["MY_DOCUMENT"],default:"MY_DOCUMENT"},socialNetworksList:[],mmgrParams:{i18nPrefix:["document","addmultiple_document"],mediaType:"document",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},FLASH:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!1,tabsList:{open:["MY_FLASH"],manage:[],default:"MY_FLASH"},socialNetworksList:[],mmgrParams:{i18nPrefix:["flash","multiple_flash"],mediaType:"swf",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},CLIPART:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!0,tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","BIG_STOCK"],manage:[],default:"MY_IMAGE"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["clipart","addmultiple_clipart"],mediaType:"picture",publicMediaRoot:"clipart",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},ILLUSTRATION:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!0,tabsList:{open:["FREE_FROM_WIX"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:[],mmgrParams:{i18nPrefix:["clipart","addmultiple_clipart"],mediaType:"picture",publicMediaRoot:"illustrations",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},BG_IMAGE:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!0,tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","BIG_STOCK"],manage:[],default:"MY_IMAGE"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["background","multiple_background"],mediaType:"picture",publicMediaRoot:"backgrounds",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},BG_VIDEO:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!0,canUploadMedia:!0,canUseImageAnalysis:!1,tabsList:{open:["MY_VIDEO","FREE_FROM_WIX"],manage:[],default:"MY_VIDEO"},socialNetworksList:[],mmgrParams:{i18nPrefix:["video","addmultiple_video"],mediaType:"video",publicMediaRoot:"videos",videoEncodingProfile:"mp4-storyboard",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},ICON_DOCUMENT:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!1,tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","BIG_STOCK"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["single_icon","multiple_icons"],mediaType:"picture",publicMediaRoot:"file_icons",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},ICON_SOCIAL:{canAddMedia:!0,canAddMultipleMedia:!0,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!1,tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","BIG_STOCK"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["single_icon","multiple_icons"],mediaType:"picture",publicMediaRoot:"social_icons",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}},ICON_FAVICON:{canAddMedia:!0,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:!0,canUseImageAnalysis:!1,tabsList:{open:["MY_FAVICON","BIG_STOCK"],manage:[],default:"MY_FAVICON"},socialNetworksList:[],mmgrParams:{i18nPrefix:["favicon","multiple_favicons"],mediaType:"site_icon",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:!0,tabCaption:!1,description:!0,uploadCaption:!0,noItems:!1,submitCaption:!0}}}}),define("mediaServices/services/wixMediaManager/mmgrUtils",["lodash","mediaServices/services/wixMediaManager/constants","util"],function(e,a,i){function t(e){return e.mmgrParams.mediaType}function n(e){return a.MMGR_SELECTION_TYPE[e.canAddMultipleMedia?a.MULTIPLE:a.SINGLE]}function o(e){return e.mmgrParams.i18nPrefix[e.canAddMultipleMedia?a.MULTIPLE:a.SINGLE]}function s(e){for(var a=[],i=0;i<e.tabsList.length;i++)a[i]=d(e.tabsList[i]);return a}function d(e){return a.MMGR_TABS_MAP[e]}function r(e){for(var i=[],t=0;t<e.socialNetworksList.length;t++)i[t]=a.MMGR_SERVICES_LIST_MAP[e.socialNetworksList[t]];return i}function l(t){var n,o,s={},r=t.canAddMultipleMedia?"_MULTISELECT":"";return t.translationMap.title&&(n=("MMGR_API_"+t.categoryName+(t.manageMode?"_MANAGE":"_OPEN")+"_TITLE"+r).toUpperCase(),o=a.MMGR_TRANSLATION_KEYS_MAP.title,s[o]=t.translation.title||i.translate(n)),e.forEach(t.tabsList,function(e){t.translationMap.tabCaption&&(n=("MMGR_API_"+e+"_TAB").toUpperCase(),o=a.MMGR_TRANSLATION_KEYS_MAP.tab[d(e)],s[o]=i.translate(n)),t.translationMap.description&&(n=("MMGR_API_"+e+"_DESCRIPTION").toUpperCase(),o=a.MMGR_TRANSLATION_KEYS_MAP.description[d(e)],s[o]=i.translate(n)),d(e)===a.PRIVATE_MEDIA&&t.translationMap.noItems&&(n=("MMGR_API_"+e+"_NO_ITEMS_HEADER_ALL_MEDIA").toUpperCase(),o=a.MMGR_TRANSLATION_KEYS_MAP.noItems.allMediaFolder.header,s[o]=i.translate(n),n=("MMGR_API_"+e+"_NO_ITEMS_TEXT_ALL_MEDIA").toUpperCase(),o=a.MMGR_TRANSLATION_KEYS_MAP.noItems.allMediaFolder.text,s[o]=i.translate(n),n=("MMGR_API_"+e+"_NO_ITEMS_HEADER_SITE_MEDIA").toUpperCase(),o=a.MMGR_TRANSLATION_KEYS_MAP.noItems.siteMediaFolder.header,s[o]=i.translate(n),n=("MMGR_API_"+e+"_NO_ITEMS_TEXT_SITE_MEDIA").toUpperCase(),o=a.MMGR_TRANSLATION_KEYS_MAP.noItems.siteMediaFolder.text,s[o]=i.translate(n),n=("MMGR_API_"+e+"_NO_ITEMS_HEADER_USER_FOLDER").toUpperCase(),o=a.MMGR_TRANSLATION_KEYS_MAP.noItems.userMediaFolder.header,s[o]=i.translate(n),n=("MMGR_API_"+e+"_NO_ITEMS_TEXT_USER_FOLDER").toUpperCase(),o=a.MMGR_TRANSLATION_KEYS_MAP.noItems.userMediaFolder.text,s[o]=i.translate(n))}),t.translationMap.uploadCaption&&(n=("MMGR_API_"+t.categoryName+"_UPLOAD_BUTTON").toUpperCase(),o=a.MMGR_TRANSLATION_KEYS_MAP.uploadButton,s[o]=i.translate(n)),t.translationMap.submitCaption&&(n=("MMGR_API_"+t.categoryName+"_SUBMIT_BUTTON"+r).toUpperCase(),o=a.MMGR_TRANSLATION_KEYS_MAP.submitButton,s[o]=t.translation.submitButton||i.translate(n)),s}function M(i){return e(a.MMGR_IMAGE_ANALYSIS_OPTIONS).keys().filter(function(e){return i[e]}).map(function(e){return a.MMGR_IMAGE_ANALYSIS_OPTIONS[e]}).value()}return{getMMGRMediaType:t,getMMGRSelectionType:n,getMMGRI18nPrefix:o,getMMGRTabsList:s,getMMGRServicesList:r,getMMGRTranslations:l,getImageAnalysisOptions:M}}),define("mediaServices/services/wixMediaManager/adapter",["lodash","jquery","mediaServices/services/wixMediaManager/presets","mediaServices/services/wixMediaManager/constants","mediaServices/services/wixMediaManager/mmgrUtils","coreUtilsLib"],function(e,a,i,t,n,o){function s(a,n,s){s=s||{};var d=i[n],l={categoryName:n,tabsList:d.tabsList.manage,socialNetworksList:d.socialNetworksList,mmgrParams:d.mmgrParams,canAddMedia:!1,canAddMultipleMedia:!1,canAddMediaBeforeEncodingComplete:!1,canUploadMedia:d.canUploadMedia,manageMode:!0,path:s.path||t.MMGR_TABS_MAP[d.tabsList.default],translation:{},translationMap:d.translationMap,siteMediaToken:a.siteMediaToken,isEmailWithWixDomain:a.isEmailWithWixDomain,imageAnalysis:d.canUseImageAnalysis?s.imageAnalysis||null:null};s.translation&&s.translation.title&&(l.translation.title=s.translation.title),s.callback&&(l.callback=s.callback),e.isEmpty(l.tabsList)?o.log.error(n+" is an un-managed category"):r(l)}function d(e,a,n){n=n||{};var o=i[a],s={categoryName:a,tabsList:o.tabsList.open,socialNetworksList:o.socialNetworksList,mmgrParams:o.mmgrParams,canAddMedia:o.canAddMedia,canAddMultipleMedia:void 0===n.multiSelect?o.canAddMultipleMedia:n.multiSelect,canAddMediaBeforeEncodingComplete:o.canAddMediaBeforeEncodingComplete,canUploadMedia:o.canUploadMedia,manageMode:!1,path:n.path||t.MMGR_TABS_MAP[o.tabsList.default],translation:{},translationMap:o.translationMap,siteMediaToken:e.siteMediaToken,isEmailWithWixDomain:e.isEmailWithWixDomain,imageAnalysis:o.canUseImageAnalysis?n.imageAnalysis||null:null};n.translation&&(n.translation.title&&(s.translation.title=n.translation.title),n.translation.submitButton&&(s.translation.submitButton=n.translation.submitButton)),n.callback&&(s.callback=function(){n.callback.apply(null,arguments),window.focus()}),r(s)}function r(a){function i(e){if(a.callback){var t=e&&e.items||null,n=t&&{path:e.path}||null;a.callback(t,n)}o.off("close",i),o.off("items",i),l()}var o=M(),s={mediaGalleryBaseHost:t.MMGR_BASE_URL,baseHost:t.BASE_HOST,i18nCode:t.MMGR_LANGUAGE_CODE,windowStyle:t.MMGR_WINDOW_STYLE,i18nPrefix:n.getMMGRI18nPrefix(a),mediaType:n.getMMGRMediaType(a),selectionType:n.getMMGRSelectionType(a),canShowSelectButton:a.canAddMedia,canSubmitUntranscoded:a.canAddMediaBeforeEncodingComplete,disableUpload:!a.canUploadMedia,tabsList:n.getMMGRTabsList(a),path:a.path,siteMediaToken:a.siteMediaToken,isEmailWithWixDomain:a.isEmailWithWixDomain,maxParallelUploads:t.MMGR_MAX_PARALLEL_UPLOADS};if(a.imageAnalysis){var d=n.getImageAnalysisOptions(a.imageAnalysis);d.length&&(s.vision=d)}s.translations=n.getMMGRTranslations(a),a.mmgrParams.publicMediaRoot&&(s.publicMediaRoot=a.mmgrParams.publicMediaRoot),e.isEmpty(a.socialNetworksList)||(s.servicesList=n.getMMGRServicesList(a)),e.isEmpty(a.mmgrParams.videoEncodingProfile)||(s.videoEncodingProfile=a.mmgrParams.videoEncodingProfile),e.isEmpty(a.mmgrParams.namespace)||(s.namespace=a.mmgrParams.namespace),o.on("items",i).on("close",i),o.open(s),window.document.getElementById("mediaGalleryFrame").contentWindow.focus()}function l(){var e=a("#editor");if(e){var i=a(window),t=i.scrollTop();e.trigger("focus"),i.scrollTop(t)}}function M(){return window.MediaFrame}return{open:d,presets:i,manage:s,categories:function(){var a={};return e.forEach(e.keys(i),function(e){e=e.toUpperCase(),a[e]=e}),a}()}}),define("mediaServices/services/fontsManager/fontsUploader",["lodash","wixmp","util"],function(e,a,i){function t(t,n){if(t){var o=e.map(n,function(e){return{uploadFn:t.item.upload,source:{file:e,name:e.name,size:e.size,folderId:null,folderName:"All Media",mediaType:i.fontsManagerUtils.constants.FONTS_MEDIA_TYPE}}});a.Uploader.upload(o)}}function n(e){a.Uploader.on("fileStatusChanged",function(a){e(a)})}function o(e){a.Uploader.on("queueChanged",function(a){e(a)})}function s(){a.Uploader.uploadIsInProgress||a.Uploader.clearQueue()}function d(){return a.Uploader.uploadQueue}function r(e){var a=!1;if(e.canAbort())try{e.abort(),a=!0}catch(e){a=!1}return a}function l(){!e.isEmpty(a.Uploader.uploadQueue)&a.Uploader.uploadIsInProgress&&a.Uploader.upload()}return{upload:t,clearUploadQueue:s,getUploadQueue:d,cancelUpload:r,retryUpload:l,registerToFileStatusChanged:n,registerToQueueChange:o}}),define("mediaServices/services/fontsManager/fontsManager",["lodash","wixmp","util","mediaServices/services/fontsManager/fontsUploader","experiment"],function(e,a,i,t,n){function o(a){return a=e.reject(a,function(e){return!e.fileInput}),e.map(a,function(e){return i.fontsManagerUtils.getUploadedFontData(e)})}function s(){d(),t.registerToFileStatusChanged(c),t.registerToQueueChange(p),_()}function d(){var e={mediaType:f.FONTS_MEDIA_TYPE};return n.isOpen("fontsUploadFilterOtf")&&(e.paging={cursor:null,size:500}),E.items.list(null,e).then(function(e){I=o(e.data),r(f.FONT_EVENTS_NAMES.LIST_CHANGED,I)})}function r(a,i){e.forEach(g[a],function(e){e(i)})}function l(e,a){g[e]?g[e].push(a):g[e]=[a]}function M(a,i){g[a]=e.reject(g[a],function(e){return e===i})}function c(e){e.currentFileProgress.status===f.FONT_STATUS.SUCCEEDED&&d(),r(f.FONT_EVENTS_NAMES.FILE_CHANGED,e)}function p(e){r(f.FONT_EVENTS_NAMES.QUEUE_CHANGED,e)}function m(){return I}function _(){a.events.on(a.events.ITEMS.REMOVE,function(a){e.forEach(a,function(e){e.then(d).catch()})})}function u(e){E.items.remove(e)}function A(e){t.upload(E,e)}var E=new a.Source(a.sources.PRIVATE);n.isOpen("fontsUploadAsync")&&(E=new a.Source(a.sources.PRIVATE,{asyncFontUpload:!0}));var g={},I={},f=i.fontsManagerUtils.constants;return{registerObserver:l,unregisterObserver:M,getList:m,remove:u,init:s,uploader:{upload:A,clearUploadQueue:t.clearUploadQueue,getUploadQueue:t.getUploadQueue,cancelUpload:t.cancelUpload,retryUpload:t.retryUpload}}}),define("mediaServices",["lodash","mediaServices/services/wixMediaManager/adapter","mediaServices/services/fontsManager/fontsManager"],function(e,a,i){function t(){this.mediaData={siteMediaToken:"",isEmailWithWixDomain:!1},this.fontsManager=i,this.mediaManager={manage:a.manage.bind(null,this.mediaData),open:a.open.bind(null,this.mediaData),presets:a.presets,categories:a.categories}}return t.prototype=e.create(Object.prototype,{constructor:t,setSiteMediaToken:function(e){this.mediaData.siteMediaToken=e||""},setIsEmailWithWixDomain:function(e){this.mediaData.isEmailWithWixDomain=e},getSiteMediaToken:function(){return this.mediaData.siteMediaToken}}),t});
//# sourceMappingURL=mediaServices.min.js.map