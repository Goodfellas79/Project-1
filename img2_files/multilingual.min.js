"use strict";define("multilingual/panels/multilingualManage/multilingualManagePanel.rt",["react","lodash","panels","util","baseUI","baseUILib","symbols"],function(e,a,t,n,i,l,g){return function(){function n(a,t){return e.createElement(l.DropDownOption,{label:this.state.originalLanguage.title,shouldTranslate:!1,key:"originalLanguageCandidate"+t,value:t},e.createElement("div",{className:"dropdown-option"},a))}function s(){this.onSetDefault(this.state.originalLanguage.code)}function u(e,a){this.onToggleLanguagePublicAvailability(a)}function o(e,a){this.onRemoveLanguage(a)}function r(e,a){this.onSetDefault(a)}function c(a,t){return e.createElement("li",{key:"liItem"+t},e.createElement("div",{className:"language-item",key:"languageItem"+t},e.createElement("div",{className:"language-item-title"},e.createElement("span",{},a.title)),e.createElement("div",{className:"language-item-checkbox",key:"listItemPublic"+t},e.createElement(l.ToggleSwitch,{className:"check-enable-box",value:this.getListedItemPublic(t),onChange:u.bind(this,a,t),ref:"checkbox",key:"listItemCheckbox"+t})),e.createElement("div",{className:"language-text"},this.getListedItemPublic(t)?null:e.createElement("span",{className:"hidden-text",key:"language-hidden-text"},"HIDDEN")),e.createElement("div",{className:"language-icons"},e.createElement("button",{className:"language-item-icon",onClick:o.bind(this,a,t)},e.createElement(g.symbol,{name:"sectionDelete"})),e.createElement("button",{className:t===this.state.defaultLanguage?"language-item-icon-highlight":"language-item-icon",onClick:r.bind(this,a,t)},e.createElement(g.symbol,{name:"setDefaultRadio"})))))}function m(a,t){return e.createElement(l.DropDownOption,{label:this.state.newLanguage?this.getLanguageTitle(this.state.newLanguage):"ML_MANAGER_CHOOSE_LANGUAGE",shouldTranslate:!1,key:"newLanguageCandidate"+t,value:t},e.createElement("div",{className:"dropdown-option"},a))}return e.createElement(t.frames.focusPanelFrame,{className:"multilingual-manage-panel",panelName:this.props.panelName,shouldHideHeader:!0,frameClassName:"multilingual-manage-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},e.createElement("header",{className:"multilingual-manage-panel-header"},e.createElement("button",{className:"close",onClick:this.onClose},e.createElement(g.symbol,{name:"headerCloseButton"})),e.createElement("span",{className:"title"},this.translateIfNeeded(this.props.title)),e.createElement("span",{className:"subtitle"},this.translateIfNeeded(this.props.subtitle))),e.createElement("div",{className:"multilingual-manage-panel-body"},e.createElement("div",{className:"check-enable"},e.createElement(l.ToggleSwitch,{className:"check-enable-box",value:this.state.isMultilingual,onChange:this.onToggleMultilingual,ref:"checkbox",label:"ML_MANAGER_ENABLE",labelAfterSymbol:!0})),this.state.isMultilingual?e.createElement("div",{key:"setMultilingual",className:"language-table"},e.createElement("div",{className:"language-item"},a.isEmpty(this.state.nonSiteLanguages)?e.createElement("div",{className:"language-item-title",key:"MLOriginalLanguage"},e.createElement("span",{},this.state.originalLanguage.title)):null,a.isEmpty(this.state.nonSiteLanguages)?null:e.createElement.apply(this,[l.DropDown,{key:"originalLanguageDropDown",shouldTranslate:!1,className:"language-original",onChange:this.onSelectOriginalLanguage},a.map(this.state.nonSiteLanguages,n.bind(this))]),e.createElement("div",{className:"language-item-checkbox"},e.createElement(l.ToggleSwitch,{className:"check-enable-box",value:this.state.originalLanguage.isPublic,onChange:this.onToggleOriginalLanguagePublicAvailability,ref:"checkbox"})),e.createElement("div",{className:"language-text"},e.createElement("span",{className:"original-text"},"ORIGINAL")),e.createElement("div",{className:"language-icons"},e.createElement("button",{className:this.state.originalLanguage.code===this.state.defaultLanguage?"language-item-icon-highlight":"language-item-icon",onClick:s.bind(this)},e.createElement(g.symbol,{name:"setDefaultRadio"})))),e.createElement.apply(this,["ul",{className:"language-list"},a.map(this.state.translationLanguages,c.bind(this))]),this.hasNonSiteLanguages()?e.createElement("div",{className:"add-new",key:"addingLanguage"},e.createElement("div",{className:"add-new-title"},this.translateIfNeeded("ML_MANAGER_ADD_LANGUAGE")),e.createElement("button",{className:"add-new-icon",onClick:this.onAddLanguageStart},e.createElement(g.symbol,{name:"leftBarAddPanel"}))):null,this.state.isAddingNewLanguage?e.createElement("div",{className:"add-new",key:"selectingLanguage"},e.createElement.apply(this,[l.DropDown,{key:"newLanguageDropDown",className:"add-new-title",onChange:this.onSelectLanguage},a.map(this.state.nonSiteLanguages,m.bind(this))]),e.createElement("button",{className:"add-new-icon",onClick:this.onAddLanguageSuccess},e.createElement(g.symbol,{name:"selectedItemDesignPanel"})),e.createElement("button",{className:"add-new-icon",onClick:this.onAddLanguageFail},e.createElement(g.symbol,{name:"sectionDelete"}))):null):null),e.createElement("div",{className:"multilingual-manage-panel-footer"},e.createElement(i.button,{type:"button",label:"ML_MANAGER_OK",className:"confirm-button",onClick:this.onConfirm})))}}),define("multilingual/siteComponentHelper/languageSelectorPreset",[],function(){return{id:"Language_Selector_1",structure:{type:"Component",skin:"wysiwyg.viewer.skins.LanguageSelectorSkin",layout:{width:216,height:108,x:23,y:23,scale:1,rotationInDegrees:0,fixedPosition:!1},componentType:"wysiwyg.viewer.components.LanguageSelector",data:{type:"LanguageSelector",metaData:{isPreset:!1,schemaVersion:"1.0",isHidden:!1}},props:{type:"LanguageSelectorProperties",metaData:{schemaVersion:"1.0"},displayMode:"dropdown",iconType:"circleFlag",itemFormat:"short",alignTabs:"center",languagesOrder:["zho","ger","eng"]},style:{type:"TopLevelStyle",metaData:{isPreset:!1,schemaVersion:"1.0",isHidden:!1},style:{groups:{},properties:{"alpha-itemTextColor":"1","alpha-itemHoverTextColor":"1",itemFont:"normal normal normal 14px/1.4em raleway",borderRadius:"5px",boxShadow:"0 1px 3px rgba(0, 0, 0, .5);",itemHoverTextColor:"#CCCCCC",itemTextColor:"#000000",backgroundColor:"#FFFFFF"},propertiesSource:{itemHoverTextColor:"value",itemTextColor:"value",itemFont:"value",borderRadius:"value",backgroundColor:"value",boxShadow:"value"}},componentClassName:"wysiwyg.viewer.components.LanguageSelector",pageId:"",compId:"",styleType:"custom",skin:"wysiwyg.viewer.skins.LanguageSelectorSkin"},activeModes:{},id:"comp-xxxxxx"}}}),define("multilingual/siteComponentHelper/siteComponentHelper",["multilingual/siteComponentHelper/languageSelectorPreset"],function(e){function a(a){var t=a.documentServices.siteSegments.getHeader();a.components.add(t,e.structure,void 0,function(e){a.selection.selectComponentByCompRef(e)})}return{addLanguageSelectorToSiteHeader:a}}),define("multilingual/panels/multilingualManage/multilingualManagePanel",["react","lodash","core","util","multilingual/panels/multilingualManage/multilingualManagePanel.rt","multilingual/siteComponentHelper/siteComponentHelper"],function(e,a,t,n,i,l){return e.createClass({displayName:"multilingualManagePanel",mixins:[t.mixins.editorAPIMixin,n.translationMixin],propTypes:{title:e.PropTypes.string,subtitle:e.PropTypes.string},languageMap:{eng:"English",ger:"German",zho:"Chinese",heb:"Hebrew",bel:"Belarusian",spa:"Spanish"},getLanguageTitle:function(e){return this.languageMap[e]},getKeyboardShortcuts:function(){return{enter:function(){this.onConfirm()},esc:function(){this.onClose()}}},getUpdateOriginalLanguage:function(){return a.assign({},this.state.originalLanguage,{isPublic:this.languageAPI.public.get(this.state.originalLanguage.code)})},hasNonSiteLanguages:function(){return!this.state.isAddingNewLanguage&&!a.isEmpty(this.state.nonSiteLanguages)},getListedItemPublic:function(e){return this.state.translationLanguages[e].isPublic},getSiteLanguages:function(){var e=a.assign({},this.state.translationLanguages);return a.set(e,this.state.originalLanguage.code,this.state.originalLanguage)},onClose:function(){this.getEditorAPI().panelManager.closePanelByName(this.props.panelName)},onConfirm:function(){this.onClose()},onToggleMultilingual:function(){var e=this.state.isMultilingual;e?this.languageAPI.multilingual.disable():this.languageAPI.multilingual.isInitialized()?this.languageAPI.multilingual.enable():this.initMultilingual(),this.setState({isMultilingual:!e})},initMultilingual:function(){this.languageAPI.multilingual.init("eng"),this.initLanguages(),this.addLanguageSelectorToSite()},addLanguageSelectorToSite:function(){var e=this.getEditorAPI();l.addLanguageSelectorToSiteHeader(e)},onToggleOriginalLanguagePublicAvailability:function(){var e=!this.state.originalLanguage.isPublic;this.languageAPI.public.set(this.state.originalLanguage.code,e),this.setState({originalLanguage:a.set(this.state.originalLanguage,"isPublic",e)})},onToggleLanguagePublicAvailability:function(e){if(this.state.translationLanguages.hasOwnProperty(e)){var t=!this.state.translationLanguages[e].isPublic;this.languageAPI.public.set(e,t),this.setState({translationLanguages:a.set(this.state.translationLanguages,[e,"isPublic"],t),originalLanguage:this.getUpdateOriginalLanguage()})}},onAddLanguageStart:function(){this.setState({isAddingNewLanguage:!0})},onSelectLanguage:function(e){this.setState({newLanguage:e})},onAddLanguageSuccess:function(){var e=this.state.newLanguage;null===e||this.getSiteLanguages().hasOwnProperty(e)?this.setState({isAddingNewLanguage:!1,newLanguage:null}):(this.setState({isAddingNewLanguage:!1,translationLanguages:a.set(this.state.translationLanguages,e,{code:e,title:this.getLanguageTitle(e),isPublic:!1}),nonSiteLanguages:a.omit(this.state.nonSiteLanguages,e),newLanguage:null}),this.languageAPI.add(e))},onAddLanguageFail:function(){this.setState({isAddingNewLanguage:!1,newLanguage:null})},onSelectOriginalLanguage:function(e){if(null!==e&&!this.getSiteLanguages().hasOwnProperty(e)){var t=this.state.originalLanguage.code;this.setState({originalLanguage:{code:e,title:this.getLanguageTitle(e),isPublic:this.state.originalLanguage.isPublic},nonSiteLanguages:a.omit(a.set(this.state.nonSiteLanguages,t,this.getLanguageTitle(t)),e),defaultLanguage:this.state.defaultLanguage===t?e:this.state.defaultLanguage})}this.languageAPI.original.set(e)},onRemoveLanguage:function(e){if(a.size(this.state.translationLanguages)>=1){this.languageAPI.remove(e);var t=a.omit(this.state.translationLanguages,e),n=this.state.originalLanguage;this.setState({defaultLanguage:e===this.state.defaultLanguage?n.code:this.state.defaultLanguage,translationLanguages:t,nonSiteLanguages:a.set(this.state.nonSiteLanguages,e,this.getLanguageTitle(e)),originalLanguage:this.getUpdateOriginalLanguage()})}},onSetDefault:function(e){this.getSiteLanguages().hasOwnProperty(e)&&(this.setState({defaultLanguage:e}),this.languageAPI.default.set(e))},initLanguages:function(){var e=this.languageAPI.get(),t={},n=this.languageAPI.original.get(),i=this,l=a(this.languageMap).keys().difference(a.concat(e,n)).reduce(function(e,a){return e[a]=i.getLanguageTitle(a),e},{});a.forEach(e,function(e){t[e]={isPublic:i.languageAPI.public.get(e),title:i.getLanguageTitle(e),code:e}}),this.setState({isMultilingual:!0,translationLanguages:t,nonSiteLanguages:l,defaultLanguage:this.languageAPI.default.get(),originalLanguage:{code:n,title:this.getLanguageTitle(n),isPublic:this.languageAPI.public.get(n)}})},componentWillMount:function(){this.languageAPI.multilingual.isEnabled()&&this.initLanguages()},getInitialState:function(){return this.languageAPI=this.getEditorAPI().language,{translationLanguages:[],nonSiteLanguages:[],defaultLanguage:null,newLanguage:null,isAddingNewLanguage:!1,isMultilingual:!1,originalLanguage:null}},render:i})}),define("multilingual/panels/topBarDropDownPanel/topBarDropDownPanel.rt",["react","lodash","baseUI"],function(e,a,t){return function(){return this.isMultilingualSite()?e.createElement("div",{className:"languages-panel-container",key:"MLTopBarDropDown"},e.createElement("div",{className:"editor-modes-panel-top-part"},e.createElement("div",{},e.createElement(t.radioList,{options:this.getLanguageList(),value:this.state.currentLanguage,onChange:this.onChangeLanguage,highlightOnHover:!0})))):null}}),define("multilingual/panels/topBarDropDownPanel/topBarDropDownPanel",["react","lodash","core","util","multilingual/panels/topBarDropDownPanel/topBarDropDownPanel.rt"],function(e,a,t,n,i){return e.createClass({displayName:"editorLanguagePanel",mixins:[t.mixins.editorAPIMixin,n.translationMixin],propTypes:{closeHandle:e.PropTypes.func},getLanguageTitle:function(e){return{eng:"English",ger:"German",zho:"Chinese",heb:"Hebrew",bel:"Belarusian",spa:"Spanish"}[e]},getInitialState:function(){return this.languageAPI=this.getEditorAPI().language,{currentLanguage:this.languageAPI.current.get()}},isMultilingualSite:function(){return this.languageAPI.multilingual.isEnabled()},onChangeLanguage:function(e){this.languageAPI.current.set(e),this.setState({currentLanguage:e})},generateLanguageData:function(e){var a=this.languageAPI.public.get(e);return{label:this.getLanguageTitle(e),symbolName:a?"":"quickActionsHide",key:this.getLanguageTitle(e),className:"languages-option",symbolClass:"languages-option-symbol",value:e}},getLanguageList:function(){var e=this.languageAPI.original.get(),t=this.languageAPI.get();return a.map(a.concat(e,t),this.generateLanguageData)},getDefaultProps:function(){return{closeHandle:a.noop}},componentDidMount:function(){this.registerKeyboardShortcuts(),this.lastKeyboardContext=n.keyboardShortcuts.getContext(),n.keyboardShortcuts.setContext("CURRENT_LANGUAGE_SWITCH")},componentWillUnmount:function(){n.keyboardShortcuts.setContext(this.lastKeyboardContext)},sendToggleBI:function(e,a){var n=t.bi.events.topbar.current_language_selection,i={origin:e,current:a};this.props.editorAPI.bi.event(n,i)},registerKeyboardShortcuts:function(){var e=this,a={esc:function(){e.props.closeHandle()}};n.keyboardShortcuts.registerContext("CURRENT_LANGUAGE_SWITCH",a)},render:i})}),define("multilingual",["multilingual/panels/multilingualManage/multilingualManagePanel","multilingual/panels/topBarDropDownPanel/topBarDropDownPanel"],function(e,a){function t(e){e.panelManager.openPanel("multilingual.panels.multilingualManagePanel",{title:"ML_MANAGER_TITLE",subtitle:"ML_MANAGER_SUBTITLE"})}return{panels:{multilingualManagePanel:e,topBarDropDownPanel:a},openMultilingualManagePanel:t}});
//# sourceMappingURL=multilingual.min.js.map